---
title: "Appendix B: Additional explorations of organization"
output:
  html_notebook:
    toc: yes
    toc_depth: 4
    toc_float: yes
always_allow_html: yes
---

```{r global_options, include = F}
knitr::opts_chunk$set(fig.width = 3, fig.asp = 0.67,
                      include = F, echo = F)
```

```{r}
# # for knitting to .docx
# output:
#   word_document:
#     reference_docx: "./word-styles-reference.docx"
# always_allow_html: yes

# # for knitting to .nb.html 
# output:
#   html_notebook:
#     toc: yes
#     toc_depth: 4
#     toc_float: yes
```

```{r}
# run ur-setup script (which runs other scripts)
source("./scripts/_SETUP.R")

# load in EFAs & names from Chapters III & IV
source("./scripts/stored_ch03.R")
source("./scripts/stored_ch04.R")
```

# Appendix overview

In this appendix, I report additional exploratory analyses of the organization of the sets of "conceptual units" that were excluded from the main text of Chapter IV, including: (a) Visualizations and analyses of the relationships among conceptual units using scales derived from EFA of children's own responses, rather than adults' responses, for 7- to 9-year-old children in Study 3, 4- to 6-year-old children in Study 3, and 4- to 5-year-old children in Study 4; (b) Visualizations and analyses of age-related changes in difference scores between conceptual units (scored using adults' scales) for 7- to 9-year-old children in Study 2, 4- to 9-year-old children in Study 3, and 4- to 5-year-old children in Study 4; and (c) Visualizations of the joint dependency of HEART on both BODY and MIND.


# Relationships among conceptual units using scales derived from children's EFAs

In Chapter IV, I used adults' EFA solution to construct BODY, HEART, and MIND scales and used these scales to assess the organization of these adult-like conceptual units among both adult and child samples. For Study 2, I also used 7- to 9-year-old children's own EFA solution to construct a separate set of scales based on children's own conceptual units and conducted a separate set of analyses of the organization of these "child-like" conceptual units. Here I present a parallel set of analyses using children's own EFA solutions (rather than adults') to assess the organization of conceptual units among both older children (7-9y of age) and younger children (4-6y of age) in Study 3, as well as among children (4-5y of age) in Study 4.

## Study 3

### Older children (7-9y), using their own scales

#### Scale construction

```{r}
# done in ch04_organization.Rmd
scales_efa_wdm_d3_79 <- readRDS(file = "./stored/scales/scales_efa_wdm_d3_79")

d3_79_scored_79 <- score_fun(d3_79, scales_efa_wdm_d3_79)
saveRDS(d3_79_scored_79, file = "./stored/scored_data/d3_79_scored_79")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d3_79)` scales of `r scales_efa_wdm_d3_79 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table B.1.

#### Visualization and analysis of asymmetries

```{r}
plots_d3_79_scored_79 <- relviz_fun(d3_79_scored_79, colors = colors09)
```

```{r}
fig_d3_79_scored_79_plots <- plot_grid(
  plots_d3_79_scored_79[[1]] + 
    theme(legend.position = "none"),
  plots_d3_79_scored_79[[2]] + 
    theme(legend.position = "none"),
  plots_d3_79_scored_79[[3]] + 
    theme(legend.position = "none"),
  labels = c("A1", "A2", "A3"), ncol = 3)

fig_d3_79_scored_79_leg <- get_legend(
  plots_d3_79_scored_79[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", 
                      values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character",
                       values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_79_scored_79_plots_leg <- plot_grid(fig_d3_79_scored_79_plots, fig_d3_79_scored_79_leg,
                                           ncol = 1, rel_heights = c(1, 0.05))

fig_d3_79_scored_79_title <- ggdraw() + 
  draw_label("Study 3: Children, 7-9y (using their own scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_79_scored_79_plots_leg_title <- plot_grid(
  fig_d3_79_scored_79_title, fig_d3_79_scored_79_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 5, fig.asp = 0.4}
# interim plot for ease of writing
fig_d3_79_scored_79_plots_leg_title
```

```{r}
d3_79_scored_79_diff <- diff_fun(d3_79_scored_79)
contrasts(d3_79_scored_79_diff$character) <- contrasts_sum_dv09

saveRDS(d3_79_scored_79_diff, "./stored/diffscore_data/d3_79_scored_79_diff")
```

```{r}
plot_d3_79_scored_79_diff <- diffplot_fun(d3_79_scored_79_diff, colors = colors09)
```

```{r}
# r_d3_79_scored_79_diff_BODY_HEART <- brm(
#   diff ~ 1 + character,
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
#   cores = 4)
# 
# saveRDS(r_d3_79_scored_79_diff_BODY_HEART,
#         "./stored/brms_models/r_d3_79_scored_79_diff_BODY_HEART")

r_d3_79_scored_79_diff_BODY_HEART <- readRDS("./stored/brms_models/r_d3_79_scored_79_diff_BODY_HEART")

summary(r_d3_79_scored_79_diff_BODY_HEART)
```

```{r}
# r_d3_79_scored_79_diff_BODY_MIND <- brm(
#   diff ~ 1 + character,
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
#   cores = 4)
# 
# saveRDS(r_d3_79_scored_79_diff_BODY_MIND,
#         "./stored/brms_models/r_d3_79_scored_79_diff_BODY_MIND")

r_d3_79_scored_79_diff_BODY_MIND <- readRDS("./stored/brms_models/r_d3_79_scored_79_diff_BODY_MIND")

summary(r_d3_79_scored_79_diff_BODY_MIND)
```

```{r}
# r_d3_79_scored_79_diff_HEART_MIND <- brm(
#   diff ~ 1 + character,
#   data = d3_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
#   cores = 4)
# 
# saveRDS(r_d3_79_scored_79_diff_HEART_MIND,
#         "./stored/brms_models/r_d3_79_scored_79_diff_HEART_MIND")

r_d3_79_scored_79_diff_HEART_MIND <- readRDS("./stored/brms_models/r_d3_79_scored_79_diff_HEART_MIND")

summary(r_d3_79_scored_79_diff_HEART_MIND)
```

```{r}
regtab_d3_79_scored_79_diff <- diff_reg_table_fun(
  reg_list = list(r_d3_79_scored_79_diff_BODY_HEART,
                  r_d3_79_scored_79_diff_BODY_MIND,
                  r_d3_79_scored_79_diff_HEART_MIND),
  pair_list = c("BODY - HEART", "BODY - MIND", "HEART - MIND"),
  study_name = "Children, 7-9y (using their own scales)",
  char_label = c("Elephant vs. GM", "Goat vs. GM", "Mouse vs. GM",
                 "Bird vs. GM", "Beetle vs. GM", "Teddy bear vs. GM",
                 "Doll vs. GM", "Robot vs. GM"))
```

```{r}
# interim table for ease of writing
regtab_d3_79_scored_79_diff %>%
  select(-study, -s.e.) %>%
  filter(param == "Intercept") %>%
  kable(digits = 2) %>%
  kable_styling()
```

```{r, fig.width = 5, fig.asp = 0.4}
# interim plot for ease of writing
plot_d3_79_scored_79_diff
```

Visualizations of relationships among 7- to 9-year-old children's scores on the _BODY_, _HEART_, and _MIND_ scales are provided in Figure B.xx, row A. The results of Bayesian regressions comparing difference scores between conceptual units to zero, controlling for differences in assessments of the nine "diverse characters" that were featured as target characters in these studies, are provided in Table B.xx.

On the whole, these results (using _BODY_, _HEART_, and _MIND_ scales derived from EFA 7- to 9-year-old children's responses) are very similar to those presented in the main text of Chapter IV (using adults' _BODY_, _HEART_, and _MIND_ scales): Children systematically endorsed _BODY_ and _MIND_ items more strongly than _HEART_ items, but showed no systematic asymmetry between BODY and MIND. This is unsurprising, since children's and adults' scales were so similar to each other (see Table B.xx).

### Younger children (4-6y), using their own scales (three-factor solution)

#### Scale construction

```{r}
scales_efa_wdm_d3_46 <- scale_fun(efa_wdm_d3_46, 
                                  factor_names = factor_names_efa_wdm_d3_46)
saveRDS(scales_efa_wdm_d3_46, file = "./stored/scales/scales_efa_wdm_d3_46")

d3_46_scored_46_wdm <- score_fun(d3_46, scales_efa_wdm_d3_46)
saveRDS(d3_46_scored_46_wdm, file = "./stored/scored_data/d3_46_scored_46_wdm")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d3_46)` scales of `r scales_efa_wdm_d3_46 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table B.1.

#### Visualization and analysis of asymmetries

```{r}
plots_d3_46_scored_46_wdm <- relviz_fun(d3_46_scored_46_wdm, colors = colors09)
```

```{r}
fig_d3_46_scored_46_wdm_plots <- plot_grid(plots_d3_46_scored_46_wdm[[1]] + 
                                             theme(legend.position = "none"),
                                           plots_d3_46_scored_46_wdm[[2]] + 
                                             theme(legend.position = "none"),
                                           plots_d3_46_scored_46_wdm[[3]] + 
                                             theme(legend.position = "none"),
                                           labels = c("B1", "B2", "B3"), ncol = 3)

fig_d3_46_scored_46_wdm_leg <- get_legend(
  plots_d3_46_scored_46_wdm[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", 
                      values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character",
                       values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_46_scored_46_wdm_plots_leg <- plot_grid(fig_d3_46_scored_46_wdm_plots, fig_d3_46_scored_46_wdm_leg,
                                               ncol = 1, rel_heights = c(1, 0.05))

fig_d3_46_scored_46_wdm_title <- ggdraw() + 
  draw_label("Study 3: Children, 4-6y (using their own scales, 3-factor solution)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_46_scored_46_wdm_plots_leg_title <- plot_grid(
  fig_d3_46_scored_46_wdm_title, fig_d3_46_scored_46_wdm_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 5, fig.asp = 0.4}
# interim plot for ease of writing
fig_d3_46_scored_46_wdm_plots_leg_title
```

```{r}
d3_46_scored_46_wdm_diff <- diff_fun(d3_46_scored_46_wdm)
contrasts(d3_46_scored_46_wdm_diff$character) <- contrasts_sum_dv09

saveRDS(d3_46_scored_46_wdm_diff, "./stored/diffscore_data/d3_46_scored_46_wdm_diff")
```

```{r}
plot_d3_46_scored_46_wdm_diff <- diffplot_fun(d3_46_scored_46_wdm_diff, colors = colors09)
```

```{r}
# r_d3_46_scored_46_wdm_diff_BODY_HEART <- brm(
#   diff ~ 1 + character,
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - HEART*"),
#   cores = 4)
# 
# saveRDS(r_d3_46_scored_46_wdm_diff_BODY_HEART,
#         "./stored/brms_models/r_d3_46_scored_46_wdm_diff_BODY_HEART")

r_d3_46_scored_46_wdm_diff_BODY_HEART <- readRDS("./stored/brms_models/r_d3_46_scored_46_wdm_diff_BODY_HEART")

summary(r_d3_46_scored_46_wdm_diff_BODY_HEART)
```

```{r}
# r_d3_46_scored_46_wdm_diff_BODY_MIND <- brm(
#   diff ~ 1 + character,
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - MIND"),
#   cores = 4)
# 
# saveRDS(r_d3_46_scored_46_wdm_diff_BODY_MIND,
#         "./stored/brms_models/r_d3_46_scored_46_wdm_diff_BODY_MIND")

r_d3_46_scored_46_wdm_diff_BODY_MIND <- readRDS("./stored/brms_models/r_d3_46_scored_46_wdm_diff_BODY_MIND")

summary(r_d3_46_scored_46_wdm_diff_BODY_MIND)
```

```{r}
# r_d3_46_scored_46_wdm_diff_HEART_MIND <- brm(
#   diff ~ 1 + character,
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND"),
#   cores = 4)
# 
# saveRDS(r_d3_46_scored_46_wdm_diff_HEART_MIND,
#         "./stored/brms_models/r_d3_46_scored_46_wdm_diff_HEART_MIND")

r_d3_46_scored_46_wdm_diff_HEART_MIND <- readRDS("./stored/brms_models/r_d3_46_scored_46_wdm_diff_HEART_MIND")

summary(r_d3_46_scored_46_wdm_diff_HEART_MIND)
```

```{r}
regtab_d3_46_scored_46_wdm_diff <- diff_reg_table_fun(
  reg_list = list(r_d3_46_scored_46_wdm_diff_BODY_HEART,
                  r_d3_46_scored_46_wdm_diff_BODY_MIND,
                  r_d3_46_scored_46_wdm_diff_HEART_MIND),
  pair_list = c("BODY* - HEART*", "BODY* - MIND", "HEART* - MIND"),
  study_name = "Children, 4-6y (using their own scales, 3-factor solution)",
  char_label = c("Elephant vs. GM", "Goat vs. GM", "Mouse vs. GM",
                 "Bird vs. GM", "Beetle vs. GM", "Teddy bear vs. GM",
                 "Doll vs. GM", "Robot vs. GM"))
```

```{r}
# interim table for ease of writing
regtab_d3_46_scored_46_wdm_diff %>%
  select(-study, -s.e.) %>%
  filter(param == "Intercept") %>%
  kable(digits = 2) %>%
  kable_styling()
```

```{r, fig.width = 5, fig.asp = 0.4}
# interim plot for ease of writing
plot_d3_46_scored_46_wdm_diff
```

Visualizations of relationships among 4- to 6-year-old children's scores on the _BODY\*_, _HEART\*_, and _MIND_ scales are provided in Figure B.xx, row B. The results of Bayesian regressions comparing difference scores between conceptual units to zero, controlling for differences in assessments of the nine "diverse characters" that were featured as target characters in these studies, are provided in Table B.xx.

As in the results presented in the main text of Chapter IV (using adults' _BODY_, _HEART_, and _MIND_ scales), 4- to 6-year-old children systematically endorsed _BODY\*_ items more strongly than _MIND_ items. This is further evidence of a markedly un-adult-like intuition that BODY may be a more basic conceptual unit than MIND.

In contrast to the results presented in the main text of Chapter IV, 4- to 6-year-old children's _BODY\*_ vs. _HEART\*_ difference scores were indistinguishable from zero, and they systematically endorsed _HEART\*_ items more strongly than _MIND_ items. Both of these observations render 4- to 6-year-old children's conceptual organizations even less adult-like than those reported in Chapter IV.

### Younger children (4-6y), using their own scales (two-factor solution)

#### Scale construction

```{r}
scales_efa_par_d3_46 <- scale_fun(efa_par_d3_46, 
                                  factor_names = factor_names_efa_par_d3_46)
saveRDS(scales_efa_par_d3_46, file = "./stored/scales/scales_efa_par_d3_46")

d3_46_scored_46_par <- score_fun(d3_46, scales_efa_par_d3_46)
saveRDS(d3_46_scored_46_par, file = "./stored/scored_data/d3_46_scored_46_par")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_par_d3_46)` scales of `r scales_efa_par_d3_46 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table B.1.

#### Visualization and analysis of asymmetries

```{r}
plots_d3_46_scored_46_par <- relviz_fun(d3_46_scored_46_par, colors = colors09)
```

```{r}
fig_d3_46_scored_46_par_plots <- plot_grid(plots_d3_46_scored_46_par[[1]] + 
                                             theme(legend.position = "none"),
                                           labels = c("C1"), ncol = 3)

fig_d3_46_scored_46_par_leg <- get_legend(
  plots_d3_46_scored_46_par[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", 
                      values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character",
                       values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_46_scored_46_par_plots_leg <- plot_grid(fig_d3_46_scored_46_par_plots, fig_d3_46_scored_46_par_leg,
                                               ncol = 1, rel_heights = c(1, 0.05))

fig_d3_46_scored_46_par_title <- ggdraw() + 
  draw_label("Study 3: Children, 4-6y (using their own scales, 2-factor solution)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_46_scored_46_par_plots_leg_title <- plot_grid(
  fig_d3_46_scored_46_par_title, fig_d3_46_scored_46_par_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 5, fig.asp = 0.4}
# interim plot for ease of writing
fig_d3_46_scored_46_par_plots_leg_title
```

```{r}
d3_46_scored_46_par_diff <- diff_fun(d3_46_scored_46_par)
contrasts(d3_46_scored_46_par_diff$character) <- contrasts_sum_dv09

saveRDS(d3_46_scored_46_par_diff, "./stored/diffscore_data/d3_46_scored_46_par_diff")
```

```{r}
plot_d3_46_scored_46_par_diff <- diffplot_fun(d3_46_scored_46_par_diff, colors = colors09)
```

```{r}
# r_d3_46_scored_46_par_diff_BODYHEART_MIND <- brm(
#   diff ~ 1 + character,
#   data = d3_46_scored_46_par_diff %>% filter(pair == "BODY-HEART - MIND"),
#   cores = 4)
# 
# saveRDS(r_d3_46_scored_46_par_diff_BODYHEART_MIND,
#         "./stored/brms_models/r_d3_46_scored_46_par_diff_BODYHEART_MIND")

r_d3_46_scored_46_par_diff_BODYHEART_MIND <- readRDS("./stored/brms_models/r_d3_46_scored_46_par_diff_BODYHEART_MIND")

summary(r_d3_46_scored_46_par_diff_BODYHEART_MIND)
```

```{r}
regtab_d3_46_scored_46_par_diff <- diff_reg_table_fun(
  reg_list = list(r_d3_46_scored_46_par_diff_BODYHEART_MIND),
  pair_list = "BODY-HEART - MIND",
  study_name = "Children, 4-6y (using their own scales, 2-factor solution)",
  char_label = c("Elephant vs. GM", "Goat vs. GM", "Mouse vs. GM",
                 "Bird vs. GM", "Beetle vs. GM", "Teddy bear vs. GM",
                 "Doll vs. GM", "Robot vs. GM"))
```

```{r}
# interim table for ease of writing
regtab_d3_46_scored_46_par_diff %>%
  select(-study, -s.e.) %>%
  filter(param == "Intercept") %>%
  kable(digits = 2) %>%
  kable_styling()
```

```{r, fig.width = 5, fig.asp = 0.4}
# interim plot for ease of writing
plot_d3_46_scored_46_par_diff
```

Visualizations of relationships among 4- to 6-year-old children's scores on the _BODY-HEART_ and _MIND_ scales are provided in Figure B.xx, row B. The results of a Bayesian regression comparing difference scores between conceptual units to zero, controlling for differences in assessments of the nine "diverse characters" that were featured as target characters in these studies, are provided in Table B.xx.

The main take-away of this analysis is that 4- to 6-year-old children reliably endorsed _BODY-HEART_ items more strongly than _MIND_ items.

### Discussion

```{r}
altscales_study3 <- bind_rows(
  scales_efa_wdm_d3_ad %>% 
    mutate(study = "Adults"),
  scales_efa_wdm_d3_79 %>% 
    mutate(study = "Older children, 7-9y"),
  scales_efa_wdm_d3_46 %>%
    mutate(study = "Younger children, 4-6y (3-factor solution)"),
  scales_efa_par_d3_46 %>%
    mutate(study = "Younger children, 4-6y (2-factor solution)")) %>%
  select(-c(loading, order)) %>%
  distinct() %>%
  mutate(study = factor(study,
                        levels = c("Adults",
                                   "Older children, 7-9y",
                                   "Younger children, 4-6y (3-factor solution)",
                                   "Younger children, 4-6y (2-factor solution)"))) %>%
  spread(study, factor) %>%
  mutate(ur_factor = ifelse(!is.na(`Adults`), 
                            `Adults`, 
                            ifelse(!is.na(`Older children, 7-9y`), 
                                   `Older children, 7-9y`,
                                   ifelse(is.na(`Younger children, 4-6y (3-factor solution)`), 
                                          `Younger children, 4-6y (3-factor solution)`,
                                          `Younger children, 4-6y (2-factor solution)`)))) %>%
  left_join(scales_efa_wdm_d3_ad %>% 
              select(capacity, order) %>% rename(order_ad = order)) %>%
  left_join(scales_efa_wdm_d3_79 %>% 
              select(capacity, order) %>% rename(order_79 = order)) %>%
  arrange(ur_factor, order_ad, order_79) %>%
  select(-c(ur_factor, starts_with("order")))
```

```{r}
tableB.1 <- altscales_study3 %>%
  mutate_all(as.character) %>%
  # deal with younger children, 2-factor solution
  mutate(temp1 = `Younger children, 4-6y (2-factor solution)`,
         temp2 = gsub("\\*", "", temp1),
         temp3 = case_when(
           temp2 == `Adults` | 
             temp2 == `Older children, 7-9y` ~ "✓",
           is.na(temp2) ~ "",
           TRUE ~ temp1)) %>%
  mutate(`Younger children, 4-6y (2-factor solution)` = temp3) %>%
  select(-starts_with("temp")) %>%
  # deal with younger children, 3-factor solution
  mutate(temp1 = `Younger children, 4-6y (3-factor solution)`,
         temp2 = gsub("\\*", "", temp1),
         temp3 = case_when(
           temp2 == `Adults` | 
             temp2 == `Older children, 7-9y` |
             (is.na(`Adults`) & is.na(`Older children, 7-9y`)) ~ "✓",
           is.na(temp2) ~ "",
           TRUE ~ temp1)) %>%
  mutate(`Younger children, 4-6y (3-factor solution)` = temp3) %>%
  select(-starts_with("temp")) %>%
  mutate_at(vars(`Adults`, `Older children, 7-9y`),
            funs(ifelse(is.na(.), "", "✓"))) %>%
  mutate_at(vars(starts_with("Younger")),
            funs(ifelse(is.na(.), "", .))) %>%
  rename(Capacity = capacity,
         `3-factor solution` = `Younger children, 4-6y (3-factor solution)`,
         `2-factor solution` = `Younger children, 4-6y (2-factor solution)`) %>%
  kable(format = "html",
        caption = "Table B.1: Scales for each of the conceptual units (factors) identified by EFA for US Adults, older children, and younger children in Study 3 (see Chapter III). For younger children, this includes scales for both three- and two-factor EFA solutions. A checkmark indicates that a mental capacity was included in a scale for a particular sample. The conceptual units of younger children differed substantially from those of older children and adults, such that some mental capacities were included in different scales across age groups (e.g., feel scared was part of the BODY scale for older children and adults, but part of the HEART* scale for younger children). In these cases, the name of the scale is provided (rather than a checkmark).") %>%
  kable_styling() %>%
  group_rows("BODY scale", 1, 7) %>%
  group_rows("HEART scale", 8, 14) %>%
  group_rows("MIND scale", 15, 20) %>%
  add_header_above(c(" " = 3,
                     "Younger children, 4-6y" = 2))
```

```{r tableB.1, include = T}
tableB.1
```

```{r}
figureB.1 <- plot_grid(fig_d3_79_scored_79_plots_leg_title, 
                       fig_d3_46_scored_46_wdm_plots_leg_title,
                       fig_d3_46_scored_46_par_plots_leg_title,
                       ncol = 1)

figureB.1_cap <- add_sub(figureB.1, str_wrap("Figure B.1: Relationships among older and younger children's attributions of conceptual units in Study 3, scored using their own scales (see Table B.1). For younger children (4-6y of age), two sets of scores are presented: using a three-factor EFA solution (B1-B3) and using a two-factor EFA solution (C1). Plots are organized by sample and scale used (rows) and by pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.4}
ggdraw(figureB.1_cap)
```

```{r}
figureB.2_plots <- plot_grid(
  plot_d3_79_scored_79_diff +
    labs(title = "Study 3: Children, 7-9y\n(scored using their own scales)") +
    theme(legend.position = "none"),
  plot_d3_46_scored_46_wdm_diff + 
    labs(title = "Study 3: Children, 4-6y\n(scored using their own scales, 3-factor solution)") +
    theme(legend.position = "none"), 
  plot_d3_46_scored_46_par_diff + 
    labs(title = "Study 3: Children, 4-6y\n(scored using their own scales, 2-factor solution)") +
    theme(legend.position = "none"), 
  ncol = 3, rel_widths = c(1, 1, 0.8),
  labels = "AUTO")

figureB.2_plots_leg <- plot_grid(figureB.2_plots,
                                 get_legend(plot_d3_79_scored_79_diff),
                                 ncol = 1, rel_heights = c(1, 0.1))

figureB.2_cap <- add_sub(figureB.2_plots_leg, str_wrap("Figure B.2: Difference scores between 7- to 9-year-old children's and 4- to 6-year-old children's attributions of conceptual units in Study 3, using their own scales. For younger children (4-6y of age), this includes difference scores using the three-factor EFA solution (panel B) and difference scores using the two-factor solution (panel C; see Table B.1). For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 180), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 8, fig.asp = 0.38}
ggdraw(figureB.2_cap)
```

## Study 4

### Younger children (4-6y), using their own scales (three-factor solution)

#### Scale construction

```{r}
scales_efa_par_d4_46 <- scale_fun(efa_par_d4_46, 
                                  factor_names = factor_names_efa_par_d4_46)
saveRDS(scales_efa_par_d4_46, file = "./stored/scales/scales_efa_par_d4_46")

d4_46_scored_46_par <- score_fun(d4_46, scales_efa_par_d4_46)
saveRDS(d4_46_scored_46_par, file = "./stored/scored_data/d4_46_scored_46_par")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_par_d4_46)` scales of `r scales_efa_par_d4_46 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table B.1.

#### Visualization and analysis of asymmetries

```{r}
plots_d4_46_scored_46_par <- relviz_fun(d4_46_scored_46_par, colors = colors02)
```

```{r}
fig_d4_46_scored_46_par_plots <- plot_grid(
  plots_d4_46_scored_46_par[[1]] + 
    theme(legend.position = "none"),
  plots_d4_46_scored_46_par[[2]] + 
    theme(legend.position = "none"),
  plots_d4_46_scored_46_par[[3]] + 
    theme(legend.position = "none"),
  labels = c("A1", "A2", "A3"), ncol = 3)

fig_d4_46_scored_46_par_leg <- get_legend(
  plots_d4_46_scored_46_par[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", 
                      values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 2)) +
    scale_color_manual("Target character",
                       values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d4_46_scored_46_par_plots_leg <- plot_grid(
  fig_d4_46_scored_46_par_plots, fig_d4_46_scored_46_par_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d4_46_scored_46_par_title <- ggdraw() + 
  draw_label("Study 4: Children, 4-6y (using their own scales, 3-factor solution)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d4_46_scored_46_par_plots_leg_title <- plot_grid(
  fig_d4_46_scored_46_par_title, fig_d4_46_scored_46_par_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 5, fig.asp = 0.4}
# interim plot for ease of writing
fig_d4_46_scored_46_par_plots_leg_title
```

```{r}
d4_46_scored_46_par_diff <- diff_fun(d4_46_scored_46_par)
contrasts(d4_46_scored_46_par_diff$character) <- contrasts_sum_edge

saveRDS(d4_46_scored_46_par_diff, "./stored/diffscore_data/d4_46_scored_46_par_diff")
```

```{r}
plot_d4_46_scored_46_par_diff <- diffplot_fun(d4_46_scored_46_par_diff, colors = colors02)
```

```{r}
# r_d4_46_scored_46_par_diff_BODY_HEART <- brm(
#   diff ~ 1 + character,
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - HEART"),
#   cores = 4)
# 
# saveRDS(r_d4_46_scored_46_par_diff_BODY_HEART,
#         "./stored/brms_models/r_d4_46_scored_46_par_diff_BODY_HEART")

r_d4_46_scored_46_par_diff_BODY_HEART <- readRDS("./stored/brms_models/r_d4_46_scored_46_par_diff_BODY_HEART")

summary(r_d4_46_scored_46_par_diff_BODY_HEART)
```

```{r}
# r_d4_46_scored_46_par_diff_BODY_MIND <- brm(
#   diff ~ 1 + character,
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - MIND"),
#   cores = 4)
# 
# saveRDS(r_d4_46_scored_46_par_diff_BODY_MIND,
#         "./stored/brms_models/r_d4_46_scored_46_par_diff_BODY_MIND")

r_d4_46_scored_46_par_diff_BODY_MIND <- readRDS("./stored/brms_models/r_d4_46_scored_46_par_diff_BODY_MIND")

summary(r_d4_46_scored_46_par_diff_BODY_MIND)
```

```{r}
# r_d4_46_scored_46_par_diff_HEART_MIND <- brm(
#   diff ~ 1 + character,
#   data = d4_46_scored_46_par_diff %>% filter(pair == "HEART - MIND"),
#   cores = 4)
# 
# saveRDS(r_d4_46_scored_46_par_diff_HEART_MIND,
#         "./stored/brms_models/r_d4_46_scored_46_par_diff_HEART_MIND")

r_d4_46_scored_46_par_diff_HEART_MIND <- readRDS("./stored/brms_models/r_d4_46_scored_46_par_diff_HEART_MIND")

summary(r_d4_46_scored_46_par_diff_HEART_MIND)
```

```{r}
regtab_d4_46_scored_46_par_diff <- diff_reg_table_fun(
  reg_list = list(r_d4_46_scored_46_par_diff_BODY_HEART,
                  r_d4_46_scored_46_par_diff_BODY_MIND,
                  r_d4_46_scored_46_par_diff_HEART_MIND),
  pair_list = c("BODY - HEART", "BODY - MIND", "HEART - MIND"),
  study_name = "Children, 4-6y (using their own scales, 3-factor solution)",
  char_label = c("Robot vs. GM"))
```

```{r}
# interim table for ease of writing
regtab_d4_46_scored_46_par_diff %>%
  select(-study, -s.e.) %>%
  filter(param == "Intercept") %>%
  kable(digits = 2) %>%
  kable_styling()
```

```{r, fig.width = 5, fig.asp = 0.4}
# interim plot for ease of writing
plot_d4_46_scored_46_par_diff
```

Visualizations of relationships among 4- to 6-year-old children's scores on the _BODY_, _HEART_, and _MIND_ scales are provided in Figure B.xx, row A. The results of Bayesian regressions comparing difference scores between conceptual units to zero, controlling for differences in assessments of the two "edge cases" that were featured as target characters in these studies, are provided in Table B.xx.

In these regressions, none of the asymmetries between conceptual units were reliably distinguishable from zero.

### Younger children (4-6y), using their own scales (four-factor solution)

#### Scale construction

```{r}
scales_efa_wdm_d4_46 <- scale_fun(efa_wdm_d4_46, 
                                  factor_names = factor_names_efa_wdm_d4_46)
saveRDS(scales_efa_wdm_d4_46, file = "./stored/scales/scales_efa_wdm_d4_46")

d4_46_scored_46_wdm <- score_fun(d4_46, scales_efa_wdm_d4_46)
saveRDS(d4_46_scored_46_wdm, file = "./stored/scored_data/d4_46_scored_46_wdm")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d4_46)` scales of `r scales_efa_wdm_d4_46 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table B.1.

#### Visualization and analysis of asymmetries

```{r}
plots_d4_46_scored_46_wdm <- relviz_fun(d4_46_scored_46_wdm, colors = colors02)
```

```{r}
fig_d4_46_scored_46_wdm_plots <- plot_grid(
  plots_d4_46_scored_46_wdm[[1]] + 
    theme(legend.position = "none"),
  plots_d4_46_scored_46_wdm[[2]] + 
    theme(legend.position = "none"),
  plots_d4_46_scored_46_wdm[[3]] + 
    theme(legend.position = "none"),
  plots_d4_46_scored_46_wdm[[4]] + 
    theme(legend.position = "none"),
  plots_d4_46_scored_46_wdm[[5]] + 
    theme(legend.position = "none"),
  plots_d4_46_scored_46_wdm[[6]] + 
    theme(legend.position = "none"),
  labels = paste0("C", 1:6), ncol = 3)

fig_d4_46_scored_46_wdm_leg <- get_legend(
  plots_d4_46_scored_46_wdm[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", 
                      values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 2)) +
    scale_color_manual("Target character",
                       values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d4_46_scored_46_wdm_plots_leg <- plot_grid(
  fig_d4_46_scored_46_wdm_plots, fig_d4_46_scored_46_wdm_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d4_46_scored_46_wdm_title <- ggdraw() + 
  draw_label("Study 4: Children, 4-6y (using their own scales, 4-factor solution)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d4_46_scored_46_wdm_plots_leg_title <- plot_grid(
  fig_d4_46_scored_46_wdm_title, fig_d4_46_scored_46_wdm_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 5, fig.asp = 0.7}
# interim plot for ease of writing
fig_d4_46_scored_46_wdm_plots_leg_title
```

```{r}
d4_46_scored_46_wdm_diff <- diff_fun(d4_46_scored_46_wdm)
contrasts(d4_46_scored_46_wdm_diff$character) <- contrasts_sum_edge

saveRDS(d4_46_scored_46_wdm_diff, "./stored/diffscore_data/d4_46_scored_46_wdm_diff")
```

```{r}
plot_d4_46_scored_46_wdm_diff <- diffplot_fun(d4_46_scored_46_wdm_diff, colors = colors02)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother <- brm(
#   diff ~ 1 + character,
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - BODY (other)"),
#   cores = 4)
# 
# saveRDS(r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother,
#         "./stored/brms_models/r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother")

r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother <- readRDS("./stored/brms_models/r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother")

summary(r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYnausea_HEART <- brm(
#   diff ~ 1 + character,
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - HEART*"),
#   cores = 4)
# 
# saveRDS(r_d4_46_scored_46_wdm_diff_BODYnausea_HEART,
#         "./stored/brms_models/r_d4_46_scored_46_wdm_diff_BODYnausea_HEART")

r_d4_46_scored_46_wdm_diff_BODYnausea_HEART <- readRDS("./stored/brms_models/r_d4_46_scored_46_wdm_diff_BODYnausea_HEART")

summary(r_d4_46_scored_46_wdm_diff_BODYnausea_HEART)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYother_HEART <- brm(
#   diff ~ 1 + character,
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - HEART*"),
#   cores = 4)
# 
# saveRDS(r_d4_46_scored_46_wdm_diff_BODYother_HEART,
#         "./stored/brms_models/r_d4_46_scored_46_wdm_diff_BODYother_HEART")

r_d4_46_scored_46_wdm_diff_BODYother_HEART <- readRDS("./stored/brms_models/r_d4_46_scored_46_wdm_diff_BODYother_HEART")

summary(r_d4_46_scored_46_wdm_diff_BODYother_HEART)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYnausea_MIND <- brm(
#   diff ~ 1 + character,
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - MIND*"),
#   cores = 4)
# 
# saveRDS(r_d4_46_scored_46_wdm_diff_BODYnausea_MIND,
#         "./stored/brms_models/r_d4_46_scored_46_wdm_diff_BODYnausea_MIND")

r_d4_46_scored_46_wdm_diff_BODYnausea_MIND <- readRDS("./stored/brms_models/r_d4_46_scored_46_wdm_diff_BODYnausea_MIND")

summary(r_d4_46_scored_46_wdm_diff_BODYnausea_MIND)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYother_MIND <- brm(
#   diff ~ 1 + character,
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - MIND*"),
#   cores = 4)
# 
# saveRDS(r_d4_46_scored_46_wdm_diff_BODYother_MIND,
#         "./stored/brms_models/r_d4_46_scored_46_wdm_diff_BODYother_MIND")

r_d4_46_scored_46_wdm_diff_BODYother_MIND <- readRDS("./stored/brms_models/r_d4_46_scored_46_wdm_diff_BODYother_MIND")

summary(r_d4_46_scored_46_wdm_diff_BODYother_MIND)
```

```{r}
# r_d4_46_scored_46_wdm_diff_HEART_MIND <- brm(
#   diff ~ 1 + character,
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND*"),
#   cores = 4)
# 
# saveRDS(r_d4_46_scored_46_wdm_diff_HEART_MIND,
#         "./stored/brms_models/r_d4_46_scored_46_wdm_diff_HEART_MIND")

r_d4_46_scored_46_wdm_diff_HEART_MIND <- readRDS("./stored/brms_models/r_d4_46_scored_46_wdm_diff_HEART_MIND")

summary(r_d4_46_scored_46_wdm_diff_HEART_MIND)
```

```{r}
regtab_d4_46_scored_46_wdm_diff <- diff_reg_table_fun(
  reg_list = list(r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother,
                  r_d4_46_scored_46_wdm_diff_BODYnausea_HEART,
                  r_d4_46_scored_46_wdm_diff_BODYother_HEART,
                  r_d4_46_scored_46_wdm_diff_BODYnausea_MIND,
                  r_d4_46_scored_46_wdm_diff_BODYother_MIND,
                  r_d4_46_scored_46_wdm_diff_HEART_MIND),
  pair_list = c("BODY (nausea) - BODY (other)",
                "BODY (nausea) - HEART*", "BODY (other) - HEART*",
                "BODY (nausea) - MIND", "BODY (other) - MIND",
                "HEART* - MIND"),
  study_name = "Children, 4-6y (using their own scales, 4-factor solution)",
  char_label = c("Robot vs. GM"))
```

```{r}
# interim table for ease of writing
regtab_d4_46_scored_46_wdm_diff %>%
  select(-study, -s.e.) %>%
  filter(param == "Intercept") %>%
  kable(digits = 2) %>%
  kable_styling()
```

```{r, fig.width = 5, fig.asp = 0.4}
# interim plot for ease of writing
plot_d4_46_scored_46_wdm_diff
```

Visualizations of relationships among 4- to 6-year-old children's scores on the _BODY\*_, _HEART\*_, and _MIND_ scales are provided in Figure B.xx, row B. The results of Bayesian regressions comparing difference scores between conceptual units to zero, controlling for differences in assessments of the nine "diverse characters" that were featured as target characters in these studies, are provided in Table B.xx.

The main take-aways of this analysis are that 4- to 6-year-old children reliably endorsed _BODY (other)_ items more strongly than any other items, but showed no reliable asymmetries between the remaining conceptual units (_BODY (nausea)_, _HEART\*_, and _MIND_).

### Discussion

```{r}
altscales_study3 <- bind_rows(
  scales_efa_wdm_d4_ad %>% 
    mutate(study = "Adults"),
  scales_efa_par_d4_46 %>%
    mutate(study = "Younger children, 4-6y (3-factor solution)"),
  scales_efa_wdm_d4_46 %>%
    mutate(study = "Younger children, 4-6y (4-factor solution)")) %>%
  select(-c(loading, order)) %>%
  distinct() %>%
  mutate(study = factor(study,
                        levels = c("Adults",
                                   "Younger children, 4-6y (3-factor solution)",
                                   "Younger children, 4-6y (4-factor solution)"))) %>%
  spread(study, factor) %>%
  mutate(ur_factor = ifelse(!is.na(`Adults`), 
                            `Adults`, 
                            ifelse(!is.na(`Younger children, 4-6y (3-factor solution)`),
                                   `Younger children, 4-6y (3-factor solution)`,
                                   `Younger children, 4-6y (4-factor solution)`))) %>%
  left_join(scales_efa_wdm_d4_ad %>% 
              select(capacity, order) %>% rename(order_ad = order)) %>%
  left_join(scales_efa_par_d4_46 %>% 
              select(capacity, order) %>% rename(order_46_par = order)) %>%
  left_join(scales_efa_wdm_d4_46 %>% 
              select(capacity, order) %>% rename(order_46_wdm = order)) %>%
  arrange(ur_factor, order_ad, order_46_par, order_46_wdm) %>%
  select(-c(ur_factor, starts_with("order")))
```

```{r}
tableB.2 <- altscales_study3 %>%
  mutate_all(as.character) %>%
  # deal with younger children, 3-factor solution
  mutate(temp1 = `Younger children, 4-6y (3-factor solution)`,
         temp2 = gsub("\\*", "", temp1),
         temp3 = case_when(
           temp2 == `Adults` ~ "✓",
           is.na(temp2) ~ "",
           TRUE ~ temp1)) %>%
  mutate(`Younger children, 4-6y (3-factor solution)` = temp3) %>%
  select(-starts_with("temp")) %>%
  # deal with younger children, 4-factor solution
  mutate(temp1 = `Younger children, 4-6y (4-factor solution)`,
         temp2 = gsub("\\*", "", temp1),
         temp3 = case_when(
           temp2 == `Adults` | 
             temp2 == `Younger children, 4-6y (3-factor solution)` |
             (is.na(`Adults`) & is.na(`Younger children, 4-6y (3-factor solution)`)) ~ "✓",
           is.na(temp2) ~ "",
           TRUE ~ temp1)) %>%
  mutate(`Younger children, 4-6y (4-factor solution)` = temp3) %>%
  select(-starts_with("temp")) %>%
  mutate_at(vars(`Adults`),
            funs(ifelse(is.na(.), "", "✓"))) %>%
  rename(Capacity = capacity,
         `4-factor solution` = `Younger children, 4-6y (4-factor solution)`,
         `3-factor solution` = `Younger children, 4-6y (3-factor solution)`) %>%
  kable(format = "html",
        caption = "Table B.2: Scales for each of the conceptual units (factors) identified by EFA for US Adults and younger children in Study 4 (see Chapter III). For younger children, this includes scales for both three- and four-factor EFA solutions. A checkmark indicates that a mental capacity was included in a scale for a particular sample. The conceptual units of younger children in the four-factor solution differed substantially from those of adults, such that some mental capacities were included in different scales across age groups. In these cases, the name of the scale is provided (rather than a checkmark).") %>%
  kable_styling() %>%
  group_rows("BODY scale", 1, 5) %>%
  group_rows("HEART scale", 6, 10) %>%
  group_rows("MIND scale", 11, 15) %>%
  add_header_above(c(" " = 2,
                     "Younger children, 4-6y" = 2))
```

```{r tableB.2, include = T}
tableB.2
```

```{r}
figureB.3 <- plot_grid(fig_d4_46_scored_46_par_plots_leg_title,
                       fig_d4_46_scored_46_wdm_plots_leg_title,
                       rel_heights = c(1, 2), ncol = 1)

figureB.3_cap <- add_sub(figureB.3, str_wrap("Figure B.3: Relationships among younger children's attributions of conceptual units in Study 4, scored using their own scales (see Table B.2). Two sets of scores are presented: using a three-factor EFA solution (A1-A3) and using a four-factor EFA solution (B1-B6). Plots are organized by sample and scale used (rows) and by pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.4}
ggdraw(figureB.3_cap)
```

```{r}
figureB.4_plots <- plot_grid(
  plot_d4_46_scored_46_par_diff + 
    labs(title = "Study 4: Children, 4-6y\n(scored using their own scales, 3-factor solution)") +
    theme(legend.position = "none"), 
  plot_d4_46_scored_46_wdm_diff + 
    labs(title = "Study 4: Children, 4-6y\n(scored using their own scales, 4-factor solution)") +
    theme(legend.position = "none"), 
  ncol = 2, rel_widths = c(1, 2),
  labels = "AUTO")

figureB.4_plots_leg <- plot_grid(figureB.4_plots,
                                 get_legend(plot_d4_46_scored_46_par_diff),
                                 ncol = 1, rel_heights = c(1, 0.1))

figureB.4_cap <- add_sub(figureB.4_plots_leg, str_wrap("Figure B.4: Difference scores between 4- to 6-year-old children's attributions of conceptual units in Study 4, using their own scales. This includes difference scores using the four-factor EFA solution (panel A) and difference scores using the three-factor solution (panel B; see Table B.2). For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 180), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 8, fig.asp = 0.38}
ggdraw(figureB.4_cap)
```


# Age-related changes in difference scores between conceptual units

XX __CONVERT TO BRMS__

## Study 2

```{r, include = T}
d2_79_scored_ad_diff %>% 
  left_join(d2_79 %>% distinct(subid, age)) %>%
  ggplot(aes(x = age, y = diff, color = character)) +
  geom_hline(yintercept = 0, lty = 2) +
  facet_wrap(~ pair) +
  geom_point(alpha = 0.5) +
  geom_pointrange(data = d2_ad_scored_ad_diff %>%
                    group_by(pair) %>%
                    multi_boot_standard(col = "diff") %>%
                    ungroup() %>%
                    mutate(age = 11),
                  aes(y = mean, ymin = ci_lower, ymax = ci_upper, color = NULL),
                  color = "black", shape = "diamond") +
  scale_color_manual(values = colors02) +
  scale_x_continuous(breaks = c(7:11), minor_breaks = NULL,
                     labels = c(paste0(7:10, "y"), "Adults")) +
  geom_smooth(color = "black", method = "lm") +
  labs(title = "Study 2: Difference scores over age",
       x = "Age (y)", y = "Difference score", color = "Target character") +
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))
```

```{r}
temp_d2_BH <- lm(diff ~ 1 + character * age,
                 data = d2_79_scored_ad_diff %>%
                   filter(pair == "BODY - HEART") %>%
                   left_join(d2_79 %>% distinct(subid, age)) %>%
                   mutate(age = scale(age, scale = F)))
summary(temp_d2_BH)$coefficients %>% kable(digits = 2) %>% kable_styling()

temp_d2_BM <- lm(diff ~ 1 + character * age,
                 data = d2_79_scored_ad_diff %>%
                   filter(pair == "BODY - MIND") %>%
                   left_join(d2_79 %>% distinct(subid, age)) %>%
                   mutate(age = scale(age, scale = F)))
summary(temp_d2_BM)$coefficients %>% kable(digits = 2) %>% kable_styling()

temp_d2_HM <- lm(diff ~ 1 + character * age,
                 data = d2_79_scored_ad_diff %>%
                   filter(pair == "HEART - MIND") %>%
                   left_join(d2_79 %>% distinct(subid, age)) %>%
                   mutate(age = scale(age, scale = F)))
summary(temp_d2_HM)$coefficients %>% kable(digits = 2) %>% kable_styling()
```

## Study 3

```{r, include = T}
d3_79_scored_ad_diff %>% 
  left_join(d3_79 %>% distinct(subid, age)) %>%
  full_join(d3_46_scored_ad_diff %>%
              left_join(d3_46 %>% distinct(subid, age))) %>%
  # NOTE: MISSING 35 AGES!!
  ggplot(aes(x = age, y = diff, color = character)) +
  geom_hline(yintercept = 0, lty = 2) +
  facet_wrap(~ pair) +
  geom_point(alpha = 0.5) +
  geom_pointrange(data = d3_ad_scored_ad_diff %>%
                    group_by(pair) %>%
                    multi_boot_standard(col = "diff") %>%
                    ungroup() %>%
                    mutate(age = 11),
                  aes(y = mean, ymin = ci_lower, ymax = ci_upper, color = NULL),
                  color = "black", shape = "diamond") +
  scale_color_manual(values = colors09) +
  scale_x_continuous(breaks = c(4:11), minor_breaks = NULL,
                     labels = c(paste0(4:10, "y"), "Adults")) +
  geom_smooth(color = "black", method = "lm") +
  labs(title = "Study 3: Difference scores over age",
       x = "Age (y)", y = "Difference score", color = "Target character") +
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))
```

```{r}
temp_d3_BH <- lm(diff ~ 1 + character * age,
                 data = d3_79_scored_ad_diff %>%
                   left_join(d3_79 %>% distinct(subid, age)) %>%
                   full_join(d3_46_scored_ad_diff %>%
                               left_join(d3_46 %>% distinct(subid, age))) %>%
                   filter(pair == "BODY - HEART") %>%
                   mutate(age = scale(age, scale = F)))
summary(temp_d3_BH)$coefficients %>% kable(digits = 2) %>% kable_styling()

temp_d3_BM <- lm(diff ~ 1 + character * age,
                 data = d3_79_scored_ad_diff %>%
                   left_join(d3_79 %>% distinct(subid, age)) %>%
                   full_join(d3_46_scored_ad_diff %>%
                               left_join(d3_46 %>% distinct(subid, age))) %>%
                   filter(pair == "BODY - MIND") %>%
                   mutate(age = scale(age, scale = F)))
summary(temp_d3_BM)$coefficients %>% kable(digits = 2) %>% kable_styling()

temp_d3_HM <- lm(diff ~ 1 + character * age,
                 data = d3_79_scored_ad_diff %>%
                   left_join(d3_79 %>% distinct(subid, age)) %>%
                   full_join(d3_46_scored_ad_diff %>%
                               left_join(d3_46 %>% distinct(subid, age))) %>%
                   filter(pair == "HEART - MIND") %>%
                   mutate(age = scale(age, scale = F)))
summary(temp_d3_HM)$coefficients %>% kable(digits = 2) %>% kable_styling()
```

## Study 4

```{r, include = T}
d4_46_scored_ad_diff %>% 
  left_join(d4_46 %>% distinct(subid, age)) %>%
  ggplot(aes(x = age, y = diff, color = character)) +
  geom_hline(yintercept = 0, lty = 2) +
  facet_wrap(~ pair) +
  geom_point(alpha = 0.5) +
  geom_pointrange(data = d4_ad_scored_ad_diff %>%
                    group_by(pair) %>%
                    multi_boot_standard(col = "diff") %>%
                    ungroup() %>%
                    mutate(age = 6),
                  aes(y = mean, ymin = ci_lower, ymax = ci_upper, color = NULL),
                  color = "black", shape = "diamond") +
  scale_color_manual(values = colors02) +
  scale_x_continuous(breaks = c(4:6), minor_breaks = NULL,
                     labels = c(paste0(4:5, "y"), "Adults")) +
  geom_smooth(color = "black", method = "lm") +
  labs(title = "Study 4: Difference scores over age",
       x = "Age (y)", y = "Difference score", color = "Target character") +
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))
```

```{r}
temp_d4_BH <- lmer(diff ~ 1 + character * age + (1 | subid),
                   data = d4_46_scored_ad_diff %>%
                     filter(pair == "BODY - HEART") %>%
                     left_join(d4_46 %>% distinct(subid, age)) %>%
                     mutate(age = scale(age, scale = F)))
summary(temp_d4_BH)$coefficients %>% kable(digits = 2) %>% kable_styling()

temp_d4_BM <- lmer(diff ~ 1 + character * age + (1 | subid),
                   data = d4_46_scored_ad_diff %>%
                     filter(pair == "BODY - MIND") %>%
                     left_join(d4_46 %>% distinct(subid, age)) %>%
                     mutate(age = scale(age, scale = F)))
summary(temp_d4_BM)$coefficients %>% kable(digits = 2) %>% kable_styling()

temp_d4_HM <- lmer(diff ~ 1 + character * age + (1 | subid),
                   data = d4_46_scored_ad_diff %>%
                     filter(pair == "HEART - MIND") %>%
                     left_join(d4_46 %>% distinct(subid, age)) %>%
                     mutate(age = scale(age, scale = F)))
summary(temp_d4_HM)$coefficients %>% kable(digits = 2) %>% kable_styling()
```

# The joint dependency of HEART on both BODY and MIND

A particularly robust and reliable finding reported in the main text of Chapter IV was that US adults virtually never endorsed HEART more strongly than either BODY or MIND. (US children between the ages of 4-9y also demonstrated increasingly adult-like asymmetries in their BODY, HEART, and MIND attributions with age.) I argued in that chapter that this pattern of findings is consitent with the possibility that adults' mental capacity attributions are governed by an intuitive theory of mental life specifying that, in order for a being to have the social-emotional abilities of the HEART, it must also have the physiological sensations of the BODY _and_ the perceptual-cognitive abilities of the mind. 

I illustrated support for this hypothesis with a visualization of participants' _BODY_, _HEART_, and _MIND_ scores, which demonstrated that, among adults in Studies 1-4, strong endorsements of _HEART_ abilities only occurred among participants who also gave strong endorsements of _both_ _BODY_ and _MIND_ abilities (see Figure 4.11, top row). These tendencies appeared to be weaker among children (middle and bottom rows).

Here I provide a formal analysis of joint dependency in each age group separately, and a formal comparison of these tendencies across age groups. These analyses were conducted using data pooled across all samples (i.e., Studies 1-4 for adults, Studies 2 and 3 for 7- to 9-year-old children, and Studies 3 and 4 for 4- to 6-year-old children). The primary parameter of interest in these analyses is the interaction between _BODY_ and _MIND_ scores: If attributions of HEART are jointly dependent on attributions of both BODY and MIND, then the interaction between _BODY_ and _MIND_ scores should be a strong predictor of _HEART_ scores, above and beyond either _BODY_ scores or _MIND_ scores on their own. In addition to using _BODY_ scores (when _MIND_ scores are at zero), _MIND_ scores (when _BODY_ scores are at zero), and the interaction between _BODY_ and _MIND_ scores to predict _HEART_ scores, these models also include random intercepts for participants, nested within studies, and random intercepts for target characters.

Among adults, the interaction between _BODY_ and _MIND_ scores was clearly differentiable from zero, lending further support to the claim that HEART is jointly dependent on both BODY and MIND among US adults. In contrast, the interaction between _BODY_ and _MIND_ scores was not differentiable from zero among either 7- to 9-year-old or 4- to 6-year-old children (see "BODY \* MIND" row in Table B.3), suggesting that this joint dependency is not present in the aggregate for either of these age groups. A formal comparison across age groups further confirmed these apparent developmental differences: The interactive effect was substantially attenuated among both older children and younger children, relative to adults (see "BODY & MIND" rows in Table B.4).

```{r}
# r_jointdep <- brm(HEART ~ BODY * MIND * age_group +
#                     (1 | character) + (1 | study/subid),
#                   data = scores_all %>% spread(factor, score),
#                   cores = 4)
# saveRDS(r_jointdep, "./stored/brms_models/r_jointdep")

r_jointdep <- readRDS("./stored/brms_models/r_jointdep")

summary(r_jointdep)
```

```{r}
# r_jointdep_ad <- brm(HEART ~ BODY * MIND + (1 | character) + (1 | study/subid),
#                      data = scores_all %>% spread(factor, score) %>%
#                        filter(age_group == "Adults"),
#                      cores = 4)
# saveRDS(r_jointdep_ad, "./stored/brms_models/r_jointdep_ad")

r_jointdep_ad <- readRDS("./stored/brms_models/r_jointdep_ad")

summary(r_jointdep_ad)
```

```{r}
# r_jointdep_79 <- brm(HEART ~ BODY * MIND + (1 | character) + (1 | study),
#                      data = d2_79_scored_ad %>% 
#                        full_join(d3_79_scored_ad) %>%
#                        spread(factor, score),
#                      cores = 4, iter = 2000,
#                      control = list(adapt_delta = 0.999))
# saveRDS(r_jointdep_79, "./stored/brms_models/r_jointdep_79")

r_jointdep_79 <- readRDS("./stored/brms_models/r_jointdep_79")

summary(r_jointdep_79)
```

```{r}
# r_jointdep_46 <- brm(HEART ~ BODY * MIND + (1 | character) + (1 | study/subid),
#                      data = d3_46_scored_ad %>%
#                        full_join(d4_46_scored_ad) %>%
#                        spread(factor, score),
#                      cores = 4, iter = 2000,
#                      control = list(adapt_delta = 0.999))
# saveRDS(r_jointdep_46, "./stored/brms_models/r_jointdep_46")

r_jointdep_46 <- readRDS("./stored/brms_models/r_jointdep_46")

summary(r_jointdep_46)
```

```{r}
regtab_jointdep_byagegroup <- bind_rows(
  fixef(r_jointdep_ad) %>%
    data.frame() %>%
    rownames_to_column("param") %>%
    mutate(age_group = "Adults"),
  fixef(r_jointdep_79) %>%
    data.frame() %>%
    rownames_to_column("param") %>%
    mutate(age_group = "Children, 7-9y"),
  fixef(r_jointdep_46) %>%
    data.frame() %>%
    rownames_to_column("param") %>%
    mutate(age_group = "Children, 4-6y")) %>%
  rename(b = Estimate, s.e. = Est.Error) %>%
  mutate(param = factor(param,
                        levels = c("Intercept", "BODY", "MIND", "BODY:MIND")),
         b = format(round(b, 2), nsmall = 2),
         s.e. = format(round(s.e., 2), nsmall = 2),
         CI95 = paste0("[", format(round(Q2.5, 2), nsmall = 2),
                       ", ", format(round(Q97.5, 2), nsmall = 2), "]"),
         nonzero = ifelse(Q2.5 * Q97.5 >= 0, "*", "")) %>%
  select(-starts_with("Q")) %>%
  select(-starts_with("s.e.")) %>%
  gather(key, value, -c(age_group, param)) %>%
  mutate(key = case_when(age_group == "Adults" ~ paste0("ad_", key),
                         age_group == "Children, 7-9y" ~ paste0("ch01_", key),
                         age_group == "Children, 4-6y" ~ paste0("ch02_", key))) %>%
  select(-age_group) %>%
  spread(key, value) %>%
  arrange(param)
```

```{r}
tableB.3 <- regtab_jointdep_byagegroup %>%
  select(-contains("s.e.")) %>%
  rename(Parameter = param,
         b = ad_b, b = ch01_b, b = ch02_b,
         `95% CI` = ad_CI95, `95% CI` = ch01_CI95, `95% CI` = ch02_CI95,
         " " = ad_nonzero, " " = ch01_nonzero, " " = ch02_nonzero) %>%
  kable(format = "html", align = c("l", rep(c(rep("r", 2), "l"), 3)), 
        caption = "Table B.3: Regression analyses of the joint dependency of HEART on both BODY and MIND. The table presents results from a series of Bayesian regressions using pooled data from all samples within an age group (i.e., Studies 1-4 for adults, Studies 2 and 3 for 7- to 9-year-old children, and Studies 3 and 4 for 4 - to 6-year-old children. These regressions each included 4 fixed effect parameters: (1) the intercept, which is an index of HEART scores when BODY and MIND scores were both zero; (2) the effect of BODY scores on HEART scores (when MIND scores were zero); (3) the effect of MIND scores on HEART scores (when BODY scores were zero); and (4) the interactive effect of BODY and MIND scores on HEART scores. This last effect is highlighted in bold, because it is the primary parameter of interest for these analyses. In addition to the fixed effects listed here, these regressions included random intercepts for participants, nested within studies, for adults and for 4- to 6-year-old children; random intercepts for studies for 7- to 9-year-old children (since neither study with this age group featured a within-subjects design); and random intercepts for target characters (n = 21 for adults, n = 9 for both 7- to 9-year-old and 4- to 6-year-old children). For each parameter, the table includes the estimate (b) and a 95% credible interval for that estimate. Asterisks indicate 95% credible intervals that do not include 0.") %>%  
  kable_styling() %>%
  row_spec(4, bold = T) %>%
  add_header_above(c(" " = 1,
                     "Adults" = 3, "Children, 7-9y" = 3, "Children, 4-6y" = 3))
```

```{r, include = T}
tableB.3
```

```{r}
regtab_jointdep_devcomp <- fixef(r_jointdep) %>%
  data.frame() %>%
  rownames_to_column("param") %>%
  mutate(CI95 = paste0("[", format(round(Q2.5, 2), nsmall = 2),
                       ", ", format(round(Q97.5, 2), nsmall = 2), "]"),
         nonzero = ifelse(Q2.5 * Q97.5 >= 0, "*", "")) %>%
  rename(b = Estimate, s.e. = Est.Error) %>%
  mutate(param = factor(param,
                        levels = c("Intercept", 
                                   "age_group_old", 
                                   "age_group_yng",
                                   "BODY", 
                                   "BODY:age_group_old", 
                                   "BODY:age_group_yng",
                                   "MIND", "MIND:age_group_old", 
                                   "MIND:age_group_yng",
                                   "BODY:MIND", 
                                   "BODY:MIND:age_group_old", 
                                   "BODY:MIND:age_group_yng"),
                        labels = c("Intercept",
                                   "Older children vs. adults",
                                   "Younger children vs. adults",
                                   "BODY",
                                   "BODY * Older children vs. adults",
                                   "BODY * Younger children vs. adults",
                                   "MIND",
                                   "MIND * Older children vs. adults",
                                   "MIND * Younger children vs. adults",
                                   "BODY * MIND",
                                   "BODY * MIND * Older children vs. adults",
                                   "BODY * MIND * Younger children vs. adults"))) %>%
  select(param, b, s.e., CI95, nonzero) %>%
  arrange(param)
```

```{r}
tableB.4 <- regtab_jointdep_devcomp %>%
  select(-contains("s.e.")) %>%
  mutate(b = format(round(b, 2), nsmall = 2)) %>%
  rename(Parameter = param,
         `95% CI` = CI95) %>%
  rename_all(funs(gsub("nonzero", " ", .))) %>%
  kable(format = "html", align = c("l", rep(c(rep("r", 2), "l"), 3)), 
        caption = "Table B.3: Developmental comparisons of the joint dependency of HEART on both BODY and MIND. The table presents results from a single Bayesian regression using pooled data from all samples in all studies. This regression included 12 fixed effect parameters: (1) the intercept (for adults), which is an index of HEART scores among adults when BODY and MIND scores were both zero; (2-3) the differences between older children vs. adults and younger children vs. adults in their HEART scores when BODY and MIND scores were both zero; (4-6) the effect of BODY scores on HEART scores for adults, and differences from adults in this effect for older and younger children; (7-9) the effect of MIND scores on HEART scores for adults, and differences from adults in this effect for older and younger children; (10-11) the interactive effect of BODY and MIND scores on HEART scores for adults, and differences from adults in this interactive effect for older and younger children. These last three effects  are highlighted in bold, because these are the primary parameters of interest for these analyses. In addition to the fixed effects listed here, the regression included random intercepts for participants, nested within studies, and random intercepts for characters (n = 24). For each parameter, the table includes the estimate (b) and a 95% credible interval for that estimate. Asterisks indicate 95% credible intervals that do not include 0.") %>%  
  kable_styling() %>%
  row_spec(c(10:12), bold = T) %>%
  group_rows("HEART scores when BODY scores and MIND scores = 0", 1, 3) %>%
  group_rows("The effect of BODY scores on HEART scores when MIND scores = 0", 4, 6) %>%
  group_rows("The effect of MIND scores on HEART scores when BODY scores = 0", 7, 9) %>%
  group_rows("The interactive effect of BODY scores and MIND scores on HEART scores", 10, 12)
```

```{r, include = T}
tableB.4
```

