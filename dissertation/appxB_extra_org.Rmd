---
title: "Appendix B: Additional explorations of organization"
output:
  html_notebook:
    toc: yes
    toc_depth: 4
    toc_float: yes
always_allow_html: yes
---

```{r global_options, include = F}
knitr::opts_chunk$set(fig.width = 3, fig.asp = 0.67,
                      include = F, echo = F)
```

```{r}
# # for knitting to .docx
# output:
#   word_document:
#     reference_docx: "./word-styles-reference.docx"
# always_allow_html: yes
   
# # for knitting to .nb.html 
# output:
#   html_notebook:
#     toc: yes
#     toc_depth: 4
#     toc_float: yes
```

```{r}
# run ur-setup script (which runs other scripts)
source("./scripts/_SETUP.R")
 
# load in EFAs & names from Chapters III & IV
source("./scripts/stored_ch03.R")
source("./scripts/stored_ch04.R")
```

# Appendix overview

In this appendix, I report additional exploratory analyses of the organization of the sets of "conceptual units" that were excluded from the main text of Chapter IV, including: (a) Analyses using children's own scales to assess organization among older children (7-9y of age) and younger children (4-6y of age) in Study 3 and among children (4-5y of age) in Study 4; and (b) XX.


# Using children's own scales

In Chapter IV, I used adults' EFA solution to construct BODY, HEART, and MIND scales and used these scales to assess the organization of these adult-like conceptual units among both adult and child samples. For Study 2, I also used 7- to 9-year-old children's own EFA solution to construct a separate set of scales based on children's own conceptual units and conducted a separate set of analyses of the organization of these "child-like" conceptual units. Here I present a parallel set of analyses using children's own EFA solutions (rather than adults') to assess the organization of conceptual units among both older children (7-9y of age) and younger children (4-6y of age) in Study 3, as well as among children (4-5y of age) in Study 4.

## Study 3

### Older children, using their own scales

#### Scale construction

```{r}
# done in ch04_organization.Rmd
# scales_efa_wdm_d3_79 <- readRDS(file = "./stored/scales/scales_efa_wdm_d3_79")

d3_79_scored_79 <- score_fun(d3_79, scales_efa_wdm_d3_79)
saveRDS(d3_79_scored_79, file = "./stored/scored_data/d3_79_scored_79")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d3_79)` scales of `r scales_efa_wdm_d3_79 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.3.

#### Visualization

```{r}
plots_d3_79_scored_79 <- relviz_fun(d3_79_scored_79, colors = colors09)
```

```{r}
fig_d3_79_scored_79_plots <- plot_grid(plots_d3_79_scored_79[[1]] + 
                                         theme(legend.position = "none"),
                                       plots_d3_79_scored_79[[2]] + 
                                         theme(legend.position = "none"),
                                       plots_d3_79_scored_79[[3]] + 
                                         theme(legend.position = "none"),
                                       labels = c("A1", "A2", "A3"), ncol = 3)

fig_d3_79_scored_79_leg <- get_legend(
  plots_d3_79_scored_79[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character", values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_79_scored_79_plots_leg <- plot_grid(
  fig_d3_79_scored_79_plots, fig_d3_79_scored_79_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d3_79_scored_79_title <- ggdraw() + 
  draw_label("Study 3: Children, 7-9y (scored using their own scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_79_scored_79_plots_leg_title <- plot_grid(
  fig_d3_79_scored_79_title, fig_d3_79_scored_79_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

```{r}
d3_79_scored_79_diff <- diff_fun(d3_79_scored_79)
saveRDS(d3_79_scored_79_diff, "./stored/diffscore_data/d3_79_scored_79_diff")
```

```{r}
plot_d3_79_scored_79_diff <- diffplot_fun(d3_79_scored_79_diff, colors09)
```

```{r}
# r_d3_79_scored_79_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_79_scored_79_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_79_scored_79_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d3_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_79_scored_79_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - HEART"))

summary(r_d3_79_scored_79_diff_BODY_HEART)
```

```{r}
# r_d3_79_scored_79_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_79_scored_79_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_79_scored_79_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d3_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_79_scored_79_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - MIND"))

summary(r_d3_79_scored_79_diff_BODY_MIND)
```

```{r}
# r_d3_79_scored_79_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_79_scored_79_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_79_scored_79_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d3_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_79_scored_79_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d3_79_scored_79_diff %>% filter(pair == "HEART - MIND"))

summary(r_d3_79_scored_79_diff_HEART_MIND)
```

### Younger children, using their own scales (three-factor solution)

XX suggested by WDM

#### Scale construction

```{r}
scales_efa_wdm_d3_46 <- scale_fun(efa_wdm_d3_46, 
                                   factor_names = factor_names_efa_wdm_d3_46)
d3_46_scored_46_wdm <- score_fun(d3_46, scales_efa_wdm_d3_46)
saveRDS(scales_efa_wdm_d3_46, file = "./stored/scales/scales_efa_wdm_d3_46")
saveRDS(d3_46_scored_46_wdm, file = "./stored/scored_data/d3_46_scored_46_wdm")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d3_46)` scales of `r scales_efa_wdm_d3_46 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.3.

#### Visualization

```{r}
plots_d3_46_scored_46_wdm <- relviz_fun(d3_46_scored_46_wdm, colors = colors09)
```

```{r}
fig_d3_46_scored_46_wdm_plots <- plot_grid(plots_d3_46_scored_46_wdm[[1]] + 
                                             theme(legend.position = "none"),
                                           plots_d3_46_scored_46_wdm[[2]] + 
                                             theme(legend.position = "none"),
                                           plots_d3_46_scored_46_wdm[[3]] + 
                                             theme(legend.position = "none"),
                                           labels = c("B1", "B2", "B3"),
                                           ncol = 3)

fig_d3_46_scored_46_wdm_leg <- get_legend(
  plots_d3_46_scored_46_wdm[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character", values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_46_scored_46_wdm_plots_leg <- plot_grid(
  fig_d3_46_scored_46_wdm_plots, fig_d3_46_scored_46_wdm_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d3_46_scored_46_wdm_title <- ggdraw() + 
  draw_label("Study 3: Children, 4-6y (scored using their own scales, 3-factor solution)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_46_scored_46_wdm_plots_leg_title <- plot_grid(
  fig_d3_46_scored_46_wdm_title, fig_d3_46_scored_46_wdm_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

```{r}
d3_46_scored_46_wdm_diff <- diff_fun(d3_46_scored_46_wdm)
saveRDS(d3_46_scored_46_wdm_diff, "./stored/diffscore_data/d3_46_scored_46_wdm_diff")
```

```{r}
plot_d3_46_scored_46_wdm_diff <- diffplot_fun(d3_46_scored_46_wdm_diff, colors09)
```

```{r}
# r_d3_46_scored_46_wdm_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - HEART*"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_46_wdm_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - HEART*"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_46_wdm_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - HEART*"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_46_wdm_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - HEART*"))

summary(r_d3_46_scored_46_wdm_diff_BODY_HEART)
```

```{r}
# r_d3_46_scored_46_wdm_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_46_wdm_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_46_wdm_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_46_wdm_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - MIND"))

summary(r_d3_46_scored_46_wdm_diff_BODY_MIND)
```

```{r}
# r_d3_46_scored_46_wdm_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_46_wdm_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_46_wdm_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_46_wdm_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND"))

summary(r_d3_46_scored_46_wdm_diff_HEART_MIND)
```

### Younger children, using their own scales (two-factor solution)

#### Scale construction

XX suggested by parallel analysis

```{r}
scales_efa_par_d3_46 <- scale_fun(efa_par_d3_46,
                                  factor_names = factor_names_efa_par_d3_46)
d3_46_scored_46_par <- score_fun(d3_46, scales_efa_par_d3_46)
saveRDS(scales_efa_wdm_d3_46, file = "./stored/scales/scales_efa_par_d3_46")
saveRDS(d3_46_scored_46_par, file = "./stored/scored_data/d3_46_scored_46_par")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_par_d3_46)` scales of `r scales_efa_par_d3_46 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.3.

#### Visualization

```{r}
plots_d3_46_scored_46_par <- relviz_fun(d3_46_scored_46_par, colors = colors09)
```

```{r}
fig_d3_46_scored_46_par_plots <- plot_grid(plots_d3_46_scored_46_par[[1]] + 
                                             theme(legend.position = "none"),
                                           labels = c("C1"), ncol = 3)

fig_d3_46_scored_46_par_leg <- get_legend(
  plots_d3_46_scored_46_par[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character", values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_46_scored_46_par_plots_leg <- plot_grid(
  fig_d3_46_scored_46_par_plots, fig_d3_46_scored_46_par_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d3_46_scored_46_par_title <- ggdraw() + 
  draw_label("Study 3: Children, 4-6y (scored using their own scales, 2-factor solution)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_46_scored_46_par_plots_leg_title <- plot_grid(
  fig_d3_46_scored_46_par_title, fig_d3_46_scored_46_par_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

```{r}
d3_46_scored_46_par_diff <- diff_fun(d3_46_scored_46_par)
saveRDS(d3_46_scored_46_par_diff, "./stored/diffscore_data/d3_46_scored_46_par_diff")
```

```{r}
plot_d3_46_scored_46_par_diff <- diffplot_fun(d3_46_scored_46_par_diff, colors09)
```

```{r}
# r_d3_46_scored_46_par_diff_BODYHEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_par_diff %>% filter(pair == "BODY-HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_46_par_diff_BODYHEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_par_diff %>% filter(pair == "BODY-HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_46_par_diff_BODYHEART_MIND <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_46_par_diff %>% filter(pair == "BODY-HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_46_par_diff_BODYHEART_MIND <- lm(
#   diff ~ 1,
#   data = d3_46_scored_46_par_diff %>% filter(pair == "BODY-HEART - MIND"))

summary(r_d3_46_scored_46_par_diff_BODYHEART_MIND)
```

### Discussion

```{r}
scales_study3 <- bind_rows(scales_efa_wdm_d3_ad %>% 
                             mutate(study = "Adults"),
                           scales_efa_wdm_d3_79 %>% 
                             mutate(study = "Older children, 7-9y"),
                           scales_efa_wdm_d3_46 %>%
                             mutate(study = "Younger children, 4-6y (3-factor solution)"),
                           scales_efa_par_d3_46 %>%
                             mutate(study = "Younger children, 4-6y (2-factor solution)")) %>%
  select(-c(loading, order)) %>%
  distinct() %>%
  mutate(study = factor(study,
                        levels = c("Adults",
                                   "Older children, 7-9y",
                                   "Younger children, 4-6y (3-factor solution)",
                                   "Younger children, 4-6y (2-factor solution)"))) %>%
  spread(study, factor) %>%
  mutate(ur_factor = ifelse(!is.na(`Adults`), 
                            `Adults`, 
                            ifelse(!is.na(`Older children, 7-9y`), 
                                   `Older children, 7-9y`,
                                   ifelse(is.na(`Younger children, 4-6y (3-factor solution)`), 
                                          `Younger children, 4-6y (3-factor solution)`,
                                          `Younger children, 4-6y (2-factor solution)`)))) %>%
  left_join(scales_efa_wdm_d3_ad %>% 
              select(capacity, order) %>% rename(order_ad = order)) %>%
  left_join(scales_efa_wdm_d3_79 %>% 
              select(capacity, order) %>% rename(order_79 = order)) %>%
  arrange(ur_factor, order_ad, order_79) %>%
  select(-c(ur_factor, starts_with("order")))
```

```{r}
table4.3 <- scales_study3 %>%
  mutate_all(as.character) %>%
  # deal with younger children, 2-factor solution
  mutate(temp1 = `Younger children, 4-6y (2-factor solution)`,
         temp2 = gsub("\\*", "", temp1),
         temp3 = case_when(
           temp2 == `Adults` | 
             temp2 == `Older children, 7-9y` ~ "✓",
           is.na(temp2) ~ "",
           TRUE ~ temp1)) %>%
  mutate(`Younger children, 4-6y (2-factor solution)` = temp3) %>%
  select(-starts_with("temp")) %>%
  # deal with younger children, 3-factor solution
  mutate(temp1 = `Younger children, 4-6y (3-factor solution)`,
         temp2 = gsub("\\*", "", temp1),
         temp3 = case_when(
           temp2 == `Adults` | 
             temp2 == `Older children, 7-9y` |
             (is.na(`Adults`) & is.na(`Older children, 7-9y`)) ~ "✓",
           is.na(temp2) ~ "",
           TRUE ~ temp1)) %>%
  mutate(`Younger children, 4-6y (3-factor solution)` = temp3) %>%
  select(-starts_with("temp")) %>%
  mutate_at(vars(`Adults`, `Older children, 7-9y`),
            funs(ifelse(is.na(.), "", "✓"))) %>%
  mutate_at(vars(starts_with("Younger")),
            funs(ifelse(is.na(.), "", .))) %>%
  rename(Capacity = capacity,
         `3-factor solution` = `Younger children, 4-6y (3-factor solution)`,
         `2-factor solution` = `Younger children, 4-6y (2-factor solution)`) %>%
  kable(format = "html",
        caption = "Table 4.3: Scales for each of the conceptual units (factors) identified by EFA for US Adults, older children, and younger children in Study 3 (see Chapter III). For younger children, this includes scales for both three- and two-factor EFA solutions. A checkmark indicates that a mental capacity was included in a scale for a particular sample. The conceptual units of younger children differed substantially from those of older children and adults, such that some mental capacities were included in different scales across age groups (e.g., feel scared was part of the BODY scale for older children and adults, but part of the HEART* scale for younger children). In these cases, the name of the scale is provided (rather than a checkmark).") %>%
  kable_styling() %>%
  group_rows("BODY scale", 1, 7) %>%
  group_rows("HEART scale", 8, 14) %>%
  group_rows("MIND scale", 15, 20) %>%
  add_header_above(c(" " = 3,
                     "Younger children, 4-6y" = 2))
```

```{r table4.3, include = T}
table4.3
```

```{r}
figure4.9 <- plot_grid(fig_d3_79_scored_79_plots_leg_title, 
                       fig_d3_46_scored_46_wdm_plots_leg_title,
                       fig_d3_46_scored_46_par_plots_leg_title,
                       ncol = 1)

figure4.9_cap <- add_sub(figure4.9, str_wrap("Figure 4.9: Relationships among older and younger children's attributions of conceptual units in Study 3, scored using their own scales (see Table 4.3). For younger children (4-6y of age), two sets of scores are presented: using a three-factor EFA solution (B1-B3) and using a two-factor EFA solution (C1-C3). Plots are organized by sample and scale used (rows) and by pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.4}
ggdraw(figure4.9_cap)
```

```{r}
figure4.11_plots <- plot_grid(
  plot_d3_79_scored_79_diff +
    labs(title = "Study 3: Children, 7-9y\n(scored using their own scales)") +
    theme(legend.position = "none"),
  plot_d3_46_scored_46_wdm_diff + 
    labs(title = "Study 3: Children, 4-6y\n(scored using their own scales, 3-factor solution)") +
    theme(legend.position = "none"), 
  plot_d3_46_scored_46_par_diff + 
    labs(title = "Study 3: Children, 4-6y\n(scored using their own scales, 2-factor solution)") +
    theme(legend.position = "none"), 
  ncol = 3, rel_widths = c(1, 1, 0.8),
  labels = "AUTO")

figure4.11_plots_leg <- plot_grid(figure4.11_plots,
                                  get_legend(plot_d3_79_scored_79_diff),
                                  ncol = 1, rel_heights = c(1, 0.1))

figure4.11_cap <- add_sub(figure4.11_plots_leg, str_wrap("Figure 4.11: Difference scores between 7- to 9-year-old children's and 4- to 6-year-old children's attributions of conceptual units in Study 3, using their own scales. For younger children (4-6y of age), this includes difference scores using the three-factor EFA solution (panel B) and difference scores using the two-factor solution (panel C; see Table 4.3). For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 180), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 8, fig.asp = 0.38}
ggdraw(figure4.11_cap)
```

## Study 4

### Children, using their own scales (three-factor solution)

#### Scale construction

```{r}
scales_efa_par_d4_46 <- scale_fun(efa_par_d4_46,
                                  factor_names = factor_names_efa_par_d4_46)
d4_46_scored_46_par <- score_fun(d4_46, scales_efa_par_d4_46)
saveRDS(scales_efa_par_d4_46, file = "./stored/scales/scales_efa_par_d4_46")
saveRDS(d4_46_scored_46_par, file = "./stored/scored_data/d4_46_scored_46_par")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_par_d4_46)` scales of `r scales_efa_par_d4_46 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.4.

#### Visualization

```{r}
plots_d4_46_scored_46_par <- relviz_fun(d4_46_scored_46_par, colors = colors02)
```

```{r}
fig_d4_46_scored_46_par_plots <- plot_grid(plots_d4_46_scored_46_par[[1]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_par[[2]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_par[[3]] + 
                                             theme(legend.position = "none"),
                                           labels = c("A1", "A2", "A3"), ncol = 3)

fig_d4_46_scored_46_par_leg <- get_legend(
  plots_d4_46_scored_46_par[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal", 
                                            ncol = 2)))

fig_d4_46_scored_46_par_plots_leg <- plot_grid(
  fig_d4_46_scored_46_par_plots, fig_d4_46_scored_46_par_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d4_46_scored_46_par_title <- ggdraw() + 
  draw_label("Study 4: Children, 4-5y (scored using their own scales, 3-factor solution)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d4_46_scored_46_par_plots_leg_title <- plot_grid(
  fig_d4_46_scored_46_par_title, fig_d4_46_scored_46_par_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

```{r}
d4_46_scored_46_par_diff <- diff_fun(d4_46_scored_46_par)
saveRDS(d4_46_scored_46_par_diff, "./stored/diffscore_data/d4_46_scored_46_par_diff")
```

```{r}
plot_d4_46_scored_46_par_diff <- diffplot_fun(d4_46_scored_46_par_diff, colors02)
```

```{r}
# r_d4_46_scored_46_par_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_par_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_par_diff_BODY_HEART <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_par_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - HEART"))

summary(r_d4_46_scored_46_par_diff_BODY_HEART)
```

```{r}
# r_d4_46_scored_46_par_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_par_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_par_diff_BODY_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_par_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - MIND"))

summary(r_d4_46_scored_46_par_diff_BODY_MIND)
```

```{r}
# r_d4_46_scored_46_par_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_par_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_par_diff_HEART_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_par_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_par_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "HEART - MIND"))

summary(r_d4_46_scored_46_par_diff_HEART_MIND)
```

### Children, using their own scales (four-factor solution)

#### Scale construction

```{r}
scales_efa_wdm_d4_46 <- scale_fun(efa_wdm_d4_46, 
                                   factor_names = factor_names_efa_wdm_d4_46)
d4_46_scored_46_wdm <- score_fun(d4_46, scales_efa_wdm_d4_46)
saveRDS(scales_efa_wdm_d4_46, file = "./stored/scales/scales_efa_wdm_d4_46")
saveRDS(d4_46_scored_46_wdm, file = "./stored/scored_data/d4_46_scored_46_wdm")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d4_46)` scales of `r scales_efa_wdm_d4_46 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.4.

#### Visualization

```{r}
plots_d4_46_scored_46_wdm <- relviz_fun(d4_46_scored_46_wdm, colors = colors02)
```

```{r}
fig_d4_46_scored_46_wdm_plots <- plot_grid(plots_d4_46_scored_46_wdm[[1]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_wdm[[2]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_wdm[[3]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_wdm[[4]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_wdm[[5]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_wdm[[6]] + 
                                             theme(legend.position = "none"),
                                           labels = c("B1", "B2", "B3", 
                                                      "B4", "B5", "B6"), 
                                           ncol = 3)

fig_d4_46_scored_46_wdm_leg <- get_legend(
  plots_d4_46_scored_46_wdm[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character",
                       values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d4_46_scored_46_wdm_plots_leg <- plot_grid(fig_d4_46_scored_46_wdm_plots,
                                               fig_d4_46_scored_46_wdm_leg,
                                               ncol = 1, rel_heights = c(1, 0.05))

fig_d4_46_scored_46_wdm_title <- ggdraw() + 
  draw_label("Study 4: Children, 4-5y (scored using their own scales, 4-factor solution)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d4_46_scored_46_wdm_plots_leg_title <- plot_grid(
  fig_d4_46_scored_46_wdm_title, fig_d4_46_scored_46_wdm_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

```{r}
d4_46_scored_46_wdm_diff <- diff_fun(d4_46_scored_46_wdm)
saveRDS(d4_46_scored_46_wdm_diff, "./stored/diffscore_data/d4_46_scored_46_wdm_diff")
```

```{r}
plot_d4_46_scored_46_wdm_diff <- diffplot_fun(d4_46_scored_46_wdm_diff, colors02)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - BODY (other)"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - BODY (other)"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - BODY (other)"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - BODY (other)"))

summary(r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYnausea_HEART <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - HEART*"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_wdm_diff_BODYnausea_HEART <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - HEART*"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_wdm_diff_BODYnausea_HEART <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - HEART*"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_wdm_diff_BODYnausea_HEART <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - HEART*"))

summary(r_d4_46_scored_46_wdm_diff_BODYnausea_HEART)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYother_HEART <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - HEART*"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_wdm_diff_BODYother_HEART <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - HEART*"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_wdm_diff_BODYother_HEART <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - HEART*"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_wdm_diff_BODYother_HEART <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - HEART*"))

summary(r_d4_46_scored_46_wdm_diff_BODYother_HEART)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYnausea_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - MIND*"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_wdm_diff_BODYnausea_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - MIND*"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_wdm_diff_BODYnausea_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - MIND*"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_wdm_diff_BODYnausea_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - MIND*"))

summary(r_d4_46_scored_46_wdm_diff_BODYnausea_MIND)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYother_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - MIND*"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_wdm_diff_BODYother_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - MIND*"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_wdm_diff_BODYother_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - MIND*"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_wdm_diff_BODYother_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - MIND*"))

summary(r_d4_46_scored_46_wdm_diff_BODYother_MIND)
```

```{r}
# r_d4_46_scored_46_wdm_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND*"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_wdm_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND*"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_wdm_diff_HEART_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND*"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_wdm_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND*"))

summary(r_d4_46_scored_46_wdm_diff_HEART_MIND)
```


### Discussion

```{r}
scales_study4 <- bind_rows(scales_efa_wdm_d4_ad %>% 
                             mutate(study = "Adults"),
                           scales_efa_par_d4_46 %>%
                             mutate(study = "Children, 4-5y (3-factor solution)"),
                           scales_efa_wdm_d4_46 %>%
                             mutate(study = "Children, 4-5y (4-factor solution)")) %>%
  select(-c(loading, order)) %>%
  distinct() %>%
  mutate(study = factor(study,
                        levels = c("Adults",
                                   "Children, 4-5y (3-factor solution)",
                                   "Children, 4-5y (4-factor solution)"))) %>%
  spread(study, factor) %>%
  mutate(ur_factor = ifelse(!is.na(`Adults`), 
                            `Adults`,
                            ifelse(is.na(`Children, 4-5y (3-factor solution)`),
                                   `Children, 4-5y (3-factor solution)`,
                                   `Children, 4-5y (4-factor solution)`))) %>%
  left_join(scales_efa_wdm_d4_ad %>% 
              select(capacity, order) %>% rename(order_ad = order)) %>%
  arrange(ur_factor, order_ad) %>%
  select(-c(ur_factor, starts_with("order")))
```

```{r}
table4.4 <- scales_study4 %>%
  mutate_all(as.character) %>%
  # deal with Children, 4-factor solution
  mutate(temp1 = `Children, 4-5y (4-factor solution)`,
         temp2 = gsub("\\*", "", temp1),
         temp3 = case_when(
           temp2 == `Adults` ~ "✓",
           is.na(temp2) ~ "",
           TRUE ~ temp1)) %>%
  mutate(`Children, 4-5y (4-factor solution)` = temp3) %>%
  select(-starts_with("temp")) %>%
  # deal with Children, 3-factor solution
  mutate(temp1 = `Children, 4-5y (3-factor solution)`,
         temp2 = gsub("\\*", "", temp1),
         temp3 = case_when(
           temp2 == `Adults` ~ "✓",
           is.na(temp2) ~ "",
           TRUE ~ temp1)) %>%
  mutate(`Children, 4-5y (3-factor solution)` = temp3) %>%
  select(-starts_with("temp")) %>%
  mutate_at(vars(`Adults`),
            funs(ifelse(is.na(.), "", "✓"))) %>%
  mutate_at(vars(starts_with("Younger")),
            funs(ifelse(is.na(.), "", .))) %>%
  rename(Capacity = capacity,
         `3-factor solution` = `Children, 4-5y (3-factor solution)`,
         `4-factor solution` = `Children, 4-5y (4-factor solution)`) %>%
  kable(format = "html",
        caption = "Table 4.4: Scales for each of the conceptual units (factors) identified by EFA for US Adults and children in Study 4 (see Chapter III). For children, this includes scales for both three- and four-factor EFA solutions. A checkmark indicates that a mental capacity was included in a scale for a particular sample. The conceptual units of younger children differed substantially from those of adults, such that some mental capacities were included in different scales across age groups (e.g., love someone was part of the HEART scale for adults, but part of the MIND* scale in the four-factor solution for younger children). In these cases, the name of the scale is provided (rather than a checkmark).") %>%
  kable_styling() %>%
  group_rows("BODY scale", 1, 5) %>%
  group_rows("HEART scale", 6, 10) %>%
  group_rows("MIND scale", 11, 15) %>%
  add_header_above(c(" " = 2,
                     "Children, 4-5y" = 2))
```

```{r table4.4, include = T}
table4.4
```

```{r}
figure4.13 <- plot_grid(fig_d4_46_scored_46_par_plots_leg_title, 
                        fig_d4_46_scored_46_wdm_plots_leg_title,
                        ncol = 1, rel_heights = c(1, 2))

figure4.13_cap <- add_sub(figure4.13, str_wrap("Figure 4.13: Relationships among US adults', older children's, and younger children's attributions of conceptual units in Study 3, scored using their own scales scales (see Table 4.4). Ttwo sets of scores are presented: using a three-factor EFA solution (A1-A3) and using a four-factor EFA solution (B1-B6). Plots are organized by scale used (rows) and by pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.35}
ggdraw(figure4.13_cap)
```

```{r}
figure4.15_plots <- plot_grid(
  plot_d4_46_scored_46_par_diff + 
    labs(title = "Study 4: Children, 4-6y\n(scored using their own scales, 3-factor solution)") +
    theme(legend.position = "bottom"), 
  plot_d4_46_scored_46_wdm_diff + 
    labs(title = "Study 4: Children, 4-6y\n(scored using their own scales, 4-factor solution)") +
    theme(legend.position = "bottom"), 
  ncol = 2, rel_widths = c(1, 2),
  labels = "AUTO")

figure4.15_cap <- add_sub(figure4.15_plots, str_wrap("Figure 4.15: Difference scores between 4- to 5-year-old children's attributions of conceptual units in Study 4, using their own scales. This includes difference scores using the three-factor EFA solution (panel A) and difference scores using the four-factor solution (panel B; see Table 4.4). For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 180), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 8, fig.asp = 0.38}
ggdraw(figure4.15_cap)
```

