---
title: "Chapter IV: Changes in organization of conceptual units"
output:
  html_notebook:
    toc: yes
    toc_depth: 4
    toc_float: yes
always_allow_html: yes
---

```{r global_options, include = F}
knitr::opts_chunk$set(fig.width = 3, fig.asp = 0.67,
                      include = F, echo = F)
```

```{r}
# # for knitting to .docx
# output:
#   word_document:
#     reference_docx: "./word-styles-reference.docx"
# always_allow_html: yes

# # for knitting to .nb.html 
# output:
#   html_notebook:
#     toc: yes
#     toc_depth: 4
#     toc_float: yes
```

```{r}
# run ur-setup script (which runs other scripts)
source("./scripts/_SETUP.R")
```

```{r}
# load in EFAs from Chapter III
# study 1
efa_par_d1a_ad <- readRDS(file = "./efas/efa_par_d1a_ad")
efa_bic_d1a_ad <- readRDS(file = "./efas/efa_bic_d1a_ad")
efa_wdm_d1a_ad <- readRDS(file = "./efas/efa_wdm_d1a_ad")

efa_par_d1b_ad <- readRDS(file = "./efas/efa_par_d1b_ad")
efa_bic_d1b_ad <- readRDS(file = "./efas/efa_bic_d1b_ad")
efa_wdm_d1b_ad <- readRDS(file = "./efas/efa_wdm_d1b_ad")

efa_par_d1c_ad <- readRDS(file = "./efas/efa_par_d1c_ad")
efa_bic_d1c_ad <- readRDS(file = "./efas/efa_bic_d1c_ad")
efa_wdm_d1c_ad <- readRDS(file = "./efas/efa_wdm_d1c_ad")

efa_par_d1d_ad <- readRDS(file = "./efas/efa_par_d1d_ad")
efa_bic_d1d_ad <- readRDS(file = "./efas/efa_bic_d1d_ad")
efa_wdm_d1d_ad <- readRDS(file = "./efas/efa_wdm_d1d_ad")

# study 2
efa_par_d2_ad <- readRDS(file = "./efas/efa_par_d2_ad")
efa_bic_d2_ad <- readRDS(file = "./efas/efa_bic_d2_ad")
efa_wdm_d2_ad <- readRDS(file = "./efas/efa_wdm_d2_ad")

efa_par_d2_79 <- readRDS(file = "./efas/efa_par_d2_79")
efa_bic_d2_79 <- readRDS(file = "./efas/efa_bic_d2_79")
efa_wdm_d2_79 <- readRDS(file = "./efas/efa_wdm_d2_79")

# study 3
efa_par_d3_ad <- readRDS(file = "./efas/efa_par_d3_ad")
efa_bic_d3_ad <- readRDS(file = "./efas/efa_bic_d3_ad")
efa_wdm_d3_ad <- readRDS(file = "./efas/efa_wdm_d3_ad")

efa_par_d3_79 <- readRDS(file = "./efas/efa_par_d3_79")
efa_bic_d3_79 <- readRDS(file = "./efas/efa_bic_d3_79")
efa_wdm_d3_79 <- readRDS(file = "./efas/efa_wdm_d3_79")

efa_par_d3_46 <- readRDS(file = "./efas/efa_par_d3_46")
efa_bic_d3_46 <- readRDS(file = "./efas/efa_bic_d3_46")
efa_wdm_d3_46 <- readRDS(file = "./efas/efa_wdm_d3_46")

# study 4
efa_par_d4_ad <- readRDS(file = "./efas/efa_par_d4_ad")
efa_bic_d4_ad <- readRDS(file = "./efas/efa_bic_d4_ad")
efa_wdm_d4_ad <- readRDS(file = "./efas/efa_wdm_d4_ad")

efa_par_d4_46 <- readRDS(file = "./efas/efa_par_d4_46")
efa_bic_d4_46 <- readRDS(file = "./efas/efa_bic_d4_46")
efa_wdm_d4_46 <- readRDS(file = "./efas/efa_wdm_d4_46")

# load in factor names from Chapter III
# study 1
factor_names_efa_wdm_d1a_ad <- readRDS( 
  file = "./factor_names/factor_names_efa_wdm_d1a_ad")
factor_names_efa_wdm_d1b_ad <- readRDS( 
  file = "./factor_names/factor_names_efa_wdm_d1b_ad")
factor_names_efa_wdm_d1c_ad <- readRDS( 
  file = "./factor_names/factor_names_efa_wdm_d1c_ad")
factor_names_efa_wdm_d1d_ad <- readRDS( 
  file = "./factor_names/factor_names_efa_wdm_d1d_ad")

# study 2
factor_names_efa_wdm_d2_ad <- readRDS( 
  file = "./factor_names/factor_names_efa_wdm_d2_ad")
factor_names_efa_par_d2_ad <- readRDS( 
  file = "./factor_names/factor_names_efa_par_d2_ad")
factor_names_efa_wdm_d2_79 <- readRDS( 
  file = "./factor_names/factor_names_efa_wdm_d2_79")

# study 3
factor_names_efa_wdm_d3_ad <- readRDS( 
  file = "./factor_names/factor_names_efa_wdm_d3_ad")
factor_names_efa_wdm_d3_79 <- readRDS( 
  file = "./factor_names/factor_names_efa_wdm_d3_79")
factor_names_efa_wdm_d3_46 <- readRDS( 
  file = "./factor_names/factor_names_efa_wdm_d3_46")
factor_names_efa_par_d3_46 <- readRDS( 
  file = "./factor_names/factor_names_efa_par_d3_46")

# study 4
factor_names_efa_wdm_d4_ad <- readRDS( 
  file = "./factor_names/factor_names_efa_wdm_d4_ad")
factor_names_efa_par_d4_46 <- readRDS( 
  file = "./factor_names/factor_names_efa_par_d4_46")
factor_names_efa_wdm_d4_46 <- readRDS( 
  file = "./factor_names/factor_names_efa_wdm_d4_46")
```

```{r}
# colors for plotting target characters
colors02 <- c("#e41a1c", "#377eb8")
colors09 <- colorRampPalette(c("#e31a1c", "#ff7f00", "#33a02c", 
                               "#1f78b4", "#6a3d9a"), # from colorbrewer2.org "Paired"
                             space = "Lab")(9)
colors21 <- colorRampPalette(c("#e31a1c", "#ff7f00", "#33a02c", 
                               "#1f78b4", "#6a3d9a"), # from colorbrewer2.org "Paired"
                             space = "Lab")(21)
```

```{r}
# contrasts for regressions

# target character: 2 edge cases
contrasts_sum_edge <- cbind("_robot_GM" = c(-1, 1))
contrasts_trt_edge <- cbind("_robot" = c(0, 1))

# target character: 21 diverse characters
contrasts_sum_dv21 <- contr.sum(21)
contrasts_trt_dv21 <- contr.treatment(21)

# target character: 9 diverse characters
contrasts_sum_dv09 <- contr.sum(9)
contrasts_trt_dv09 <- contr.treatment(9)


# age group: 2 age groups
contrasts_sum2_agegp <- cbind("_child_GM" = c(-1, 1))
contrasts_dum2_agegp <- cbind("_child" = c(0, 1))

# age group: 2 age groups
contrasts_sum3_agegp <- cbind("_old_GM" = c(-1, 0, 1),
                              "_yng_GM" = c(-1, 1, 0))
contrasts_dum3_agegp <- cbind("_old" = c(0, 0, 1),
                              "_yng" = c(0, 1, 0))
```


# Chapter overview

In this chapter, I focus on the second of my three key questions about the development of representations of mental life: _How are the conceptual units that anchor representations of mental life organized in relation to each other, and how does this organization change over development?_ As in Chapter III, to address this question I draw on data from all of the current studies (Studies 1-4); for details about the methods of these studies, see Chapter II. The goal of this chapter is to provide "snapshots" of the organization of conceptual units in early childhood, middle childhood, and adulthood.


# General analysis plan

## High-level overview

My goal in this chapter is to examine the relationships among the "conceptual units" identified in Chapter III. How does a participant's assessment of one conceptual unit for a particular target character (e.g., the degree to which he or she indicates that a beetle is capable of the physiological sensations of the BODY) affect that participant's assessments of other conceptual units for that target character (e.g., his or her assessment of the beetle's capaciteis in the domains of HEART or MIND)?

I focus in particular on the possibility that the mental capacity attributions documented by the studies included in this dissertation—re-analyzed as indicators of the broader "conceptual units" identified in Chapter III—might shed light on the _hierarchical organization_ of these conceptual units, i.e., which conceptual units might be more basic or fundamental vs. more complex, and whether any of these conceptual units might or might not be considered to depend on the presence of others. In Chapter II, I illustrated this with the following example: If many participants endorse capacities associated with Conceptual Unit A without endorsing capacities associated with Conceptual Unit B, but very few participants do the reverse (endorsing capacities associated with Conceptual Unit B but not Conceptual Unit A), this provides some evidence that Conceptual Unit A is more basic or fundamental than Conceptual Unit B, or that Conceptual Unit B somehow depends on (perhaps requires) Conceptual Unit A. 

Here I will translate this general interest in the relationships among conceptual units, as well as the specific intuition about how to detect the kinds of asymmetries that would be the signature of hierarchical relationships, into a specific analysis plan to be applied to each of these datasets in turn. 

## Details of analyses

Unlike the previous chapter, in which I employed a canonical approach to identifying latent constructs through analyses of correlation structures—exploratory factor analysis (EFA)—in this chapter there is no tried-and-true method for meeting my analysis goals. Instead, I chart my own course through these datasets, using the EFA solutions reported in Chapter II to score participants' endorsements of each conceptual unit for the particular target character(s) that they assessed, examining visualizations of the complicated relationships among these endorsements, and then conducting more targeted statistical analyses of one particular aspect of these relationships: the possibility of asymmetries in the endorsements of these conceptual units.

### Scoring endorsements of conceptual units

The first step in these analyses is to transform participants' ratings of individual mental capacities into "scores" that indicate the extent to which they endorsed a particular conceptual unit for the target character(s) that they were assigned to assess. To do this, I make use of the EFAs presented in Chapter II—which originally served to identify a set of conceptual units in a particular sample—to a new end: the construction of "scales" for each of these conceptual units. Scale construction is a common use of EFA and similar dimensionality reduction analyses (if anything, more common than using EFA to make the kinds of theoretical arguments featured in Chapter II).

For each EFA solution, I construct a scale for each of the factors (conceptual units) identified by that solution. First, I sort each of the mental capacities included in that study into categories based on their loadings on each of the factors in that solution. For each mental capacity, I identify the "dominant" factor as the factor with the largest positive factor loading. For example, if the mental capacity _feel happy_ had loadings of 0.60 on the BODY factor, 0.70 on the HEART factor, and 0.30 on the MIND factor, I would sort it into the HEART category. For each factor, I take the six highest-loading items as a candidate scale, then "drop" the capacities with the smallest factor loadings on their respective dominant factors until I have the same number of mental capacities in each category. For example, if the BODY factor were the dominant factor for nine mental capacities, the HEART factor for six mental capacities, and the MIND factor for five capacities, for each factor I would keep only the capacities with the five highest positive loadings on that factor, in order to construct three scales of equal length (and a maximum length of six items).

To calculate scores on these scales, I take the average of all of mental capacities for each scale. This yields a dataset in which each participant is associated with one score for each of the conceptual units identified in the relative EFA solution, for each of the target characters that that participant assessed.

In this chapter, I apply this method to all of the three-factor solutions for adult samples as presented in Chapter II (Studies 1-4), yielding BODY, HEART, and MIND scores for each target character as assessed by each participant. (I ignore the aberrant four-factor solution for adults in Study 2 suggested by one of the three factor retention protocols considered in that chapter, since this was the only study out of the seven considered in which a four-factor solution appeared to add any value beyond the robust BODY-HEART-MIND framework common to all studies. [XX APPENDIX B?])

For child samples, I apply this method both to the solutions emerging from children's own data and to the corresponding _adult_ solutions for the studies in question. This allows me to explore both the relationships among children's own conceptual units, and the relationships among a fully adult-like set of conceptual units (presumably, the conceptual units that these children will eventually come to agree on as they mature into adults). 

For "older" children (7-9y of age; Studies 2 and 3), this means examining two sets of three conceptual units for each sample of children: (1) BODY, HEART, and MIND as defined by adults in that study; and (2) BODY, HEART, and MIND as defined by the children themselves. Because the EFAs for older children and adults are so similar (see Chapter II), I expect the outcomes of these two approaches to constructing BODY, HEART, and MIND scales to yield very similar results in this age group.

For "younger" children, this means examining multiple sets of conceptual units for each sample of children, including (1) BODY, HEART, and MIND as defined by adults in that study; and (2) varying sets of 2-4 conceptual units as defined by EFA of children's own responses, using different factor retention protocols. The EFAs of younger children's responses  were less reliable, and less adult-like, than those of older children. As a consequence, I expect the outcomes of these different approaches to constructing scales for each conceptual unit to yield rather different results in this age group.

The reader should note that this is far from the only way to approach "scoring" participants on these conceptual units. In particular, I could have examined factor scores—summaries of each factor (conceptual unit) based on a participant's responses to all mental capacities and the relationships between all mental capacities and all factors included in that EFA solution—rather than constructing "scales" in the way I have just outlined. However, much like _z_-scores, factor scores indicate where a participant falls in relation to other participants in the sample, and do not provide the kind of absolute score that is key to my goal in this chapter, which is to analyze relationships among factors in terms of the extent to which individual participants indicated that target characters "possessed" the conceptual units BODY, HEART, and MIND. [XX APPENDIX B?]

Even within the "scale" approach described in this section, there are many parameters of this analysis that I could have set differently. For example, I could have considered absolute factor loadings rather than raw factor loadings, which would allow for mental capacities that loaded especially strongly _negatively_ on a particular factor to contribute (negatively) to scores on that conceptual unit; I could have omitted the step of making the scales for all factors within a single EFA sotluion equal length; I could have chosen to use only the top 4 or 5 mental capacities across all EFA solutions, or to set no limit on the number of items in a scale; or I could have implemented absolute thresholds for how strongly a mental capacity must load on a factor in order to count toward the score for that conceptual unit, or absolute limits on the degree to which a mental capacity can "cross-load" on non-dominant factors and still count toward the score for any one conceptual unit. [XX APPENDIX B?] However, these kinds of details differ quite dramatically across studies and age groups. For example, in some samples there are no strong negative factor loadings, and in others there are; if I considered absolute loadings rather than raw loadings, I could end up comparing scores from a "bipolar" scale in one sample to scores from a "unipolar" scales in another sample, making the comparison more difficult to interpret. Likewise, some EFA solutions tended to feature generally weaker factor loadings than others; if I were to impose absolute thresholds for the strength of factor loadings, I could end up comparing scores from scales of wildly different lengths across samples. In my view, the analysis decisions outlined above maximize comparability across studies and age groups—the primary goal of this chapter. (Note, however, that in the analysis code for this chapter I have included easy short cuts for the interested reader to explore different options for each of these parameters.)

```{r}
# see "./scripts/org_param.R" for parameter setting
```

### Visualizing relationships

XX

outline:

- for any sample, I have identified relevant conceptual units (chapter II) and scored each participant's endorsement of each of these units for their assigned target character(s) (previous section)
- now, I want to assess the relationships among these endorsements 
- but I don't really know what to expect, and these relationships could be very complex
- so, start with holistic, exploratory visualization: scatterplots of pairs of conceptual units


### Targeting the possibility of asymmetries

XX

outline:

- now, a more targeted approach to one particular aspect of these relationships: asymmetries
- reminder of basic intuition: in this sample, do participants tend to endorse A without B? B without A? is there an asymmetry here?
- connect to the visualizations: asymmetries of points around the y=x line of equivalence
- one way to boil this down to a number: difference scores (for each pair), comparisons to 0 via bayesian regressions
- for any pair: if 0, no evidence for hierarchy. if non-zero, some evidence.
- comparisons across pairs: further from 0, more hierarchical.
- caveat 1: these are post-hoc analyses! but still using confirmatory stats. 
- caveat 2: scores of (0,0) treated same as scores of (6,6), or anywhere in between.


# Study 1: An adult endpoint

In the context of this dissertation, Study 1 serves the role of describing a developmental endpoint for conceptual representations of mental life. In this chapter, I focus on what these studies can reveal about the relationships among the conceptual units discussed in Chapter III. These analyses were not part of the original publication of these studies (Weisman et al., 2017).

## Special notes on data processing and analysis

As noted in Chapter II, in the original analysis of these datasets responses were recoded to run from -3 to +3 before analyses (Weisman et al., 2017); in this dissertation, I maintain the 0-6 coding for comparability to Studies 2-4.

## Results

### Study 1a

In Study 1a, `r nrow(d1a_ad_wide)` US adults each assessed a single target character on 40 mental capacities. This study employed the "edge case" variant of the general approach, with participants randomly assigned to assess either a beetle or a robot. (See Chapter II and Weisman et al., 2017, for detailed methods.)

#### Scale construction

```{r}
scales_efa_wdm_d1a_ad <- scale_fun(efa_wdm_d1a_ad, 
                                   factor_names = factor_names_efa_wdm_d1a_ad)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d1a_ad)` scales of `r scales_efa_wdm_d1a_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.1.

```{r}
d1a_ad_scored_ad <- score_fun(d1a_ad, scales_efa_wdm_d1a_ad)
```

#### Visualization

XX

```{r}
plots_d1a_ad_scored_ad <- relviz_fun(d1a_ad_scored_ad)
```

```{r}
fig_d1a_ad_plots <- plot_grid(plots_d1a_ad_scored_ad[[1]] + 
                                theme(legend.position = "none"),
                              plots_d1a_ad_scored_ad[[2]] + 
                                theme(legend.position = "none"),
                              plots_d1a_ad_scored_ad[[3]] + 
                                theme(legend.position = "none"),
                              labels = c("A1", "A2", "A3"), ncol = 3)

fig_d1a_ad_leg <- get_legend(
  plots_d1a_ad_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d1a_ad_plots_leg <- plot_grid(fig_d1a_ad_plots, fig_d1a_ad_leg,
                                  ncol = 1, rel_heights = c(1, 0.05))

fig_d1a_ad_title <- ggdraw() + 
  draw_label("Study 1a: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d1a_ad_plots_leg_title <- plot_grid(fig_d1a_ad_title, fig_d1a_ad_plots_leg,
                                        ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

XX

```{r}
d1a_ad_scored_ad_diff <- diff_fun(d1a_ad_scored_ad)
```

```{r}
plot_d1a_ad_scored_ad_diff <- diffplot_fun(d1a_ad_scored_ad_diff)
```

```{r}
# r_d1a_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1a_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1a_ad_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1a_ad_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d1a_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d1a_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1a_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1a_ad_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1a_ad_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d1a_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d1a_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1a_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1a_ad_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d1a_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1a_ad_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d1a_ad_scored_ad_diff_HEART_MIND)
```

### Study 1b

Study 1b was a direct replication of Study 1a: `r nrow(d1b_ad_wide)` US adults each assessed a single target character (either a beetle or a robot) on 40 mental capacities. (See Chapter II and Weisman et al., 2017, for detailed methods.)

#### Scale construction

```{r}
scales_efa_wdm_d1b_ad <- scale_fun(efa_wdm_d1b_ad, 
                                   factor_names = factor_names_efa_wdm_d1b_ad)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d1b_ad)` scales of `r scales_efa_wdm_d1b_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.1.

```{r}
d1b_ad_scored_ad <- score_fun(d1b_ad, scales_efa_wdm_d1b_ad)
```

#### Visualization

XX

```{r}
plots_d1b_ad_scored_ad <- relviz_fun(d1b_ad_scored_ad)
```

```{r}
fig_d1b_ad_plots <- plot_grid(plots_d1b_ad_scored_ad[[1]] + 
                                theme(legend.position = "none"),
                              plots_d1b_ad_scored_ad[[2]] + 
                                theme(legend.position = "none"),
                              plots_d1b_ad_scored_ad[[3]] + 
                                theme(legend.position = "none"),
                              labels = c("B1", "B2", "B3"), ncol = 3)

fig_d1b_ad_leg <- get_legend(
  plots_d1b_ad_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d1b_ad_plots_leg <- plot_grid(fig_d1b_ad_plots, fig_d1b_ad_leg,
                                  ncol = 1, rel_heights = c(1, 0.05))

fig_d1b_ad_title <- ggdraw() + 
  draw_label("Study 1b: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d1b_ad_plots_leg_title <- plot_grid(fig_d1b_ad_title, fig_d1b_ad_plots_leg,
                                        ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

XX

```{r}
d1b_ad_scored_ad_diff <- diff_fun(d1b_ad_scored_ad)
```

```{r}
plot_d1b_ad_scored_ad_diff <- diffplot_fun(d1b_ad_scored_ad_diff)
```

```{r}
# r_d1b_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1b_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1b_ad_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1b_ad_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d1b_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d1b_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1b_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1b_ad_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1b_ad_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d1b_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d1b_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1b_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1b_ad_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d1b_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1b_ad_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d1b_ad_scored_ad_diff_HEART_MIND)
```

### Study 1c

In Study 1c, `r nrow(d1c_ad_wide)/2` US adults each assessed two target characters on 40 mental capacities. Like Studies 1a and 1b, this study employed the "edge case" variant of the general approach; but in this study, all participants assessed both of these target characters side by side (with left-right position counterbalaned across participants). (See Chapter II and Weisman et al., 2017, for detailed methods.)

#### Scale construction

```{r}
scales_efa_wdm_d1c_ad <- scale_fun(efa_wdm_d1c_ad, 
                                   factor_names = factor_names_efa_wdm_d1c_ad)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d1c_ad)` scales of `r scales_efa_wdm_d1c_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.1.

```{r}
d1c_ad_scored_ad <- score_fun(d1c_ad, scales_efa_wdm_d1c_ad)
```

#### Visualization

XX

```{r}
plots_d1c_ad_scored_ad <- relviz_fun(d1c_ad_scored_ad)
```

```{r}
fig_d1c_ad_plots <- plot_grid(plots_d1c_ad_scored_ad[[1]] + 
                                theme(legend.position = "none"),
                              plots_d1c_ad_scored_ad[[2]] + 
                                theme(legend.position = "none"),
                              plots_d1c_ad_scored_ad[[3]] + 
                                theme(legend.position = "none"),
                              labels = c("C1", "C2", "C3"), ncol = 3)

fig_d1c_ad_leg <- get_legend(
  plots_d1c_ad_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d1c_ad_plots_leg <- plot_grid(fig_d1c_ad_plots, fig_d1c_ad_leg,
                                  ncol = 1, rel_heights = c(1, 0.05))

fig_d1c_ad_title <- ggdraw() + 
  draw_label("Study 1c: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d1c_ad_plots_leg_title <- plot_grid(fig_d1c_ad_title, fig_d1c_ad_plots_leg,
                                        ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

XX

```{r}
d1c_ad_scored_ad_diff <- diff_fun(d1c_ad_scored_ad)
```

```{r}
plot_d1c_ad_scored_ad_diff <- diffplot_fun(d1c_ad_scored_ad_diff)
```

```{r}
# r_d1c_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1c_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1c_ad_scored_ad_diff_BODY_HEART <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1c_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1  + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d1c_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d1c_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1c_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1c_ad_scored_ad_diff_BODY_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1c_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d1c_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d1c_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1c_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1c_ad_scored_ad_diff_HEART_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d1c_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1c_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d1c_ad_scored_ad_diff_HEART_MIND)
```

### Study 1d

In Study 1d, `r nrow(d1d_ad_wide)` US adults each assessed a single target character on 40 mental capacities. Unlike Studies 1a-1c, this study employed the "many characters" variant of the general approach, in which participants were randomly assigned to assess one of the following 21 target characters: an adult, a child, an infant, a person in a persistent vegetative state, a fetus, a chimpanzee, an elephant, a dolphin, a bear, a dog, a goat, a mouse, a frog, a blue jay, a fish, a beetle, a microbe, a robot, a computer, a car, or a stapler. (See Chapter II and Weisman et al., 2017, for detailed methods.)

#### Scale construction

```{r}
scales_efa_wdm_d1d_ad <- scale_fun(efa_wdm_d1d_ad, 
                                   factor_names = factor_names_efa_wdm_d1d_ad)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d1d_ad)` scales of `r scales_efa_wdm_d1d_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.1.

```{r}
d1d_ad_scored_ad <- score_fun(d1d_ad, scales_efa_wdm_d1d_ad)
```

#### Visualization

XX

```{r}
plots_d1d_ad_scored_ad <- relviz_fun(d1d_ad_scored_ad, colors = colors21)
```

```{r}
fig_d1d_ad_plots <- plot_grid(plots_d1d_ad_scored_ad[[1]] + 
                                theme(legend.position = "none"),
                              plots_d1d_ad_scored_ad[[2]] + 
                                theme(legend.position = "none"),
                              plots_d1d_ad_scored_ad[[3]] + 
                                theme(legend.position = "none"),
                              labels = c("D1", "D2", "D3"), ncol = 3)

fig_d1d_ad_leg <- get_legend(
  plots_d1d_ad_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors21,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 7)) +
    scale_color_manual("Target character", values = colors21,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 7)))

fig_d1d_ad_plots_leg <- plot_grid(fig_d1d_ad_plots, fig_d1d_ad_leg,
                                  ncol = 1, rel_heights = c(1, 0.2))

fig_d1d_ad_title <- ggdraw() + 
  draw_label("Study 1d: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d1d_ad_plots_leg_title <- plot_grid(fig_d1d_ad_title, fig_d1d_ad_plots_leg,
                                        ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

XX

```{r}
d1d_ad_scored_ad_diff <- diff_fun(d1d_ad_scored_ad)
```

```{r}
plot_d1d_ad_scored_ad_diff <- diffplot_fun(d1d_ad_scored_ad_diff, 
                                           colors21, wid = 0.9)
```

```{r}
# r_d1d_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv21),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1d_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv21))

r_d1d_ad_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_dv21))

# r_d1d_ad_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d1d_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d1d_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv21),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1d_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv21))

r_d1d_ad_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_dv21))

# r_d1d_ad_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d1d_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d1d_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv21),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1d_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv21))

r_d1d_ad_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d1d_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv21))

# r_d1d_ad_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d1d_ad_scored_ad_diff_HEART_MIND)
```

## Discussion

XX

```{r}
scales_study1 <- bind_rows(scales_efa_wdm_d1a_ad %>% mutate(study = "Study 1a"),
                           scales_efa_wdm_d1b_ad %>% mutate(study = "Study 1b"),
                           scales_efa_wdm_d1c_ad %>% mutate(study = "Study 1c"),
                           scales_efa_wdm_d1d_ad %>% mutate(study = "Study 1d")) %>%
  select(-c(loading, order)) %>%
  distinct() %>%
  spread(study, factor) %>%
  mutate(ur_factor = ifelse(!is.na(`Study 1a`), `Study 1a`,
                            ifelse(!is.na(`Study 1b`), `Study 1b`,
                                   ifelse(!is.na(`Study 1c`), `Study 1c`,
                                          `Study 1d`)))) %>%
  left_join(scales_efa_wdm_d1a_ad %>% 
              select(capacity, order) %>% rename(order1a = order)) %>%
  left_join(scales_efa_wdm_d1b_ad %>% 
              select(capacity, order) %>% rename(order1b = order)) %>%
  left_join(scales_efa_wdm_d1c_ad %>% 
              select(capacity, order) %>% rename(order1c = order)) %>%
  left_join(scales_efa_wdm_d1d_ad %>% 
              select(capacity, order) %>% rename(order1d = order)) %>%
  arrange(ur_factor, order1a, order1b, order1c, order1d) %>%
  select(-c(ur_factor, starts_with("order")))
```

```{r}
table4.1 <- scales_study1 %>%
  mutate_at(vars(-capacity),
            funs(ifelse(is.na(.), "", "✓"))) %>%
  rename(Capacity = capacity) %>%
  kable(format = "html", 
        caption = "Table 4.1: Scales for each of the conceptual units (factors) identified by EFA for US Adults in Studies 1a-1d (see Chapter III). A checkmark indicates that a mental capacity was included in a scale for a particular study.") %>%  
  kable_styling() %>%
  group_rows("BODY scale", 1, 9) %>%
  group_rows("HEART scale", 10, 17) %>%
  group_rows("MIND scale", 18, 26)
```

```{r table4.1, include = T}
table4.1
```

```{r}
figure4.1 <- plot_grid(fig_d1a_ad_plots_leg_title, fig_d1b_ad_plots_leg_title,
                       fig_d1c_ad_plots_leg_title, fig_d1d_ad_plots_leg_title, 
                       ncol = 1, rel_heights = c(1, 1, 1, 1.15))

figure4.1_cap <- add_sub(figure4.1, str_wrap("Figure 4.1: Relationships among US adults' attributions of conceptual units in Studies 1a-1d, organized by study (rows) and pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.8}
ggdraw(figure4.1_cap)
```

```{r}
figure4.2_plots123 <- plot_grid(plot_d1a_ad_scored_ad_diff + 
                                  labs(title = "Study 1a: Adults") +
                                  theme(legend.position = "none"), 
                                plot_d1b_ad_scored_ad_diff + 
                                  labs(title = "Study 1b: Adults") +
                                  theme(legend.position = "none"),
                                plot_d1c_ad_scored_ad_diff + 
                                  labs(title = "Study 1c: Adults") +
                                  theme(legend.position = "none"), 
                                ncol = 3, rel_widths = c(1, 1, 1),
                                labels = "AUTO")

figure4.2_plots123_leg <- plot_grid(figure4.2_plots123,
                                    get_legend(
                                      plot_d1a_ad_scored_ad_diff +
                                        theme(legend.position = "bottom")),
                                    ncol = 1, rel_heights = c(1, 0.1))

figure4.2_plots4 <- plot_grid(plot_d1d_ad_scored_ad_diff +
                                labs(title = "Study 1d: Adults") +
                                theme(legend.position = "none"),
                              labels = "D")

figure4.2_plots4_leg <- plot_grid(figure4.2_plots4,
                                  get_legend(
                                    plot_d1d_ad_scored_ad_diff +
                                      theme(legend.position = "bottom")),
                                  ncol = 1, rel_heights = c(1, 0.2))

figure4.2_plots <- plot_grid(figure4.2_plots123_leg, figure4.2_plots4_leg,
                             ncol = 1, rel_heights = c(1, 1.1))

figure4.2_cap <- add_sub(figure4.2_plots, str_wrap("Figure 4.2: Difference scores between US adults' attributions of conceptual units in Studies 1a-1d. For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 140), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 6, fig.asp = 0.8}
ggdraw(figure4.2_cap)
```


# Study 2: Conceptual change between middle childhood (7-9y) and adulthood

In Study 2, `r nrow(d2_ad_wide)` US adults and `r nrow(d2_79_wide)` US children between the ages of `r summary(d2_79$age)["Min."] %>% round(2)`-`r summary(d2_79$age)["Max."] %>% round(2)` years (median: `r summary(d2_79$age)["Median"] %>% round(2)`y) each assessed a single target character on 40 mental capacities. To make the study appropriate for children in this age range, the wording of some the 40 mental capacities employed in Study 1 was modified to use more age-appropriate vocabulary, and participants responded on a 3-point scale ("no," coded as 0; "kinda," coded as 0.5, "yes," coded as 1). This study employed the "edge case" variant of the general approach, with participants randomly assigned to assess either a beetle or a robot. (See Chapter II for detailed methods.)

## Special notes on data processing and analysis

## Results

### Adults

#### Scale construction

```{r}
scales_efa_wdm_d2_ad <- scale_fun(efa_wdm_d2_ad,
                                  factor_names = factor_names_efa_wdm_d2_ad)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d2_ad)` scales of `r scales_efa_wdm_d2_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.2.

```{r}
d2_ad_scored_ad <- score_fun(d2_ad, scales_efa_wdm_d2_ad)
```

#### Visualization

```{r}
plots_d2_ad_scored_ad <- relviz_fun(d2_ad_scored_ad)
```

```{r}
fig_d2_ad_plots <- plot_grid(plots_d2_ad_scored_ad[[1]] +
                               theme(legend.position = "none"),
                             plots_d2_ad_scored_ad[[2]] + 
                               theme(legend.position = "none"),
                             plots_d2_ad_scored_ad[[3]] + 
                               theme(legend.position = "none"),
                             labels = c("A1", "A2", "A3"), ncol = 3)

fig_d2_ad_leg <- get_legend(
  plots_d2_ad_scored_ad[[1]] + 
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d2_ad_plots_leg <- plot_grid(fig_d2_ad_plots, fig_d2_ad_leg,
                                 ncol = 1, rel_heights = c(1, 0.05))

fig_d2_ad_title <- ggdraw() + 
  draw_label("Study 2: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d2_ad_plots_leg_title <- plot_grid(fig_d2_ad_title, fig_d2_ad_plots_leg,
                                       ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

```{r}
d2_ad_scored_ad_diff <- diff_fun(d2_ad_scored_ad)
```

```{r}
plot_d2_ad_scored_ad_diff <- diffplot_fun(d2_ad_scored_ad_diff, colors02)
```

```{r}
# r_d2_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_ad_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_ad_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d2_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d2_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_ad_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_ad_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d2_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d2_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_ad_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d2_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_ad_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d2_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d2_ad_scored_ad_diff_HEART_MIND)
```

XX

### Children (7-9y)

#### Scale construction

```{r}
scales_efa_wdm_d2_79 <- scale_fun(efa_wdm_d2_79,
                                  factor_names = factor_names_efa_wdm_d2_79)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d2_79)` scales of `r scales_efa_wdm_d2_79 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.2.

```{r}
d2_79_scored_ad <- score_fun(d2_79, scales_efa_wdm_d2_ad)
d2_79_scored_79 <- score_fun(d2_79, scales_efa_wdm_d2_79)
```

#### Visualization

##### Using adults' scales

XX

```{r}
plots_d2_79_scored_ad <- relviz_fun(d2_79_scored_ad)
```

```{r}
fig_d2_79_scored_ad_plots <- plot_grid(plots_d2_79_scored_ad[[1]] + 
                                         theme(legend.position = "none"),
                                       plots_d2_79_scored_ad[[2]] + 
                                         theme(legend.position = "none"),
                                       plots_d2_79_scored_ad[[3]] + 
                                         theme(legend.position = "none"),
                                       labels = c("B1", "B2", "B3"), ncol = 3)

fig_d2_79_scored_ad_leg <- get_legend(
  plots_d2_79_scored_ad[[1]] + 
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d2_79_scored_ad_plots_leg <- plot_grid(
  fig_d2_79_scored_ad_plots, fig_d2_79_scored_ad_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d2_79_scored_ad_title <- ggdraw() + 
  draw_label("Study 2: Children, 7-9y (scored using adults' scales)", 
             size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d2_79_scored_ad_plots_leg_title <- plot_grid(
  fig_d2_79_scored_ad_title, fig_d2_79_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r}
plots_agegp_d2_scored_ad <- relviz_agegp_fun(
  d_scored = d2_ad_scored_ad %>% full_join(d2_79_scored_ad), 
  age_groups = c("children79", "adults"),
  age_group_labels = c("Children (7-9y)", "Adults"))
```

```{r}
fig_d2_all_scored_ad_plots <- plot_grid(plots_agegp_d2_scored_ad[[1]] + 
                                          theme(legend.position = "none"),
                                        plots_agegp_d2_scored_ad[[2]] + 
                                          theme(legend.position = "none"),
                                        plots_agegp_d2_scored_ad[[3]] + 
                                          theme(legend.position = "none"),
                                        labels = c("C1", "C2", "C3"), ncol = 3)

fig_d2_all_scored_ad_leg <- get_legend(
  plots_agegp_d2_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_color_manual("Target character", values = colors02,
                       na.translate = F,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d2_all_scored_ad_plots_leg <- plot_grid(
  fig_d2_all_scored_ad_plots, fig_d2_all_scored_ad_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d2_all_scored_ad_title <- ggdraw() + 
  draw_label("Tracking development between 7-9y and adulthood (scored using adults' scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d2_all_scored_ad_plots_leg_title <- plot_grid(
  fig_d2_all_scored_ad_title, fig_d2_all_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

##### Using children's own scales

XX

```{r}
plots_d2_79_scored_79 <- relviz_fun(d2_79_scored_79)
```

```{r}
fig_d2_79_scored_79_plots <- plot_grid(plots_d2_79_scored_79[[1]] + 
                                         theme(legend.position = "none"),
                                       plots_d2_79_scored_79[[2]] + 
                                         theme(legend.position = "none"),
                                       plots_d2_79_scored_79[[3]] + 
                                         theme(legend.position = "none"),
                                       labels = c("A1", "A2", "A3"), ncol = 3)

fig_d2_79_scored_79_leg <- get_legend(
  plots_d2_79_scored_79[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d2_79_scored_79_plots_leg <- plot_grid(fig_d2_79_scored_79_plots,
                                           fig_d2_79_scored_79_leg,
                                           ncol = 1, rel_heights = c(1, 0.05))

fig_d2_79_scored_79_title <- ggdraw() + 
  draw_label("Study 2: Children, 7-9y (scored using their own scales)", 
             size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d2_79_scored_79_plots_leg_title <- plot_grid(
  fig_d2_79_scored_79_title, fig_d2_79_scored_79_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

##### Using adults' scales

```{r}
d2_79_scored_ad_diff <- diff_fun(d2_79_scored_ad)
```

```{r}
plot_d2_79_scored_ad_diff <- diffplot_fun(d2_79_scored_ad_diff, colors02)
```

```{r}
# r_d2_79_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_79_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_79_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d2_79_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_79_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d2_79_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d2_79_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d2_79_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_79_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_79_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d2_79_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_79_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d2_79_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d2_79_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d2_79_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_79_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_79_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d2_79_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_79_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d2_79_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d2_79_scored_ad_diff_HEART_MIND)
```

XX

###### Developmental comparison

```{r}
# r_d2_ad79_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_ad79_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp))

r_d2_ad79_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character * age_group,
  data = d2_ad_scored_ad_diff %>% 
    full_join(d2_79_scored_ad_diff) %>%
    filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge,
                   age_group = contrasts_dum2_agegp))

# r_d2_ad79_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1 + age_group,
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(age_group = contrasts_dum2_agegp))

summary(r_d2_ad79_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d2_ad79_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_ad79_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp))

r_d2_ad79_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character * age_group,
  data = d2_ad_scored_ad_diff %>% 
    full_join(d2_79_scored_ad_diff) %>%
    filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge,
                   age_group = contrasts_dum2_agegp))

# r_d2_ad79_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1 + age_group,
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(age_group = contrasts_dum2_agegp))

summary(r_d2_ad79_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d2_ad79_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_ad79_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp))

r_d2_ad79_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character * age_group,
  data = d2_ad_scored_ad_diff %>% 
    full_join(d2_79_scored_ad_diff) %>%
    filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge,
                   age_group = contrasts_dum2_agegp))

# r_d2_ad79_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1 + age_group,
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(age_group = contrasts_dum2_agegp))

summary(r_d2_ad79_scored_ad_diff_HEART_MIND)
```

XX

##### Using children's own scales

```{r}
d2_79_scored_79_diff <- diff_fun(d2_79_scored_79)
```

```{r}
plot_d2_79_scored_79_diff <- diffplot_fun(d2_79_scored_79_diff, colors02)
```

```{r}
# r_d2_79_scored_79_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_79_scored_79_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_79_scored_79_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d2_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_79_scored_79_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d2_79_scored_79_diff %>% filter(pair == "BODY - HEART"))

summary(r_d2_79_scored_79_diff_BODY_HEART)
```

```{r}
# r_d2_79_scored_79_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_79_scored_79_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_79_scored_79_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d2_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_79_scored_79_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d2_79_scored_79_diff %>% filter(pair == "BODY - MIND"))

summary(r_d2_79_scored_79_diff_BODY_MIND)
```

```{r}
# r_d2_79_scored_79_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_79_scored_79_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_79_scored_79_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d2_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_79_scored_79_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d2_79_scored_79_diff %>% filter(pair == "HEART - MIND"))

summary(r_d2_79_scored_79_diff_HEART_MIND)
```

XX

## Discussion

XX

```{r}
scales_study2 <- bind_rows(scales_efa_wdm_d2_ad %>% mutate(study = "Adults"),
                           scales_efa_wdm_d2_79 %>% mutate(study = "Children, 7-9y")) %>%
  select(-c(loading, order)) %>%
  distinct() %>%
  spread(study, factor) %>%
  mutate(ur_factor = ifelse(!is.na(`Adults`), `Adults`, `Children, 7-9y`)) %>%
  left_join(scales_efa_wdm_d2_ad %>% 
              select(capacity, order) %>% rename(order_ad = order)) %>%
  left_join(scales_efa_wdm_d2_79 %>% 
              select(capacity, order) %>% rename(order_79 = order)) %>%
  arrange(ur_factor, order_ad, order_79) %>%
  select(-c(ur_factor, starts_with("order")))
```

```{r}
table4.2 <- scales_study2 %>%
  mutate_at(vars(-capacity),
            funs(ifelse(is.na(.), "", "✓"))) %>%
  rename(Capacity = capacity) %>%
  kable(format = "html",
        caption = "Table 4.2: Scales for each of the conceptual units (factors) identified by EFA for US Adults and children in Study 2 (see Chapter III). A checkmark indicates that a mental capacity was included in a scale for a particular sample.") %>%
  kable_styling() %>%
  group_rows("BODY scale", 1, 7) %>%
  group_rows("HEART scale", 8, 14) %>%
  group_rows("MIND scale", 15, 23)
```

```{r table4.2, include = T}
table4.2
```

```{r}
figure4.3 <- plot_grid(fig_d2_ad_plots_leg_title, 
                       fig_d2_79_scored_ad_plots_leg_title,
                       fig_d2_all_scored_ad_plots_leg_title,
                       ncol = 1)

figure4.3_cap <- add_sub(figure4.3, str_wrap("Figure 4.3: Relationships among US adults', older children's, and younger children's attributions of conceptual units in Study 2, scored using adults' BODY, HEART, and MIND scales (see Table 4.2). Plots are organized by sample (rows) and by pair of conceptual units (columns). (A) Adults. (B) Children (7-9y of age), scored using adults' scales. (C) A visualization of development between 7-9y and adulthood, using mean scores by character and age group. For each conceptual unit, scores could range from 0-1. In panels A-B, individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.4}
ggdraw(figure4.3_cap)
```

```{r}
figure4.4 <- plot_grid(fig_d2_79_scored_79_plots_leg_title, 
                       ncol = 1)

figure4.4_cap <- add_sub(figure4.4, str_wrap("Figure 4.4: Relationships among children's attributions of conceptual units in Study 2, scored using their own scales (see Table 4.2). Plots are organized by pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 0.5}
ggdraw(figure4.4_cap)
```

```{r}
figure4.5_plots <- plot_grid(
  plot_d2_ad_scored_ad_diff +
    labs(title = "Study 2: Adults") +
    theme(legend.position = "bottom"),
  plot_d2_79_scored_ad_diff +
    labs(title = "Study 2: Children, 7-9y (scored using adults' scales)") +
    theme(legend.position = "bottom"),
  plot_d2_79_scored_79_diff + 
    labs(title = "Study 2: Children, 4-6y (scored using their own scales)") +
    theme(legend.position = "bottom"), 
  ncol = 3, rel_widths = c(1, 1, 1),
  labels = "AUTO")

figure4.5_cap <- add_sub(figure4.5_plots, str_wrap("Figure 4.5: Difference scores between US adults' and children's attributions of conceptual units in Study 2. this includes difference scores using adults' BODY, HEART, and MIND scales (panel B) and difference scores using children's own scales (panel C; see Table 4.2). For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 180), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 8, fig.asp = 0.38}
ggdraw(figure4.5_cap)
```

# Study 3: Conceptual change over early and middle childhood (4-9y)

In Study 3, `r nrow(d3_ad_wide)` US adults, `r nrow(d3_79_wide)` "older" children (`r summary(d3_79$age)["Min."] %>% round(2)`-`r summary(d3_79$age)["Max."] %>% round(2)` years; median: `r summary(d3_79$age)["Median"] %>% round(2)`y), and `r nrow(d3_46_wide)` "younger" children (`r summary(d3_46$age)["Min."] %>% round(2)`-`r summary(d3_46$age)["Max."] %>% round(2)` years; median: `r summary(d3_46$age)["Median"] %>% round(2)`y) each assessed a single target character on 20 mental capacities. To make the study appropriate for children in this age range, participants assessed a subset of the 40 mental capacities employed in Study 2, chosen to represent the three "conceptual units" revealed by Studies 1-2 (BODY, HEART, and MIND) and to cover a similar range of mental capacities as Studies 1-2. As in Study 2, participants responded on a 3-point scale ("no," coded as 0; "kinda," coded as 0.5, "yes," coded as 1). This study employed the "diverse characters" variant of the general approach, with participants randomly or pseudo-randomly assigned to assess either one of the following 9 characters: an elephant, a goat, a mouse, a bird, a beetle, a teddy bear, a doll, a robot, or a computer. (See Chapter II for detailed methods.)

## Special notes on data processing and analysis

## Results

### Adults

#### Scale construction

```{r}
scales_efa_wdm_d3_ad <- scale_fun(efa_wdm_d3_ad,
                                  factor_names = factor_names_efa_wdm_d3_ad)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d3_ad)` scales of `r scales_efa_wdm_d3_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.3.

```{r}
d3_ad_scored_ad <- score_fun(d3_ad, scales_efa_wdm_d3_ad)
```

#### Visualization

XX

```{r}
plots_d3_ad_scored_ad <- relviz_fun(d3_ad_scored_ad, colors = colors09)
```

```{r}
fig_d3_ad_plots <- plot_grid(plots_d3_ad_scored_ad[[1]] + 
                               theme(legend.position = "none"),
                             plots_d3_ad_scored_ad[[2]] + 
                               theme(legend.position = "none"),
                             plots_d3_ad_scored_ad[[3]] + 
                               theme(legend.position = "none"),
                             labels = c("A1", "A2", "A3"), ncol = 3)

fig_d3_ad_leg <- get_legend(
  plots_d3_ad_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", 
                      values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character",
                       values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_ad_plots_leg <- plot_grid(fig_d3_ad_plots, fig_d3_ad_leg,
                                 ncol = 1, rel_heights = c(1, 0.05))

fig_d3_ad_title <- ggdraw() + 
  draw_label("Study 3: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_ad_plots_leg_title <- plot_grid(fig_d3_ad_title, fig_d3_ad_plots_leg,
                                       ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

XX

```{r}
d3_ad_scored_ad_diff <- diff_fun(d3_ad_scored_ad)
```

```{r}
plot_d3_ad_scored_ad_diff <- diffplot_fun(d3_ad_scored_ad_diff, colors09)
```

```{r}
# r_d3_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_ad_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_ad_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d3_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d3_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_ad_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_ad_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d3_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d3_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_ad_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d3_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_ad_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d3_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d3_ad_scored_ad_diff_HEART_MIND)
```

### Children (7-9y)

#### Scale construction

```{r}
scales_efa_wdm_d3_79 <- scale_fun(efa_wdm_d3_79,
                                  factor_names = factor_names_efa_wdm_d3_79)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d3_79)` scales of `r scales_efa_wdm_d3_79 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.3.

```{r}
d3_79_scored_ad <- score_fun(d3_79, scales_efa_wdm_d3_ad)
d3_79_scored_79 <- score_fun(d3_79, scales_efa_wdm_d3_79)
```

#### Visualization

##### Using adults' scales

XX

```{r}
plots_d3_79_scored_ad <- relviz_fun(d3_79_scored_ad, colors = colors09)
```

```{r}
fig_d3_79_scored_ad_plots <- plot_grid(plots_d3_79_scored_ad[[1]] + 
                                         theme(legend.position = "none"),
                                       plots_d3_79_scored_ad[[2]] + 
                                         theme(legend.position = "none"),
                                       plots_d3_79_scored_ad[[3]] + 
                                         theme(legend.position = "none"),
                                       labels = c("B1", "B2", "B3"), ncol = 3)

fig_d3_79_scored_ad_leg <- get_legend(
  plots_d3_79_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", 
                      values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character",
                       values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_79_scored_ad_plots_leg <- plot_grid(
  fig_d3_79_scored_ad_plots, fig_d3_79_scored_ad_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d3_79_scored_ad_title <- ggdraw() + 
  draw_label("Study 3: Children, 7-9y (scored using adults' scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_79_scored_ad_plots_leg_title <- plot_grid(
  fig_d3_79_scored_ad_title, fig_d3_79_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

##### Using children's own scales

XX

```{r}
plots_d3_79_scored_79 <- relviz_fun(d3_79_scored_79, colors = colors09)
```

```{r}
fig_d3_79_scored_79_plots <- plot_grid(plots_d3_79_scored_79[[1]] + 
                                         theme(legend.position = "none"),
                                       plots_d3_79_scored_79[[2]] + 
                                         theme(legend.position = "none"),
                                       plots_d3_79_scored_79[[3]] + 
                                         theme(legend.position = "none"),
                                       labels = c("A1", "A2", "A3"), ncol = 3)

fig_d3_79_scored_79_leg <- get_legend(
  plots_d3_79_scored_79[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character", values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_79_scored_79_plots_leg <- plot_grid(
  fig_d3_79_scored_79_plots, fig_d3_79_scored_79_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d3_79_scored_79_title <- ggdraw() + 
  draw_label("Study 3: Children, 7-9y (scored using their own scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_79_scored_79_plots_leg_title <- plot_grid(
  fig_d3_79_scored_79_title, fig_d3_79_scored_79_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

##### Using adults' scales

XX

```{r}
d3_79_scored_ad_diff <- diff_fun(d3_79_scored_ad)
```

```{r}
plot_d3_79_scored_ad_diff <- diffplot_fun(d3_79_scored_ad_diff, colors09)
```

```{r}
# r_d3_79_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_79_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_79_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d3_79_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_79_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d3_79_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d3_79_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d3_79_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_79_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_79_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d3_79_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_79_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d3_79_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d3_79_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d3_79_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_79_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_79_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d3_79_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_79_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d3_79_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d3_79_scored_ad_diff_HEART_MIND)
```

##### Using children's own scales

XX

```{r}
d3_79_scored_79_diff <- diff_fun(d3_79_scored_79)
```

```{r}
plot_d3_79_scored_79_diff <- diffplot_fun(d3_79_scored_79_diff, colors09)
```

```{r}
# r_d3_79_scored_79_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_79_scored_79_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_79_scored_79_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d3_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_79_scored_79_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - HEART"))

summary(r_d3_79_scored_79_diff_BODY_HEART)
```

```{r}
# r_d3_79_scored_79_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_79_scored_79_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_79_scored_79_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d3_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_79_scored_79_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d3_79_scored_79_diff %>% filter(pair == "BODY - MIND"))

summary(r_d3_79_scored_79_diff_BODY_MIND)
```

```{r}
# r_d3_79_scored_79_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_79_scored_79_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_79_scored_79_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d3_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_79_scored_79_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d3_79_scored_79_diff %>% filter(pair == "HEART - MIND"))

summary(r_d3_79_scored_79_diff_HEART_MIND)
```

### Children (4-6y)

#### Scale construction

##### Three-factor solution

```{r}
scales_efa_wdm_d3_46 <- scale_fun(efa_wdm_d3_46,
                                  factor_names = factor_names_efa_wdm_d3_46)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d3_46)` scales of `r scales_efa_wdm_d3_46 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.3.

##### Two-factor solution

```{r}
scales_efa_par_d3_46 <- scale_fun(efa_par_d3_46,
                                  factor_names = factor_names_efa_par_d3_46)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_par_d3_46)` scales of `r scales_efa_par_d3_46 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.3.

```{r}
d3_46_scored_ad <- score_fun(d3_46, scales_efa_wdm_d3_ad)
d3_46_scored_46_wdm <- score_fun(d3_46, scales_efa_wdm_d3_46)
d3_46_scored_46_par <- score_fun(d3_46, scales_efa_par_d3_46)
```

#### Visualization

##### Using adults' scales

XX

```{r}
plots_d3_46_scored_ad <- relviz_fun(d3_46_scored_ad, colors = colors09)
```

```{r}
fig_d3_46_scored_ad_plots <- plot_grid(plots_d3_46_scored_ad[[1]] + 
                                         theme(legend.position = "none"),
                                       plots_d3_46_scored_ad[[2]] + 
                                         theme(legend.position = "none"),
                                       plots_d3_46_scored_ad[[3]] + 
                                         theme(legend.position = "none"),
                                       labels = c("C1", "C2", "C3"), ncol = 3)

fig_d3_46_scored_ad_leg <- get_legend(
  plots_d3_46_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character", values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_46_scored_ad_plots_leg <- plot_grid(
  fig_d3_46_scored_ad_plots, fig_d3_46_scored_ad_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d3_46_scored_ad_title <- ggdraw() + 
  draw_label("Study 3: Children, 4-6y (scored using adults' scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_46_scored_ad_plots_leg_title <- plot_grid(
  fig_d3_46_scored_ad_title, fig_d3_46_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

##### Using children's own scales (three-factor solution)

XX

```{r}
plots_d3_46_scored_46_wdm <- relviz_fun(d3_46_scored_46_wdm, colors = colors09)
```

```{r}
fig_d3_46_scored_46_wdm_plots <- plot_grid(plots_d3_46_scored_46_wdm[[1]] + 
                                             theme(legend.position = "none"),
                                           plots_d3_46_scored_46_wdm[[2]] + 
                                             theme(legend.position = "none"),
                                           plots_d3_46_scored_46_wdm[[3]] + 
                                             theme(legend.position = "none"),
                                           labels = c("B1", "B2", "B3"),
                                           ncol = 3)

fig_d3_46_scored_46_wdm_leg <- get_legend(
  plots_d3_46_scored_46_wdm[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character", values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_46_scored_46_wdm_plots_leg <- plot_grid(
  fig_d3_46_scored_46_wdm_plots, fig_d3_46_scored_46_wdm_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d3_46_scored_46_wdm_title <- ggdraw() + 
  draw_label("Study 3: Children, 4-6y (scored using their own scales, 3-factor solution)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_46_scored_46_wdm_plots_leg_title <- plot_grid(
  fig_d3_46_scored_46_wdm_title, fig_d3_46_scored_46_wdm_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

##### Using children's own scales (three-factor solution)

XX

```{r}
plots_d3_46_scored_46_par <- relviz_fun(d3_46_scored_46_par, colors = colors09)
```

```{r}
fig_d3_46_scored_46_par_plots <- plot_grid(plots_d3_46_scored_46_par[[1]] + 
                                             theme(legend.position = "none"),
                                           labels = c("C1"), ncol = 3)

fig_d3_46_scored_46_par_leg <- get_legend(
  plots_d3_46_scored_46_par[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character", values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_46_scored_46_par_plots_leg <- plot_grid(
  fig_d3_46_scored_46_par_plots, fig_d3_46_scored_46_par_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d3_46_scored_46_par_title <- ggdraw() + 
  draw_label("Study 3: Children, 4-6y (scored using their own scales, 2-factor solution)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_46_scored_46_par_plots_leg_title <- plot_grid(
  fig_d3_46_scored_46_par_title, fig_d3_46_scored_46_par_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

##### Using adults' scales

XX

```{r}
d3_46_scored_ad_diff <- diff_fun(d3_46_scored_ad)
```

```{r}
plot_d3_46_scored_ad_diff <- diffplot_fun(d3_46_scored_ad_diff, colors09)
```

```{r}
# r_d3_46_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d3_46_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d3_46_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d3_46_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d3_46_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d3_46_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d3_46_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d3_46_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d3_46_scored_ad_diff_HEART_MIND)
```

###### Developmental comparison

```{r}
# r_d3_ad7946_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09,
#                    age_group = contrasts_dum3_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_ad7946_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09,
#                    age_group = contrasts_dum3_agegp))

r_d3_ad7946_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character * age_group,
  data = d3_ad_scored_ad_diff %>% 
    full_join(d3_79_scored_ad_diff) %>%
    full_join(d3_46_scored_ad_diff) %>%
    filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_dv09,
                   age_group = contrasts_dum3_agegp))

# r_d3_ad7946_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1 + age_group,
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(age_group = contrasts_dum3_agegp))

summary(r_d3_ad7946_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d3_ad7946_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09,
#                    age_group = contrasts_dum3_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_ad7946_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09,
#                    age_group = contrasts_dum3_agegp))

r_d3_ad7946_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character * age_group,
  data = d3_ad_scored_ad_diff %>% 
    full_join(d3_79_scored_ad_diff) %>%
    full_join(d3_46_scored_ad_diff) %>%
    filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_dv09,
                   age_group = contrasts_dum3_agegp))

# r_d3_ad7946_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1 + age_group,
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(age_group = contrasts_dum3_agegp))

summary(r_d3_ad7946_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d3_ad7946_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09,
#                    age_group = contrasts_dum3_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_ad7946_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09,
#                    age_group = contrasts_dum3_agegp))

r_d3_ad7946_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character * age_group,
  data = d3_ad_scored_ad_diff %>% 
    full_join(d3_79_scored_ad_diff) %>%
    full_join(d3_46_scored_ad_diff) %>%
    filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv09,
                   age_group = contrasts_dum3_agegp))

# r_d3_ad7946_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1 + age_group,
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(age_group = contrasts_dum3_agegp))

summary(r_d3_ad7946_scored_ad_diff_HEART_MIND)
```

##### Using children's own scales (three-factor solution)

XX

```{r}
d3_46_scored_46_wdm_diff <- diff_fun(d3_46_scored_46_wdm)
```

```{r}
plot_d3_46_scored_46_wdm_diff <- diffplot_fun(d3_46_scored_46_wdm_diff, colors09)
```

```{r}
# r_d3_46_scored_46_wdm_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - HEART*"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_46_wdm_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - HEART*"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_46_wdm_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - HEART*"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_46_wdm_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - HEART*"))

summary(r_d3_46_scored_46_wdm_diff_BODY_HEART)
```

```{r}
# r_d3_46_scored_46_wdm_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_46_wdm_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_46_wdm_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_46_wdm_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "BODY* - MIND"))

summary(r_d3_46_scored_46_wdm_diff_BODY_MIND)
```

```{r}
# r_d3_46_scored_46_wdm_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_46_wdm_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_46_wdm_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_46_wdm_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d3_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND"))

summary(r_d3_46_scored_46_wdm_diff_HEART_MIND)
```

##### Using children's own scales (two-factor solution)

XX

```{r}
d3_46_scored_46_par_diff <- diff_fun(d3_46_scored_46_par)
```

```{r}
plot_d3_46_scored_46_par_diff <- diffplot_fun(d3_46_scored_46_par_diff, colors09)
```

```{r}
# r_d3_46_scored_46_par_diff_BODYHEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_par_diff %>% filter(pair == "BODY-HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_46_par_diff_BODYHEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_46_par_diff %>% filter(pair == "BODY-HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_46_par_diff_BODYHEART_MIND <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_46_par_diff %>% filter(pair == "BODY-HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_46_par_diff_BODYHEART_MIND <- lm(
#   diff ~ 1,
#   data = d3_46_scored_46_par_diff %>% filter(pair == "BODY-HEART - MIND"))

summary(r_d3_46_scored_46_par_diff_BODYHEART_MIND)
```

## Discussion

XX

```{r}
scales_study3 <- bind_rows(scales_efa_wdm_d3_ad %>% 
                             mutate(study = "Adults"),
                           scales_efa_wdm_d3_79 %>% 
                             mutate(study = "Older children, 7-9y"),
                           scales_efa_wdm_d3_46 %>%
                             mutate(study = "Younger children, 4-6y (3-factor solution)"),
                           scales_efa_par_d3_46 %>%
                             mutate(study = "Younger children, 4-6y (2-factor solution)")) %>%
  select(-c(loading, order)) %>%
  distinct() %>%
  mutate(study = factor(study,
                        levels = c("Adults",
                                   "Older children, 7-9y",
                                   "Younger children, 4-6y (3-factor solution)",
                                   "Younger children, 4-6y (2-factor solution)"))) %>%
  spread(study, factor) %>%
  mutate(ur_factor = ifelse(!is.na(`Adults`), 
                            `Adults`, 
                            ifelse(!is.na(`Older children, 7-9y`), 
                                   `Older children, 7-9y`,
                                   ifelse(is.na(`Younger children, 4-6y (3-factor solution)`), 
                                          `Younger children, 4-6y (3-factor solution)`,
                                          `Younger children, 4-6y (2-factor solution)`)))) %>%
  left_join(scales_efa_wdm_d3_ad %>% 
              select(capacity, order) %>% rename(order_ad = order)) %>%
  left_join(scales_efa_wdm_d3_79 %>% 
              select(capacity, order) %>% rename(order_79 = order)) %>%
  arrange(ur_factor, order_ad, order_79) %>%
  select(-c(ur_factor, starts_with("order")))
```

```{r}
table4.3 <- scales_study3 %>%
  mutate_all(as.character) %>%
  # deal with younger children, 2-factor solution
  mutate(temp1 = `Younger children, 4-6y (2-factor solution)`,
         temp2 = gsub("\\*", "", temp1),
         temp3 = case_when(
           temp2 == `Adults` | 
             temp2 == `Older children, 7-9y` ~ "✓",
           is.na(temp2) ~ "",
           TRUE ~ temp1)) %>%
  mutate(`Younger children, 4-6y (2-factor solution)` = temp3) %>%
  select(-starts_with("temp")) %>%
  # deal with younger children, 3-factor solution
  mutate(temp1 = `Younger children, 4-6y (3-factor solution)`,
         temp2 = gsub("\\*", "", temp1),
         temp3 = case_when(
           temp2 == `Adults` | 
             temp2 == `Older children, 7-9y` |
             (is.na(`Adults`) & is.na(`Older children, 7-9y`)) ~ "✓",
           is.na(temp2) ~ "",
           TRUE ~ temp1)) %>%
  mutate(`Younger children, 4-6y (3-factor solution)` = temp3) %>%
  select(-starts_with("temp")) %>%
  mutate_at(vars(`Adults`, `Older children, 7-9y`),
            funs(ifelse(is.na(.), "", "✓"))) %>%
  mutate_at(vars(starts_with("Younger")),
            funs(ifelse(is.na(.), "", .))) %>%
  rename(Capacity = capacity,
         `3-factor solution` = `Younger children, 4-6y (3-factor solution)`,
         `2-factor solution` = `Younger children, 4-6y (2-factor solution)`) %>%
  kable(format = "html",
        caption = "Table 4.3: Scales for each of the conceptual units (factors) identified by EFA for US Adults, older children, and younger children in Study 3 (see Chapter III). For younger children, this includes scales for both three- and two-factor EFA solutions. A checkmark indicates that a mental capacity was included in a scale for a particular sample. The conceptual units of younger children differed substantially from those of older children and adults, such that some mental capacities were included in different scales across age groups (e.g., feel scared was part of the BODY scale for older children and adults, but part of the HEART* scale for younger children). In these cases, the name of the scale is provided (rather than a checkmark).") %>%
  kable_styling() %>%
  group_rows("BODY scale", 1, 7) %>%
  group_rows("HEART scale", 8, 14) %>%
  group_rows("MIND scale", 15, 20) %>%
  add_header_above(c(" " = 3,
                     "Younger children, 4-6y" = 2))
```

```{r table4.3, include = T}
table4.3
```

```{r}
plots_agegp_d3_scored_ad <- relviz_agegp_fun(
  d_scored = d3_ad_scored_ad %>% 
    full_join(d3_79_scored_ad) %>% 
    full_join(d3_46_scored_ad), 
  age_groups = c("children46", "children79", "adults"),
  age_group_labels = c("Children, (4-6y)", "Children (7-9y)", "Adults"),
  colors = colors09)
```

```{r}
fig_d3_all_scored_ad_plots <- plot_grid(plots_agegp_d3_scored_ad[[1]] + 
                                          theme(legend.position = "none"),
                                        plots_agegp_d3_scored_ad[[2]] + 
                                          theme(legend.position = "none"),
                                        plots_agegp_d3_scored_ad[[3]] + 
                                          theme(legend.position = "none"),
                                        labels = c("D1", "D2", "D3"), ncol = 3)

fig_d3_all_scored_ad_leg <- get_legend(
  plots_agegp_d3_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_color_manual("Target character", values = colors09,
                       na.translate = F,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_all_scored_ad_plots_leg <- plot_grid(
  fig_d3_all_scored_ad_plots, fig_d3_all_scored_ad_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d3_all_scored_ad_title <- ggdraw() + 
  draw_label("Tracking development between 4-9y and adulthood (scored using adults' scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_all_scored_ad_plots_leg_title <- plot_grid(
  fig_d3_all_scored_ad_title, fig_d3_all_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r}
figure4.8 <- plot_grid(fig_d3_ad_plots_leg_title, 
                       fig_d3_79_scored_ad_plots_leg_title,
                       fig_d3_46_scored_ad_plots_leg_title, 
                       fig_d3_all_scored_ad_plots_leg_title,
                       ncol = 1)

figure4.8_cap <- add_sub(figure4.8, str_wrap("Figure 4.8: Relationships among US adults', older children's, and younger children's attributions of conceptual units in Study 3, scored using adults' BODY, HEART, and MIND scales (see Table 4.3). (A) Adults. (B) Older children (7-9y of age). (C) Younger children (4-6y of age). (D) A visualization of development between 4-9y and adulthood, using mean scores by character and age group. Plots are organized by sample (rows) and by pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. In panels A-C, individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.8}
ggdraw(figure4.8_cap)
```

```{r}
figure4.9 <- plot_grid(fig_d3_79_scored_79_plots_leg_title, 
                       fig_d3_46_scored_46_wdm_plots_leg_title,
                       fig_d3_46_scored_46_par_plots_leg_title,
                       ncol = 1)

figure4.9_cap <- add_sub(figure4.9, str_wrap("Figure 4.9: Relationships among older and younger children's attributions of conceptual units in Study 3, scored using their own scales (see Table 4.3). For younger children (4-6y of age), two sets of scores are presented: using a three-factor EFA solution (B1-B3) and using a two-factor EFA solution (C1-C3). Plots are organized by sample and scale used (rows) and by pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.4}
ggdraw(figure4.9_cap)
```

```{r}
figure4.10_plots <- plot_grid(
  plot_d3_ad_scored_ad_diff +
    labs(title = "Study 3: Adults") +
    theme(legend.position = "none"),
  plot_d3_79_scored_ad_diff +
    labs(title = "Study 3: Children, 7-9y (scored using adults' scales)") +
    theme(legend.position = "none"),
  plot_d3_46_scored_ad_diff + 
    labs(title = "Study 3: Children, 4-6y (scored using adults' scales)") +
    theme(legend.position = "none"), 
  ncol = 3, rel_widths = c(1, 1, 1),
  labels = "AUTO")

figure4.10_plots_leg <- plot_grid(figure4.10_plots,
                                  get_legend(plot_d3_ad_scored_ad_diff),
                                  ncol = 1, rel_heights = c(1, 0.1))

figure4.10_cap <- add_sub(figure4.10_plots_leg, str_wrap("Figure 4.10: Difference scores between US adults' and children's attributions of conceptual units in Study 3. this includes difference scores using adults' BODY, HEART, and MIND scales (panel B) and difference scores using children's own scales (panel C; see Table 4.3). For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 180), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 8, fig.asp = 0.38}
ggdraw(figure4.10_cap)
```

```{r}
figure4.11_plots <- plot_grid(
  plot_d3_79_scored_79_diff +
    labs(title = "Study 3: Children, 7-9y\n(scored using their own scales)") +
    theme(legend.position = "none"),
  plot_d3_46_scored_46_wdm_diff + 
    labs(title = "Study 3: Children, 4-6y\n(scored using their own scales, 3-factor solution)") +
    theme(legend.position = "none"), 
  plot_d3_46_scored_46_par_diff + 
    labs(title = "Study 3: Children, 4-6y\n(scored using their own scales, 2-factor solution)") +
    theme(legend.position = "none"), 
  ncol = 3, rel_widths = c(1, 1, 0.8),
  labels = "AUTO")

figure4.11_plots_leg <- plot_grid(figure4.11_plots,
                                  get_legend(plot_d3_79_scored_79_diff),
                                  ncol = 1, rel_heights = c(1, 0.1))

figure4.11_cap <- add_sub(figure4.11_plots_leg, str_wrap("Figure 4.11: Difference scores between 7- to 9-year-old children's and 4- to 6-year-old children's attributions of conceptual units in Study 3, using their own scales. For younger children (4-6y of age), this includes difference scores using the three-factor EFA solution (panel B) and difference scores using the two-factor solution (panel C; see Table 4.3). For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 180), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 8, fig.asp = 0.38}
ggdraw(figure4.11_cap)
```


# Study 4: A focus on early childhood (4-5y)

In Study 4, `r nrow(d4_ad_wide)/2` US adults and `r nrow(d4_46_wide)/2` US children between the ages of `r summary(d4_46$age)["Min."] %>% round(2)`-`r summary(d4_46$age)["Max."] %>% round(2)` years (median: `r summary(d4_46$age)["Median"] %>% round(2)`y) each assessed two target characters on 18 mental capacities. To make the study appropriate for children in this age range, this study employed a new set of 18 mental capacities (some but not all of which were used in Studies 1-3). In addition, participants were presented with a more child-friendly visual representation of the 3-point response scale ("no," coded as 0; "kinda," coded as 0.5, "yes," coded as 1). This study employed the "edge case" variant of the general approach, with participants assessing both a beetle or a robot in sequence (with order counterbalanced across participants). (See Chapter II for detailed methods.)

## Special notes on data processing and analysis

## Results

### Adults

#### Scale construction

```{r}
scales_efa_wdm_d4_ad <- scale_fun(efa_wdm_d4_ad,
                                  factor_names = factor_names_efa_wdm_d4_ad)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d4_ad)` scales of `r scales_efa_wdm_d4_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.4.

```{r}
d4_ad_scored_ad <- score_fun(d4_ad, scales_efa_wdm_d4_ad)
```

#### Visualization

XX

```{r}
plots_d4_ad_scored_ad <- relviz_fun(d4_ad_scored_ad, colors = colors02)
```

```{r}
fig_d4_ad_plots <- plot_grid(plots_d4_ad_scored_ad[[1]] + 
                               theme(legend.position = "none"),
                             plots_d4_ad_scored_ad[[2]] + 
                               theme(legend.position = "none"),
                             plots_d4_ad_scored_ad[[3]] + 
                               theme(legend.position = "none"),
                             labels = c("A1", "A2", "A3"), ncol = 3)

fig_d4_ad_leg <- get_legend(
  plots_d4_ad_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d4_ad_plots_leg <- plot_grid(fig_d4_ad_plots, fig_d4_ad_leg,
                                 ncol = 1, rel_heights = c(1, 0.05))

fig_d4_ad_title <- ggdraw() + 
  draw_label("Study 4: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d4_ad_plots_leg_title <- plot_grid(fig_d4_ad_title, fig_d4_ad_plots_leg,
                                       ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

XX

```{r}
d4_ad_scored_ad_diff <- diff_fun(d4_ad_scored_ad)
```

```{r}
plot_d4_ad_scored_ad_diff <- diffplot_fun(d4_ad_scored_ad_diff, colors02)
```

```{r}
# r_d4_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_ad_scored_ad_diff_BODY_HEART <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d4_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d4_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_ad_scored_ad_diff_BODY_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d4_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d4_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_ad_scored_ad_diff_HEART_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d4_ad_scored_ad_diff_HEART_MIND)
```

### Children (4-5y)

#### Scale construction

##### Three-factor solution

```{r}
scales_efa_par_d4_46 <- scale_fun(efa_par_d4_46,
                                  factor_names = factor_names_efa_par_d4_46)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_par_d4_46)` scales of `r scales_efa_par_d4_46 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.4.

##### Four-factor solution

```{r}
scales_efa_wdm_d4_46 <- scale_fun(efa_wdm_d4_46,
                                  factor_names = factor_names_efa_wdm_d4_46)
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d4_46)` scales of `r scales_efa_wdm_d4_46 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.4.

```{r}
d4_46_scored_ad <- score_fun(d4_46, scales_efa_wdm_d4_ad)
d4_46_scored_46_par <- score_fun(d4_46, scales_efa_par_d4_46)
d4_46_scored_46_wdm <- score_fun(d4_46, scales_efa_wdm_d4_46)
```

#### Visualization

##### Using adults' scales

XX

```{r}
plots_d4_46_scored_ad <- relviz_fun(d4_46_scored_ad, colors = colors02)
```

```{r}
fig_d4_46_scored_ad_plots <- plot_grid(plots_d4_46_scored_ad[[1]] + 
                                         theme(legend.position = "none"),
                                       plots_d4_46_scored_ad[[2]] + 
                                         theme(legend.position = "none"),
                                       plots_d4_46_scored_ad[[3]] + 
                                         theme(legend.position = "none"),
                                       labels = c("B1", "B2", "B3"), ncol = 3)

fig_d4_46_scored_ad_leg <- get_legend(
  plots_d4_46_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d4_46_scored_ad_plots_leg <- plot_grid(fig_d4_46_scored_ad_plots,
                                           fig_d4_46_scored_ad_leg,
                                           ncol = 1, rel_heights = c(1, 0.05))

fig_d4_46_scored_ad_title <- ggdraw() + 
  draw_label("Study 4: Children, 4-5y (scored using adults' scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d4_46_scored_ad_plots_leg_title <- plot_grid(
  fig_d4_46_scored_ad_title, fig_d4_46_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

##### Using children's own scales (three-factor solution)

XX

```{r}
plots_d4_46_scored_46_par <- relviz_fun(d4_46_scored_46_par, colors = colors02)
```

```{r}
fig_d4_46_scored_46_par_plots <- plot_grid(plots_d4_46_scored_46_par[[1]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_par[[2]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_par[[3]] + 
                                             theme(legend.position = "none"),
                                           labels = c("A1", "A2", "A3"), ncol = 3)

fig_d4_46_scored_46_par_leg <- get_legend(
  plots_d4_46_scored_46_par[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal", 
                                            ncol = 2)))

fig_d4_46_scored_46_par_plots_leg <- plot_grid(
  fig_d4_46_scored_46_par_plots, fig_d4_46_scored_46_par_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d4_46_scored_46_par_title <- ggdraw() + 
  draw_label("Study 4: Children, 4-5y (scored using their own scales, 3-factor solution)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d4_46_scored_46_par_plots_leg_title <- plot_grid(
  fig_d4_46_scored_46_par_title, fig_d4_46_scored_46_par_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

##### Using children's own scales (four-factor solution)

XX

```{r}
plots_d4_46_scored_46_wdm <- relviz_fun(d4_46_scored_46_wdm, colors = colors02)
```

```{r}
fig_d4_46_scored_46_wdm_plots <- plot_grid(plots_d4_46_scored_46_wdm[[1]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_wdm[[2]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_wdm[[3]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_wdm[[4]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_wdm[[5]] + 
                                             theme(legend.position = "none"),
                                           plots_d4_46_scored_46_wdm[[6]] + 
                                             theme(legend.position = "none"),
                                           labels = c("B1", "B2", "B3", 
                                                      "B4", "B5", "B6"), 
                                           ncol = 3)

fig_d4_46_scored_46_wdm_leg <- get_legend(
  plots_d4_46_scored_46_wdm[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character",
                       values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d4_46_scored_46_wdm_plots_leg <- plot_grid(fig_d4_46_scored_46_wdm_plots,
                                               fig_d4_46_scored_46_wdm_leg,
                                               ncol = 1, rel_heights = c(1, 0.05))

fig_d4_46_scored_46_wdm_title <- ggdraw() + 
  draw_label("Study 4: Children, 4-5y (scored using their own scales, 4-factor solution)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d4_46_scored_46_wdm_plots_leg_title <- plot_grid(
  fig_d4_46_scored_46_wdm_title, fig_d4_46_scored_46_wdm_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

##### Using adults' scales

```{r}
d4_46_scored_ad_diff <- diff_fun(d4_46_scored_ad)
```

```{r}
plot_d4_46_scored_ad_diff <- diffplot_fun(d4_46_scored_ad_diff, colors02)
```

```{r}
# r_d4_46_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_ad_diff_BODY_HEART <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d4_46_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d4_46_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_ad_diff_BODY_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d4_46_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d4_46_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_ad_diff_HEART_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d4_46_scored_ad_diff_HEART_MIND)
```

XX

##### Using children's own scales (three-factor solution)

```{r}
d4_46_scored_46_par_diff <- diff_fun(d4_46_scored_46_par)
```

```{r}
plot_d4_46_scored_46_par_diff <- diffplot_fun(d4_46_scored_46_par_diff, colors02)
```

```{r}
# r_d4_46_scored_46_par_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_par_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_par_diff_BODY_HEART <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_par_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - HEART"))

summary(r_d4_46_scored_46_par_diff_BODY_HEART)
```

```{r}
# r_d4_46_scored_46_par_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_par_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_par_diff_BODY_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_par_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "BODY - MIND"))

summary(r_d4_46_scored_46_par_diff_BODY_MIND)
```

```{r}
# r_d4_46_scored_46_par_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_par_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_par_diff_HEART_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_par_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_par_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_par_diff %>% filter(pair == "HEART - MIND"))

summary(r_d4_46_scored_46_par_diff_HEART_MIND)
```

XX

##### Using children's own scales (four-factor solution)

```{r}
d4_46_scored_46_wdm_diff <- diff_fun(d4_46_scored_46_wdm)
```

```{r}
plot_d4_46_scored_46_wdm_diff <- diffplot_fun(d4_46_scored_46_wdm_diff, colors02)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - BODY (other)"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - BODY (other)"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - BODY (other)"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - BODY (other)"))

summary(r_d4_46_scored_46_wdm_diff_BODYnausea_BODYother)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYnausea_HEART <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - HEART*"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_wdm_diff_BODYnausea_HEART <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - HEART*"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_wdm_diff_BODYnausea_HEART <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - HEART*"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_wdm_diff_BODYnausea_HEART <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - HEART*"))

summary(r_d4_46_scored_46_wdm_diff_BODYnausea_HEART)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYother_HEART <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - HEART*"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_wdm_diff_BODYother_HEART <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - HEART*"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_wdm_diff_BODYother_HEART <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - HEART*"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_wdm_diff_BODYother_HEART <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - HEART*"))

summary(r_d4_46_scored_46_wdm_diff_BODYother_HEART)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYnausea_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - MIND*"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_wdm_diff_BODYnausea_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - MIND*"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_wdm_diff_BODYnausea_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - MIND*"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_wdm_diff_BODYnausea_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (nausea) - MIND*"))

summary(r_d4_46_scored_46_wdm_diff_BODYnausea_MIND)
```

```{r}
# r_d4_46_scored_46_wdm_diff_BODYother_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - MIND*"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_wdm_diff_BODYother_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - MIND*"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_wdm_diff_BODYother_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - MIND*"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_wdm_diff_BODYother_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "BODY (other) - MIND*"))

summary(r_d4_46_scored_46_wdm_diff_BODYother_MIND)
```

```{r}
# r_d4_46_scored_46_wdm_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND*"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_46_wdm_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND*"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_46_wdm_diff_HEART_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND*"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_46_wdm_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_46_wdm_diff %>% filter(pair == "HEART* - MIND*"))

summary(r_d4_46_scored_46_wdm_diff_HEART_MIND)
```

XX

## Discussion

XX

```{r}
scales_study4 <- bind_rows(scales_efa_wdm_d4_ad %>% 
                             mutate(study = "Adults"),
                           scales_efa_par_d4_46 %>%
                             mutate(study = "Children, 4-5y (3-factor solution)"),
                           scales_efa_wdm_d4_46 %>%
                             mutate(study = "Children, 4-5y (4-factor solution)")) %>%
  select(-c(loading, order)) %>%
  distinct() %>%
  mutate(study = factor(study,
                        levels = c("Adults",
                                   "Children, 4-5y (3-factor solution)",
                                   "Children, 4-5y (4-factor solution)"))) %>%
  spread(study, factor) %>%
  mutate(ur_factor = ifelse(!is.na(`Adults`), 
                            `Adults`,
                            ifelse(is.na(`Children, 4-5y (3-factor solution)`),
                                   `Children, 4-5y (3-factor solution)`,
                                   `Children, 4-5y (4-factor solution)`))) %>%
  left_join(scales_efa_wdm_d4_ad %>% 
              select(capacity, order) %>% rename(order_ad = order)) %>%
  arrange(ur_factor, order_ad) %>%
  select(-c(ur_factor, starts_with("order")))
```

```{r}
table4.4 <- scales_study4 %>%
  mutate_all(as.character) %>%
  # deal with Children, 4-factor solution
  mutate(temp1 = `Children, 4-5y (4-factor solution)`,
         temp2 = gsub("\\*", "", temp1),
         temp3 = case_when(
           temp2 == `Adults` ~ "✓",
           is.na(temp2) ~ "",
           TRUE ~ temp1)) %>%
  mutate(`Children, 4-5y (4-factor solution)` = temp3) %>%
  select(-starts_with("temp")) %>%
  # deal with Children, 3-factor solution
  mutate(temp1 = `Children, 4-5y (3-factor solution)`,
         temp2 = gsub("\\*", "", temp1),
         temp3 = case_when(
           temp2 == `Adults` ~ "✓",
           is.na(temp2) ~ "",
           TRUE ~ temp1)) %>%
  mutate(`Children, 4-5y (3-factor solution)` = temp3) %>%
  select(-starts_with("temp")) %>%
  mutate_at(vars(`Adults`),
            funs(ifelse(is.na(.), "", "✓"))) %>%
  mutate_at(vars(starts_with("Younger")),
            funs(ifelse(is.na(.), "", .))) %>%
  rename(Capacity = capacity,
         `3-factor solution` = `Children, 4-5y (3-factor solution)`,
         `4-factor solution` = `Children, 4-5y (4-factor solution)`) %>%
  kable(format = "html",
        caption = "Table 4.4: Scales for each of the conceptual units (factors) identified by EFA for US Adults and children in Study 4 (see Chapter III). For children, this includes scales for both three- and four-factor EFA solutions. A checkmark indicates that a mental capacity was included in a scale for a particular sample. The conceptual units of younger children differed substantially from those of adults, such that some mental capacities were included in different scales across age groups (e.g., love someone was part of the HEART scale for adults, but part of the MIND* scale in the four-factor solution for younger children). In these cases, the name of the scale is provided (rather than a checkmark).") %>%
  kable_styling() %>%
  group_rows("BODY scale", 1, 5) %>%
  group_rows("HEART scale", 6, 10) %>%
  group_rows("MIND scale", 11, 15) %>%
  add_header_above(c(" " = 2,
                     "Children, 4-5y" = 2))
```

```{r table4.4, include = T}
table4.4
```

```{r}
plots_agegp_d4_scored_ad <- relviz_agegp_fun(
  d_scored = d4_ad_scored_ad %>% 
    full_join(d4_46_scored_ad), 
  age_groups = c("children46", "adults"),
  age_group_labels = c("Children, (4-5y)", "Adults"),
  colors = colors02)
```

```{r}
fig_d4_all_scored_ad_plots <- plot_grid(plots_agegp_d4_scored_ad[[1]] + 
                                          theme(legend.position = "none"),
                                        plots_agegp_d4_scored_ad[[2]] + 
                                          theme(legend.position = "none"),
                                        plots_agegp_d4_scored_ad[[3]] + 
                                          theme(legend.position = "none"),
                                        labels = c("D1", "D2", "d4"), ncol = 3)

fig_d4_all_scored_ad_leg <- get_legend(
  plots_agegp_d4_scored_ad[[1]] + 
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_color_manual("Target character", values = colors02, na.translate = F, 
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d4_all_scored_ad_plots_leg <- plot_grid(fig_d4_all_scored_ad_plots,
                                            fig_d4_all_scored_ad_leg,
                                            ncol = 1, rel_heights = c(1, 0.05))

fig_d4_all_scored_ad_title <- ggdraw() + 
  draw_label("Tracking development between 4-5y and adulthood (scored using adults' scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d4_all_scored_ad_plots_leg_title <- plot_grid(
  fig_d4_all_scored_ad_title, fig_d4_all_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r}
figure4.12 <- plot_grid(fig_d4_ad_plots_leg_title, 
                        fig_d4_46_scored_ad_plots_leg_title,
                        fig_d4_all_scored_ad_plots_leg_title,
                        ncol = 1)

figure4.12_cap <- add_sub(figure4.12, str_wrap("Figure 4.12: Relationships among US adults' and children's attributions of conceptual units in Study 4, scored using adults' BODY, HEART, and MIND scales (see Table 4.4). (A) Adults. (B) Children (4-5y of age). (C) A visualization of development between 4-5y and adulthood, using mean scores by character and age group. Plots are organized by sample (rows) and by pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. In panels A-B, individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.4}
ggdraw(figure4.12_cap)
```

```{r}
figure4.13 <- plot_grid(fig_d4_46_scored_46_par_plots_leg_title, 
                        fig_d4_46_scored_46_wdm_plots_leg_title,
                        ncol = 1, rel_heights = c(1, 2))

figure4.13_cap <- add_sub(figure4.13, str_wrap("Figure 4.13: Relationships among US adults', older children's, and younger children's attributions of conceptual units in Study 3, scored using their own scales scales (see Table 4.4). Ttwo sets of scores are presented: using a three-factor EFA solution (A1-A3) and using a four-factor EFA solution (B1-B6). Plots are organized by scale used (rows) and by pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.35}
ggdraw(figure4.13_cap)
```

```{r}
figure4.14_plots <- plot_grid(
  plot_d4_ad_scored_ad_diff +
    labs(title = "Study 4: Adults") +
    theme(legend.position = "bottom"),
  plot_d4_46_scored_ad_diff + 
    labs(title = "Study 4: Children, 4-6y (scored using adults' scales)") +
    theme(legend.position = "bottom"), 
  ncol = 2, rel_widths = c(1, 1),
  labels = "AUTO")

figure4.14_cap <- add_sub(figure4.14_plots, str_wrap("Figure 4.14: Difference scores between US adults' and children's attributions of conceptual units in Study 4. For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 180), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 8, fig.asp = 0.38}
ggdraw(figure4.14_cap)
```

```{r}
figure4.15_plots <- plot_grid(
  plot_d4_46_scored_46_par_diff + 
    labs(title = "Study 4: Children, 4-6y (scored using their own scales, 3-factor solution)") +
    theme(legend.position = "bottom"), 
  plot_d4_46_scored_46_wdm_diff + 
    labs(title = "Study 4: Children, 4-6y (scored using their own scales, 4-factor solution)") +
    theme(legend.position = "bottom"), 
  ncol = 2, rel_widths = c(1, 2),
  labels = "AUTO")

figure4.15_cap <- add_sub(figure4.15_plots, str_wrap("Figure 4.15: Difference scores between 4- to 5-year-old children's attributions of conceptual units in Study 4, using their own scales. This includes difference scores using the three-factor EFA solution (panel A) and difference scores using the four-factor solution (panel B; see Table 4.4). For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 180), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 8, fig.asp = 0.38}
ggdraw(figure4.15_cap)
```


# General discussion

XX


# Chapter conclusion

In this chapter, I explored a second aspect of conceptual representations of mental life among US children and adults: The relationships among conceptual units. Studies 2-4 are consistent with the following theory: XX. 

As in Chapter III, I urge the reader to remember that this is not the only possible interpretation of the pattern of results presented here; additional studies—in particular, studies designed to test the hypothesis that XX— could provide converging evidence or could challenge this theoretical interpretation. Instead, the primary role of the re-analysis discussed here has been to inspire the hypothesis stated in the previous paragraph and to the foundation for future tests of this hypothesis, in turn refining a general theory of this aspect of conceptual development.  

In the next chapter, I apply the same exploratory spirit to the third and final aspect of conceptual representations of mental life: the application or deployment of these conceptual units in reasoning about various kinds of beings.
