---
title: "Chapter IV: Changes in organization of conceptual units"
output:
  html_notebook:
    toc: yes
    toc_depth: 4
    toc_float: yes
always_allow_html: yes
---

```{r global_options, include = F}
knitr::opts_chunk$set(fig.width = 3, fig.asp = 0.67,
                      include = F, echo = F)
```

```{r}
# # for knitting to .docx
# output:
#   word_document:
#     reference_docx: "./stored/word-styles-reference.docx"
# always_allow_html: yes

# # for knitting to .nb.html 
# output:
#   html_notebook:
#     toc: yes
#     toc_depth: 4
#     toc_float: yes
```

```{r}
# run ur-setup script (which runs other scripts)
source("./scripts/_SETUP.R")

# load in EFAs & names from Chapter III
source("./scripts/stored_ch03.R")
```


# Chapter overview

In this chapter, I focus on the second of my three key questions about the development of representations of mental life: _How are the conceptual units that anchor representations of mental life organized in relation to each other, and how does this organization change over development?_ As in Chapter III, to address this question I draw on data from all of the current studies (Studies 1-4); for details about the methods of these studies, see Chapter II. The goal of this chapter is to provide "snapshots" of the organization of conceptual units in early childhood, middle childhood, and adulthood.


# General analysis plan

## High-level overview

My goal in this chapter is to examine the relationships among the "conceptual units" identified in Chapter III. How does a participant's assessment of one conceptual unit for a particular target character (e.g., the degree to which he or she indicates that a beetle is capable of the physiological sensations of the BODY) affect that participant's assessments of other conceptual units for that target character (e.g., his or her assessment of the beetle's capaciteis in the domains of HEART or MIND)?

I focus in particular on the possibility that the mental capacity attributions documented by the studies included in this dissertation—re-analyzed as indicators of the broader "conceptual units" identified in Chapter III—might shed light on the _hierarchical organization_ of these conceptual units, i.e., which conceptual units might be more basic or fundamental vs. more complex, and whether any of these conceptual units might or might not be considered to depend on the presence of others. In Chapter II, I illustrated this with the following example: If many participants endorse capacities associated with Conceptual Unit A without endorsing capacities associated with Conceptual Unit B, but very few participants do the reverse (endorsing capacities associated with Conceptual Unit B but not Conceptual Unit A), this provides some evidence that Conceptual Unit A is more basic or fundamental than Conceptual Unit B, or that Conceptual Unit B somehow depends on (perhaps requires) Conceptual Unit A. 

Here I will translate this general interest in the relationships among conceptual units, as well as the specific intuition about how to detect the kinds of asymmetries that would be the signature of hierarchical relationships, into a specific analysis plan to be applied to each of these datasets in turn. 

## Details of analyses

Unlike the previous chapter, in which I employed a canonical approach to identifying latent constructs through analyses of correlation structures—exploratory factor analysis (EFA)—in this chapter there is no tried-and-true method for meeting my analysis goals. Instead, I chart my own course through these datasets, using the EFA solutions reported in Chapter II to score participants' endorsements of each conceptual unit for the particular target character(s) that they assessed, examining visualizations of the complicated relationships among these endorsements, and then conducting more targeted statistical analyses of one particular aspect of these relationships: the possibility of asymmetries in the endorsements of these conceptual units.

### Scoring endorsements of conceptual units

The first step in these analyses is to transform participants' ratings of individual mental capacities into "scores" that indicate the extent to which they endorsed a particular conceptual unit for the target character(s) that they were assigned to assess. To do this, I make use of the EFAs presented in Chapter II—which originally served to identify a set of conceptual units in a particular sample—to a new end: the construction of "scales" for each of these conceptual units. Scale construction is a common use of EFA and similar dimensionality reduction analyses (if anything, more common than using EFA to make the kinds of theoretical arguments featured in Chapter II).

For each EFA solution, I construct a scale for each of the factors (conceptual units) identified by that solution. First, I sort each of the mental capacities included in that study into categories based on their loadings on each of the factors in that solution. For each mental capacity, I identify the "dominant" factor as the factor with the largest positive factor loading. For example, if the mental capacity _feel happy_ had loadings of 0.60 on the BODY factor, 0.70 on the HEART factor, and 0.30 on the MIND factor, I would sort it into the HEART category. For each factor, I take the six highest-loading items as a candidate scale, then "drop" the capacities with the smallest factor loadings on their respective dominant factors until I have the same number of mental capacities in each category. For example, if the BODY factor were the dominant factor for nine mental capacities, the HEART factor for six mental capacities, and the MIND factor for five capacities, for each factor I would keep only the capacities with the five highest positive loadings on that factor, in order to construct three scales of equal length (and a maximum length of six items).

To calculate scores on these scales, I take the average of all of mental capacities for each scale. This yields a dataset in which each participant is associated with one score for each of the conceptual units identified in the relative EFA solution, for each of the target characters that that participant assessed.

In this chapter, I apply this method to all of the three-factor solutions for adult samples as presented in Chapter II (Studies 1-4), yielding BODY, HEART, and MIND scores for each target character as assessed by each participant. (I ignore the aberrant four-factor solution for adults in Study 2 suggested by one of the three factor retention protocols considered in that chapter, since this was the only study out of the seven considered in which a four-factor solution appeared to add any value beyond the robust BODY-HEART-MIND framework common to all studies. [XX APPENDIX B?])

For child samples, I apply this method both to the solutions emerging from children's own data and to the corresponding _adult_ solutions for the studies in question. This allows me to explore both the relationships among children's own conceptual units, and the relationships among a fully adult-like set of conceptual units (presumably, the conceptual units that these children will eventually come to agree on as they mature into adults). 

For "older" children (7-9y of age; Studies 2 and 3), this means examining two sets of three conceptual units for each sample of children: (1) BODY, HEART, and MIND as defined by adults in that study; and (2) BODY, HEART, and MIND as defined by the children themselves. Because the EFAs for older children and adults are so similar (see Chapter II), I expect the outcomes of these two approaches to constructing BODY, HEART, and MIND scales to yield very similar results in this age group.

For "younger" children, this means examining multiple sets of conceptual units for each sample of children, including (1) BODY, HEART, and MIND as defined by adults in that study; and (2) varying sets of 2-4 conceptual units as defined by EFA of children's own responses, using different factor retention protocols. The EFAs of younger children's responses  were less reliable, and less adult-like, than those of older children. As a consequence, I expect the outcomes of these different approaches to constructing scales for each conceptual unit to yield rather different results in this age group.

The reader should note that this is far from the only way to approach "scoring" participants on these conceptual units. In particular, I could have examined factor scores—summaries of each factor (conceptual unit) based on a participant's responses to all mental capacities and the relationships between all mental capacities and all factors included in that EFA solution—rather than constructing "scales" in the way I have just outlined. However, much like _z_-scores, factor scores indicate where a participant falls in relation to other participants in the sample, and do not provide the kind of absolute score that is key to my goal in this chapter, which is to analyze relationships among factors in terms of the extent to which individual participants indicated that target characters "possessed" the conceptual units BODY, HEART, and MIND. [XX APPENDIX B?]

Even within the "scale" approach described in this section, there are many parameters of this analysis that I could have set differently. For example, I could have considered absolute factor loadings rather than raw factor loadings, which would allow for mental capacities that loaded especially strongly _negatively_ on a particular factor to contribute (negatively) to scores on that conceptual unit; I could have omitted the step of making the scales for all factors within a single EFA sotluion equal length; I could have chosen to use only the top 4 or 5 mental capacities across all EFA solutions, or to set no limit on the number of items in a scale; or I could have implemented absolute thresholds for how strongly a mental capacity must load on a factor in order to count toward the score for that conceptual unit, or absolute limits on the degree to which a mental capacity can "cross-load" on non-dominant factors and still count toward the score for any one conceptual unit. [XX APPENDIX B?] However, these kinds of details differ quite dramatically across studies and age groups. For example, in some samples there are no strong negative factor loadings, and in others there are; if I considered absolute loadings rather than raw loadings, I could end up comparing scores from a "bipolar" scale in one sample to scores from a "unipolar" scales in another sample, making the comparison more difficult to interpret. Likewise, some EFA solutions tended to feature generally weaker factor loadings than others; if I were to impose absolute thresholds for the strength of factor loadings, I could end up comparing scores from scales of wildly different lengths across samples. In my view, the analysis decisions outlined above maximize comparability across studies and age groups—the primary goal of this chapter. (Note, however, that in the analysis code for this chapter I have included easy short cuts for the interested reader to explore different options for each of these parameters.)

```{r}
# see "./scripts/org_param.R" for parameter setting
```

### Visualizing relationships

XX

outline:

- for any sample, I have identified relevant conceptual units (chapter II) and scored each participant's endorsement of each of these units for their assigned target character(s) (previous section)
- now, I want to assess the relationships among these endorsements 
- but I don't really know what to expect, and these relationships could be very complex
- so, start with holistic, exploratory visualization: scatterplots of pairs of conceptual units


### Targeting the possibility of asymmetries

XX

outline:

- now, a more targeted approach to one particular aspect of these relationships: asymmetries
- reminder of basic intuition: in this sample, do participants tend to endorse A without B? B without A? is there an asymmetry here?
- connect to the visualizations: asymmetries of points around the y=x line of equivalence
- one way to boil this down to a number: difference scores (for each pair), comparisons to 0 via bayesian regressions
- for any pair: if 0, no evidence for hierarchy. if non-zero, some evidence.
- comparisons across pairs: further from 0, more hierarchical.
- caveat 1: these are post-hoc analyses! but still using confirmatory stats. 
- caveat 2: scores of (0,0) treated same as scores of (6,6), or anywhere in between.


# Study 1: An adult endpoint

In the context of this dissertation, Study 1 serves the role of describing a developmental endpoint for conceptual representations of mental life. In this chapter, I focus on what these studies can reveal about the relationships among the conceptual units discussed in Chapter III. These analyses were not part of the original publication of these studies (Weisman et al., 2017).

## Special notes on data processing and analysis

As noted in Chapter II, in the original analysis of these datasets responses were recoded to run from -3 to +3 before analyses (Weisman et al., 2017); in this dissertation, I maintain the 0-6 coding for comparability to Studies 2-4.

Studies 1a, 1b, and 1c shared similar methods (namely, the "edge case" approach to eliciting variability in mental capacity attributions; see Chapter II) and yielded similar results both with respect to the conceptual units revealed by EFA (Chapter III), and with respect to the organization of these conceptual units (this chapter). For this reason, I will discuss these studies as a group before moving on to Study 1d, which employed substantially diferent methods (namely, the "diverse characters" approach to eliciting variability in mental capacity attributions).

## Results

### Studies 1a-1c

These studies all employed the "edge case" variant of the general approach, with participants assessing the mental capacities of a beetle and/or a robot. (See Chapter II and Weisman et al., 2017, for detailed methods.)

Studies 1a and 1b employed identical methods: US adults (Study 1a: _n_=`r nrow(d1a_ad_wide)`; Study 1b: _n_=`r nrow(d1b_ad_wide)`) each assessed a single target character on 40 mental capacities. Study 1c employed very similar methods, with the exception that participants (_n_=`r nrow(d1c_ad_wide)/2`) each assessed _both_ target characters side by side (with left-right position counterbalaned across participants).

#### Scale construction

```{r}
scales_efa_wdm_d1a_ad <- scale_fun(efa_wdm_d1a_ad, 
                                   factor_names = factor_names_efa_wdm_d1a_ad)
d1a_ad_scored_ad <- score_fun(d1a_ad, scales_efa_wdm_d1a_ad)

saveRDS(scales_efa_wdm_d1a_ad, file = "./stored/scales/scales_efa_wdm_d1a_ad")
saveRDS(d1a_ad_scored_ad, file = "./stored/scored_data/d1a_ad_scored_ad")
```

```{r}
scales_efa_wdm_d1b_ad <- scale_fun(efa_wdm_d1b_ad, 
                                   factor_names = factor_names_efa_wdm_d1b_ad)
d1b_ad_scored_ad <- score_fun(d1b_ad, scales_efa_wdm_d1b_ad)

saveRDS(scales_efa_wdm_d1b_ad, file = "./stored/scales/scales_efa_wdm_d1b_ad")
saveRDS(d1b_ad_scored_ad, file = "./stored/scored_data/d1b_ad_scored_ad")
```

```{r}
scales_efa_wdm_d1c_ad <- scale_fun(efa_wdm_d1c_ad, 
                                   factor_names = factor_names_efa_wdm_d1c_ad)
d1c_ad_scored_ad <- score_fun(d1c_ad, scales_efa_wdm_d1c_ad)

saveRDS(scales_efa_wdm_d1c_ad, file = "./stored/scales/scales_efa_wdm_d1c_ad")
saveRDS(d1c_ad_scored_ad, file = "./stored/scored_data/d1c_ad_scored_ad")
```

```{r}
fact_name_fun(factor_names_efa_wdm_d1a_ad)
fact_name_fun(factor_names_efa_wdm_d1b_ad)
fact_name_fun(factor_names_efa_wdm_d1c_ad)

scales_efa_wdm_d1a_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()
scales_efa_wdm_d1b_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()
scales_efa_wdm_d1c_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()
```

For each of these three studies, following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d1a_ad)` scales of `r scales_efa_wdm_d1a_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.1.

#### Visualization

```{r}
plots_d1a_ad_scored_ad <- relviz_fun(d1a_ad_scored_ad)
```

```{r}
fig_d1a_ad_plots <- plot_grid(plots_d1a_ad_scored_ad[[1]] + 
                                theme(legend.position = "none"),
                              plots_d1a_ad_scored_ad[[2]] + 
                                theme(legend.position = "none"),
                              plots_d1a_ad_scored_ad[[3]] + 
                                theme(legend.position = "none"),
                              labels = c("A1", "A2", "A3"), ncol = 3)

fig_d1a_ad_leg <- get_legend(
  plots_d1a_ad_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d1a_ad_plots_leg <- plot_grid(fig_d1a_ad_plots, fig_d1a_ad_leg,
                                  ncol = 1, rel_heights = c(1, 0.05))

fig_d1a_ad_title <- ggdraw() + 
  draw_label("Study 1a: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d1a_ad_plots_leg_title <- plot_grid(fig_d1a_ad_title, fig_d1a_ad_plots_leg,
                                        ncol = 1, rel_heights = c(0.12, 1))
```

```{r}
plots_d1b_ad_scored_ad <- relviz_fun(d1b_ad_scored_ad)
```

```{r}
fig_d1b_ad_plots <- plot_grid(plots_d1b_ad_scored_ad[[1]] + 
                                theme(legend.position = "none"),
                              plots_d1b_ad_scored_ad[[2]] + 
                                theme(legend.position = "none"),
                              plots_d1b_ad_scored_ad[[3]] + 
                                theme(legend.position = "none"),
                              labels = c("B1", "B2", "B3"), ncol = 3)

fig_d1b_ad_leg <- get_legend(
  plots_d1b_ad_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d1b_ad_plots_leg <- plot_grid(fig_d1b_ad_plots, fig_d1b_ad_leg,
                                  ncol = 1, rel_heights = c(1, 0.05))

fig_d1b_ad_title <- ggdraw() + 
  draw_label("Study 1b: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d1b_ad_plots_leg_title <- plot_grid(fig_d1b_ad_title, fig_d1b_ad_plots_leg,
                                        ncol = 1, rel_heights = c(0.12, 1))
```

```{r}
plots_d1c_ad_scored_ad <- relviz_fun(d1c_ad_scored_ad)
```

```{r}
fig_d1c_ad_plots <- plot_grid(plots_d1c_ad_scored_ad[[1]] + 
                                theme(legend.position = "none"),
                              plots_d1c_ad_scored_ad[[2]] + 
                                theme(legend.position = "none"),
                              plots_d1c_ad_scored_ad[[3]] + 
                                theme(legend.position = "none"),
                              labels = c("C1", "C2", "C3"), ncol = 3)

fig_d1c_ad_leg <- get_legend(
  plots_d1c_ad_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d1c_ad_plots_leg <- plot_grid(fig_d1c_ad_plots, fig_d1c_ad_leg,
                                  ncol = 1, rel_heights = c(1, 0.05))

fig_d1c_ad_title <- ggdraw() + 
  draw_label("Study 1c: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d1c_ad_plots_leg_title <- plot_grid(fig_d1c_ad_title, fig_d1c_ad_plots_leg,
                                        ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 5, fig.asp = 1.2}
# interim plot for ease of writing
plot_grid(fig_d1a_ad_plots_leg_title, 
          fig_d1b_ad_plots_leg_title, 
          fig_d1c_ad_plots_leg_title, ncol = 1)
```

The visualizations of relationships among scores on these _BODY_, _HEART_, and _MIND_ scales are remarkably similar across Studies 1a-1c (see Figure 4.1, rows A-C).

##### BODY vs. HEART

First I will consider the relationship between BODY and HEART (Figure 4.1, leftmost column: panels A1, B1, and C1). To my eyes, the most striking features of these visualizations are that (1) there is a positive relationship between scores on the _BODY_ and _HEART_ scales; and (2) there are virtually no datapoints above the line of equivalence ($y = x$, dotted diagonal line), and certainly no datapoints in upper left quadrant of these plots. Individual participants tended to endorse the mental capacity items included in the _BODY_ scale at least as strongly, and often more strongly, than they endorsed items included in the _HEART_ scale—in other words, that many participants attributed more BODY than HEART to the target character in question, but virtually no participants attribute more HEART than BODY. This asymmetry appears to have been driven primarily by participants' assessments of the beetle (in red); for the robot (in blue), _BODY_ and _HEART_ scores may have been more similar (close to the dotted line), and were generally quite low. 

##### BODY vs. MIND

Next I will consider the relationship between BODY and MIND (Figure 4.1, center column: panels A2, B2, and C2). Similar to the BODY vs. HEART comparison, two notable features of these visualizations are that (1) there is a positive relationship between scores on the _BODY_ and _MIND_ scales; and (2) there are fewer datapoints below the line of equivalence ($y = x$, dotted diagonal line) than above it, and no datapoints in lower right quadrant of these plots. Most participants tended to endorse the mental capacity items included in the _MIND_ scale roughly as strongly, and sometimes more strongly, than they endorsed items included in the _BODY_ scale, while relatively few particpiants endorsed _MIND_ items less strongly than _BODY_ items (though this asymmetry appears to have been less extreme than the asymmetry between _BODY_ and _HEART_ scores documented in the previous paragraph). In this case, the asymmetry between _BODY_ and _MIND_ appears to have been driven primarily by participants' assessments of the robot (in blue); for the beetle (in red), _BODY_ and _MIND_ scores appear to have been more similar (close to the dotted line). 

##### HEART vs. MIND

Finally I will consider the relationship between HEART and MIND (Figure 4.1, rightmost column: panels A3, B3, and C3). Again, two features of these visualizations are particularly striking: (1) There is a positive relationship between scores on the _MIND_ and _HEART_ scales; and (2) there are virtually _no_ datapoints below the line of equivalence ($y = x$, dotted diagonal line). The asymmetry between _MIND_ and _HEART_ scores appears to have been particularly extreme: Almost _all_ participants endorsed the mental capacity items included in the _MIND_ scale more strongly than the items included in the _HEART_ scale. In this case, this asymmetry appears to be born out for both target characters, but perhaps more exaggerated for the beetle (in red) than the robot (in blue).

##### Interim discussion

Across Studies 1a-1c, all three of the relationships among the conceptual units identified in Chapter III (BODY, HEART, and MIND) appear to be characterized by two features: (1) Positive relationships, such that the more strongly a participant endorsed one conceptual unit, the more strongly they tended to endorse the others; and (2) Robust asymmetries in these positive relationships, such that participants tended to endorse MIND more strongly than BODY or HEART, and HEART more strongly than MIND. Visual inspection suggests that these asymmetries were most pronounced for comparisons involving HEART, with virtually every participant across all three of these studies endorsing both BODY and MIND more strongly than HEART for both of the "edge case" characters included in these studies (a beetle and a robot). In the following section, I delve deeper into a more formal analysis of these asymmetries.

#### Analysis of asymmetries

XX

```{r}
d1a_ad_scored_ad_diff <- diff_fun(d1a_ad_scored_ad)
saveRDS(d1a_ad_scored_ad_diff, "./stored/diffscore_data/d1a_ad_scored_ad_diff")
```

```{r}
plot_d1a_ad_scored_ad_diff <- diffplot_fun(d1a_ad_scored_ad_diff)
```

```{r}
# r_d1a_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1a_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1a_ad_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1a_ad_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d1a_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d1a_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1a_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1a_ad_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1a_ad_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d1a_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d1a_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1a_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1a_ad_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d1a_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1a_ad_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d1a_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d1a_ad_scored_ad_diff_HEART_MIND)
```


```{r}
d1b_ad_scored_ad_diff <- diff_fun(d1b_ad_scored_ad)
saveRDS(d1b_ad_scored_ad_diff, "./stored/diffscore_data/d1b_ad_scored_ad_diff")
```

```{r}
plot_d1b_ad_scored_ad_diff <- diffplot_fun(d1b_ad_scored_ad_diff)
```

```{r}
# r_d1b_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1b_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1b_ad_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1b_ad_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d1b_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d1b_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1b_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1b_ad_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1b_ad_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d1b_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d1b_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1b_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1b_ad_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d1b_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1b_ad_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d1b_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d1b_ad_scored_ad_diff_HEART_MIND)
```


```{r}
d1c_ad_scored_ad_diff <- diff_fun(d1c_ad_scored_ad)
saveRDS(d1c_ad_scored_ad_diff, "./stored/diffscore_data/d1c_ad_scored_ad_diff")
```

```{r}
plot_d1c_ad_scored_ad_diff <- diffplot_fun(d1c_ad_scored_ad_diff)
```

```{r}
# r_d1c_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1c_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1c_ad_scored_ad_diff_BODY_HEART <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1c_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1  + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d1c_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d1c_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1c_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1c_ad_scored_ad_diff_BODY_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1c_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d1c_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d1c_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1c_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d1c_ad_scored_ad_diff_HEART_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d1c_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d1c_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d1c_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d1c_ad_scored_ad_diff_HEART_MIND)
```

### Study 1d

In Study 1d, `r nrow(d1d_ad_wide)` US adults each assessed a single target character on 40 mental capacities. Unlike Studies 1a-1c, this study employed the "many characters" variant of the general approach, in which participants were randomly assigned to assess one of the following 21 target characters: an adult, a child, an infant, a person in a persistent vegetative state, a fetus, a chimpanzee, an elephant, a dolphin, a bear, a dog, a goat, a mouse, a frog, a blue jay, a fish, a beetle, a microbe, a robot, a computer, a car, or a stapler. (See Chapter II and Weisman et al., 2017, for detailed methods.)

#### Scale construction

```{r}
scales_efa_wdm_d1d_ad <- scale_fun(efa_wdm_d1d_ad, 
                                   factor_names = factor_names_efa_wdm_d1d_ad)
d1d_ad_scored_ad <- score_fun(d1d_ad, scales_efa_wdm_d1d_ad)

saveRDS(scales_efa_wdm_d1d_ad, file = "./stored/scales/scales_efa_wdm_d1d_ad")
saveRDS(d1d_ad_scored_ad, file = "./stored/scored_data/d1d_ad_scored_ad")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d1d_ad)` scales of `r scales_efa_wdm_d1d_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.1.

#### Visualization

XX

```{r}
plots_d1d_ad_scored_ad <- relviz_fun(d1d_ad_scored_ad, colors = colors21)
```

```{r}
fig_d1d_ad_plots <- plot_grid(plots_d1d_ad_scored_ad[[1]] + 
                                theme(legend.position = "none"),
                              plots_d1d_ad_scored_ad[[2]] + 
                                theme(legend.position = "none"),
                              plots_d1d_ad_scored_ad[[3]] + 
                                theme(legend.position = "none"),
                              labels = c("D1", "D2", "D3"), ncol = 3)

fig_d1d_ad_leg <- get_legend(
  plots_d1d_ad_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors21,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 7)) +
    scale_color_manual("Target character", values = colors21,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 7)))

fig_d1d_ad_plots_leg <- plot_grid(fig_d1d_ad_plots, fig_d1d_ad_leg,
                                  ncol = 1, rel_heights = c(1, 0.2))

fig_d1d_ad_title <- ggdraw() + 
  draw_label("Study 1d: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d1d_ad_plots_leg_title <- plot_grid(fig_d1d_ad_title, fig_d1d_ad_plots_leg,
                                        ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

XX

```{r}
d1d_ad_scored_ad_diff <- diff_fun(d1d_ad_scored_ad)
saveRDS(d1d_ad_scored_ad_diff, "./stored/diffscore_data/d1d_ad_scored_ad_diff")
```

```{r}
plot_d1d_ad_scored_ad_diff <- diffplot_fun(d1d_ad_scored_ad_diff, 
                                           colors21, wid = 0.9)
```

```{r}
# r_d1d_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv21),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1d_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv21))

r_d1d_ad_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_dv21))

# r_d1d_ad_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d1d_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d1d_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv21),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1d_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv21))

r_d1d_ad_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_dv21))

# r_d1d_ad_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d1d_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d1d_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv21),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d1d_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv21))

r_d1d_ad_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d1d_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv21))

# r_d1d_ad_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d1d_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d1d_ad_scored_ad_diff_HEART_MIND)
```

## Discussion

XX

```{r}
scales_study1 <- bind_rows(scales_efa_wdm_d1a_ad %>% mutate(study = "Study 1a"),
                           scales_efa_wdm_d1b_ad %>% mutate(study = "Study 1b"),
                           scales_efa_wdm_d1c_ad %>% mutate(study = "Study 1c"),
                           scales_efa_wdm_d1d_ad %>% mutate(study = "Study 1d")) %>%
  select(-c(loading, order)) %>%
  distinct() %>%
  spread(study, factor) %>%
  mutate(ur_factor = ifelse(!is.na(`Study 1a`), `Study 1a`,
                            ifelse(!is.na(`Study 1b`), `Study 1b`,
                                   ifelse(!is.na(`Study 1c`), `Study 1c`,
                                          `Study 1d`)))) %>%
  left_join(scales_efa_wdm_d1a_ad %>% 
              select(capacity, order) %>% rename(order1a = order)) %>%
  left_join(scales_efa_wdm_d1b_ad %>% 
              select(capacity, order) %>% rename(order1b = order)) %>%
  left_join(scales_efa_wdm_d1c_ad %>% 
              select(capacity, order) %>% rename(order1c = order)) %>%
  left_join(scales_efa_wdm_d1d_ad %>% 
              select(capacity, order) %>% rename(order1d = order)) %>%
  arrange(ur_factor, order1a, order1b, order1c, order1d) %>%
  select(-c(ur_factor, starts_with("order")))
```

```{r}
table4.1 <- scales_study1 %>%
  mutate_at(vars(-capacity),
            funs(ifelse(is.na(.), "", "✓"))) %>%
  rename(Capacity = capacity) %>%
  kable(format = "html", 
        caption = "Table 4.1: Scales for each of the conceptual units (factors) identified by EFA for US Adults in Studies 1a-1d (see Chapter III). A checkmark indicates that a mental capacity was included in a scale for a particular study.") %>%  
  kable_styling() %>%
  group_rows("BODY scale", 1, 9) %>%
  group_rows("HEART scale", 10, 17) %>%
  group_rows("MIND scale", 18, 26)
```

```{r table4.1, include = T}
table4.1
```

```{r}
figure4.1 <- plot_grid(fig_d1a_ad_plots_leg_title, fig_d1b_ad_plots_leg_title,
                       fig_d1c_ad_plots_leg_title, fig_d1d_ad_plots_leg_title, 
                       ncol = 1, rel_heights = c(1, 1, 1, 1.15))

figure4.1_cap <- add_sub(figure4.1, str_wrap("Figure 4.1: Relationships among US adults' attributions of conceptual units in Studies 1a-1d, organized by study (rows) and pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.8}
ggdraw(figure4.1_cap)
```

```{r}
figure4.2_plots123 <- plot_grid(plot_d1a_ad_scored_ad_diff + 
                                  labs(title = "Study 1a: Adults") +
                                  theme(legend.position = "none"), 
                                plot_d1b_ad_scored_ad_diff + 
                                  labs(title = "Study 1b: Adults") +
                                  theme(legend.position = "none"),
                                plot_d1c_ad_scored_ad_diff + 
                                  labs(title = "Study 1c: Adults") +
                                  theme(legend.position = "none"), 
                                ncol = 3, rel_widths = c(1, 1, 1),
                                labels = "AUTO")

figure4.2_plots123_leg <- plot_grid(figure4.2_plots123,
                                    get_legend(
                                      plot_d1a_ad_scored_ad_diff +
                                        theme(legend.position = "bottom")),
                                    ncol = 1, rel_heights = c(1, 0.1))

figure4.2_plots4 <- plot_grid(plot_d1d_ad_scored_ad_diff +
                                labs(title = "Study 1d: Adults") +
                                theme(legend.position = "none"),
                              labels = "D")

figure4.2_plots4_leg <- plot_grid(figure4.2_plots4,
                                  get_legend(
                                    plot_d1d_ad_scored_ad_diff +
                                      theme(legend.position = "bottom")),
                                  ncol = 1, rel_heights = c(1, 0.2))

figure4.2_plots <- plot_grid(figure4.2_plots123_leg, figure4.2_plots4_leg,
                             ncol = 1, rel_heights = c(1, 1.1))

figure4.2_cap <- add_sub(figure4.2_plots, str_wrap("Figure 4.2: Difference scores between US adults' attributions of conceptual units in Studies 1a-1d. For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 140), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 6, fig.asp = 0.8}
ggdraw(figure4.2_cap)
```


# Study 2: Conceptual change between middle childhood (7-9y) and adulthood

In Study 2, `r nrow(d2_ad_wide)` US adults and `r nrow(d2_79_wide)` US children between the ages of `r summary(d2_79$age)["Min."] %>% round(2)`-`r summary(d2_79$age)["Max."] %>% round(2)` years (median: `r summary(d2_79$age)["Median"] %>% round(2)`y) each assessed a single target character on 40 mental capacities. To make the study appropriate for children in this age range, the wording of some the 40 mental capacities employed in Study 1 was modified to use more age-appropriate vocabulary, and participants responded on a 3-point scale ("no," coded as 0; "kinda," coded as 0.5, "yes," coded as 1). This study employed the "edge case" variant of the general approach, with participants randomly assigned to assess either a beetle or a robot. (See Chapter II for detailed methods.)

## Special notes on data processing and analysis

## Results

### Adults

#### Scale construction

```{r}
scales_efa_wdm_d2_ad <- scale_fun(efa_wdm_d2_ad, 
                                  factor_names = factor_names_efa_wdm_d2_ad)
d2_ad_scored_ad <- score_fun(d2_ad, scales_efa_wdm_d2_ad)

saveRDS(scales_efa_wdm_d2_ad, file = "./stored/scales/scales_efa_wdm_d2_ad")
saveRDS(d2_ad_scored_ad, file = "./stored/scored_data/d2_ad_scored_ad")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d2_ad)` scales of `r scales_efa_wdm_d2_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.2.

#### Visualization

```{r}
plots_d2_ad_scored_ad <- relviz_fun(d2_ad_scored_ad)
```

```{r}
fig_d2_ad_plots <- plot_grid(plots_d2_ad_scored_ad[[1]] +
                               theme(legend.position = "none"),
                             plots_d2_ad_scored_ad[[2]] + 
                               theme(legend.position = "none"),
                             plots_d2_ad_scored_ad[[3]] + 
                               theme(legend.position = "none"),
                             labels = c("A1", "A2", "A3"), ncol = 3)

fig_d2_ad_leg <- get_legend(
  plots_d2_ad_scored_ad[[1]] + 
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d2_ad_plots_leg <- plot_grid(fig_d2_ad_plots, fig_d2_ad_leg,
                                 ncol = 1, rel_heights = c(1, 0.05))

fig_d2_ad_title <- ggdraw() + 
  draw_label("Study 2: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d2_ad_plots_leg_title <- plot_grid(fig_d2_ad_title, fig_d2_ad_plots_leg,
                                       ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

```{r}
d2_ad_scored_ad_diff <- diff_fun(d2_ad_scored_ad)
saveRDS(d2_ad_scored_ad_diff, "./stored/diffscore_data/d2_ad_scored_ad_diff")
```

```{r}
plot_d2_ad_scored_ad_diff <- diffplot_fun(d2_ad_scored_ad_diff, colors02)
```

```{r}
# r_d2_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_ad_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_ad_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d2_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d2_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_ad_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_ad_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d2_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d2_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d2_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_ad_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d2_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_ad_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d2_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d2_ad_scored_ad_diff_HEART_MIND)
```

XX

### Children (7-9y)

```{r}
d2_79_scored_ad <- score_fun(d2_79, scales_efa_wdm_d2_ad)
saveRDS(d2_79_scored_ad, file = "./stored/scored_data/d2_79_scored_ad")
```

#### Visualization

XX

```{r}
plots_d2_79_scored_ad <- relviz_fun(d2_79_scored_ad)
```

```{r}
fig_d2_79_scored_ad_plots <- plot_grid(plots_d2_79_scored_ad[[1]] + 
                                         theme(legend.position = "none"),
                                       plots_d2_79_scored_ad[[2]] + 
                                         theme(legend.position = "none"),
                                       plots_d2_79_scored_ad[[3]] + 
                                         theme(legend.position = "none"),
                                       labels = c("B1", "B2", "B3"), ncol = 3)

fig_d2_79_scored_ad_leg <- get_legend(
  plots_d2_79_scored_ad[[1]] + 
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d2_79_scored_ad_plots_leg <- plot_grid(
  fig_d2_79_scored_ad_plots, fig_d2_79_scored_ad_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d2_79_scored_ad_title <- ggdraw() + 
  draw_label("Study 2: Children, 7-9y (scored using adults' scales)", 
             size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d2_79_scored_ad_plots_leg_title <- plot_grid(
  fig_d2_79_scored_ad_title, fig_d2_79_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r}
plots_agegp_d2_scored_ad <- relviz_agegp_fun(
  d_scored = d2_ad_scored_ad %>% full_join(d2_79_scored_ad), 
  age_groups = c("children79", "adults"),
  age_group_labels = c("Children (7-9y)", "Adults"))
```

```{r}
fig_d2_all_scored_ad_plots <- plot_grid(plots_agegp_d2_scored_ad[[1]] + 
                                          theme(legend.position = "none"),
                                        plots_agegp_d2_scored_ad[[2]] + 
                                          theme(legend.position = "none"),
                                        plots_agegp_d2_scored_ad[[3]] + 
                                          theme(legend.position = "none"),
                                        labels = c("C1", "C2", "C3"), ncol = 3)

fig_d2_all_scored_ad_leg <- get_legend(
  plots_agegp_d2_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_color_manual("Target character", values = colors02,
                       na.translate = F,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d2_all_scored_ad_plots_leg <- plot_grid(
  fig_d2_all_scored_ad_plots, fig_d2_all_scored_ad_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d2_all_scored_ad_title <- ggdraw() + 
  draw_label("Tracking development between 7-9y and adulthood (scored using adults' scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d2_all_scored_ad_plots_leg_title <- plot_grid(
  fig_d2_all_scored_ad_title, fig_d2_all_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

```{r}
d2_79_scored_ad_diff <- diff_fun(d2_79_scored_ad)
saveRDS(d2_79_scored_ad_diff, "./stored/diffscore_data/d2_79_scored_ad_diff")
```

```{r}
plot_d2_79_scored_ad_diff <- diffplot_fun(d2_79_scored_ad_diff, colors02)
```

```{r}
# r_d2_79_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_79_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_79_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d2_79_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_79_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d2_79_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d2_79_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d2_79_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_79_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_79_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d2_79_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_79_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d2_79_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d2_79_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d2_79_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_79_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_79_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d2_79_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_79_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d2_79_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d2_79_scored_ad_diff_HEART_MIND)
```

XX

### Developmental comparison

```{r}
# r_d2_ad79_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_ad79_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp))

r_d2_ad79_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character * age_group,
  data = d2_ad_scored_ad_diff %>% 
    full_join(d2_79_scored_ad_diff) %>%
    filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge,
                   age_group = contrasts_dum2_agegp))

# r_d2_ad79_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1 + age_group,
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(age_group = contrasts_dum2_agegp))

summary(r_d2_ad79_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d2_ad79_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_ad79_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp))

r_d2_ad79_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character * age_group,
  data = d2_ad_scored_ad_diff %>% 
    full_join(d2_79_scored_ad_diff) %>%
    filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge,
                   age_group = contrasts_dum2_agegp))

# r_d2_ad79_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1 + age_group,
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(age_group = contrasts_dum2_agegp))

summary(r_d2_ad79_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d2_ad79_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_ad79_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp))

r_d2_ad79_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character * age_group,
  data = d2_ad_scored_ad_diff %>% 
    full_join(d2_79_scored_ad_diff) %>%
    filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge,
                   age_group = contrasts_dum2_agegp))

# r_d2_ad79_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1 + age_group,
#   data = d2_ad_scored_ad_diff %>%
#     full_join(d2_79_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(age_group = contrasts_dum2_agegp))

summary(r_d2_ad79_scored_ad_diff_HEART_MIND)
```

### Children (7-9y), using children's own scales

#### Scale construction

```{r}
scales_efa_wdm_d2_79 <- scale_fun(efa_wdm_d2_79, 
                                  factor_names = factor_names_efa_wdm_d2_79)
d2_79_scored_79 <- score_fun(d2_79, scales_efa_wdm_d2_79)

saveRDS(scales_efa_wdm_d2_79, file = "./stored/scales/scales_efa_wdm_d2_79")
saveRDS(d2_79_scored_79, file = "./stored/scored_data/d2_79_scored_79")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d2_79)` scales of `r scales_efa_wdm_d2_79 %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.2.

#### Visualization

```{r}
d2_79_scored_79_diff <- diff_fun(d2_79_scored_79)
saveRDS(d2_79_scored_79_diff, "./stored/diffscore_data/d2_79_scored_79_diff")
```

```{r}
plots_d2_79_scored_79 <- relviz_fun(d2_79_scored_79)
```

```{r}
fig_d2_79_scored_79_plots <- plot_grid(plots_d2_79_scored_79[[1]] + 
                                         theme(legend.position = "none"),
                                       plots_d2_79_scored_79[[2]] + 
                                         theme(legend.position = "none"),
                                       plots_d2_79_scored_79[[3]] + 
                                         theme(legend.position = "none"),
                                       labels = c("A1", "A2", "A3"), ncol = 3)

fig_d2_79_scored_79_leg <- get_legend(
  plots_d2_79_scored_79[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d2_79_scored_79_plots_leg <- plot_grid(fig_d2_79_scored_79_plots,
                                           fig_d2_79_scored_79_leg,
                                           ncol = 1, rel_heights = c(1, 0.05))

fig_d2_79_scored_79_title <- ggdraw() + 
  draw_label("Study 2: Children, 7-9y (scored using their own scales)", 
             size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d2_79_scored_79_plots_leg_title <- plot_grid(
  fig_d2_79_scored_79_title, fig_d2_79_scored_79_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

```{r}
plot_d2_79_scored_79_diff <- diffplot_fun(d2_79_scored_79_diff, colors02)
```

```{r}
# r_d2_79_scored_79_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_79_scored_79_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_79_scored_79_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d2_79_scored_79_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_79_scored_79_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d2_79_scored_79_diff %>% filter(pair == "BODY - HEART"))

summary(r_d2_79_scored_79_diff_BODY_HEART)
```

```{r}
# r_d2_79_scored_79_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_79_scored_79_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_79_scored_79_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d2_79_scored_79_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_79_scored_79_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d2_79_scored_79_diff %>% filter(pair == "BODY - MIND"))

summary(r_d2_79_scored_79_diff_BODY_MIND)
```

```{r}
# r_d2_79_scored_79_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d2_79_scored_79_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d2_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d2_79_scored_79_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d2_79_scored_79_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d2_79_scored_79_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d2_79_scored_79_diff %>% filter(pair == "HEART - MIND"))

summary(r_d2_79_scored_79_diff_HEART_MIND)
```

XX

## Discussion

XX

```{r}
scales_study2 <- bind_rows(scales_efa_wdm_d2_ad %>% 
                             mutate(study = "Adults"),
                           scales_efa_wdm_d2_79 %>% 
                             mutate(study = "Children, 7-9y")) %>%
  select(-c(loading, order)) %>%
  distinct() %>%
  spread(study, factor) %>%
  mutate(ur_factor = ifelse(!is.na(`Adults`), `Adults`, `Children, 7-9y`)) %>%
  left_join(scales_efa_wdm_d2_ad %>% 
              select(capacity, order) %>% rename(order_ad = order)) %>%
  left_join(scales_efa_wdm_d2_79 %>% 
              select(capacity, order) %>% rename(order_79 = order)) %>%
  arrange(ur_factor, order_ad, order_79) %>%
  select(-ur_factor) # %>%
# select(-starts_with("order"))
```

```{r}
figure4.3 <- plot_grid(fig_d2_ad_plots_leg_title, 
                       fig_d2_79_scored_ad_plots_leg_title,
                       fig_d2_all_scored_ad_plots_leg_title,
                       ncol = 1)

figure4.3_cap <- add_sub(figure4.3, str_wrap("Figure 4.3: Relationships among US adults', older children's, and younger children's attributions of conceptual units in Study 2, scored using adults' BODY, HEART, and MIND scales (see Table 4.2). Plots are organized by sample (rows) and by pair of conceptual units (columns). (A) Adults. (B) Children (7-9y of age), scored using adults' scales. (C) A visualization of development between 7-9y and adulthood, using mean scores by character and age group. For each conceptual unit, scores could range from 0-1. In panels A-B, individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.4}
ggdraw(figure4.3_cap)
```

```{r}
figure4.4 <- plot_grid(fig_d2_79_scored_79_plots_leg_title, 
                       ncol = 1)

figure4.4_cap <- add_sub(figure4.4, str_wrap("Figure 4.4: Relationships among children's attributions of conceptual units in Study 2, scored using their own scales (see Table 4.2). Plots are organized by pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 0.5}
ggdraw(figure4.4_cap)
```

```{r}
figure4.5_plots <- plot_grid(
  plot_d2_ad_scored_ad_diff +
    labs(title = "Study 2: Adults") +
    theme(legend.position = "bottom"),
  plot_d2_79_scored_ad_diff +
    labs(title = "Study 2: Children, 7-9y (scored using adults' scales)") +
    theme(legend.position = "bottom"),
  plot_d2_79_scored_79_diff + 
    labs(title = "Study 2: Children, 4-6y (scored using their own scales)") +
    theme(legend.position = "bottom"), 
  ncol = 3, rel_widths = c(1, 1, 1),
  labels = "AUTO")

figure4.5_cap <- add_sub(figure4.5_plots, str_wrap("Figure 4.5: Difference scores between US adults' and children's attributions of conceptual units in Study 2. this includes difference scores using adults' BODY, HEART, and MIND scales (panel B) and difference scores using children's own scales (panel C; see Table 4.2). For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 180), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 8, fig.asp = 0.38}
ggdraw(figure4.5_cap)
```

# Study 3: Conceptual change over early and middle childhood (4-9y)

In Study 3, `r nrow(d3_ad_wide)` US adults, `r nrow(d3_79_wide)` "older" children (`r summary(d3_79$age)["Min."] %>% round(2)`-`r summary(d3_79$age)["Max."] %>% round(2)` years; median: `r summary(d3_79$age)["Median"] %>% round(2)`y), and `r nrow(d3_46_wide)` "younger" children (`r summary(d3_46$age)["Min."] %>% round(2)`-`r summary(d3_46$age)["Max."] %>% round(2)` years; median: `r summary(d3_46$age)["Median"] %>% round(2)`y) each assessed a single target character on 20 mental capacities. To make the study appropriate for children in this age range, participants assessed a subset of the 40 mental capacities employed in Study 2, chosen to represent the three "conceptual units" revealed by Studies 1-2 (BODY, HEART, and MIND) and to cover a similar range of mental capacities as Studies 1-2. As in Study 2, participants responded on a 3-point scale ("no," coded as 0; "kinda," coded as 0.5, "yes," coded as 1). This study employed the "diverse characters" variant of the general approach, with participants randomly or pseudo-randomly assigned to assess either one of the following 9 characters: an elephant, a goat, a mouse, a bird, a beetle, a teddy bear, a doll, a robot, or a computer. (See Chapter II for detailed methods.)

## Special notes on data processing and analysis

## Results

### Adults

#### Scale construction

```{r}
scales_efa_wdm_d3_ad <- scale_fun(efa_wdm_d3_ad, 
                                  factor_names = factor_names_efa_wdm_d3_ad)
d3_ad_scored_ad <- score_fun(d3_ad, scales_efa_wdm_d3_ad)

saveRDS(scales_efa_wdm_d3_ad, file = "./stored/scales/scales_efa_wdm_d3_ad")
saveRDS(d3_ad_scored_ad, file = "./stored/scored_data/d3_ad_scored_ad")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d3_ad)` scales of `r scales_efa_wdm_d3_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.2.

#### Visualization

XX

```{r}
plots_d3_ad_scored_ad <- relviz_fun(d3_ad_scored_ad, colors = colors09)
```

```{r}
fig_d3_ad_plots <- plot_grid(plots_d3_ad_scored_ad[[1]] + 
                               theme(legend.position = "none"),
                             plots_d3_ad_scored_ad[[2]] + 
                               theme(legend.position = "none"),
                             plots_d3_ad_scored_ad[[3]] + 
                               theme(legend.position = "none"),
                             labels = c("A1", "A2", "A3"), ncol = 3)

fig_d3_ad_leg <- get_legend(
  plots_d3_ad_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", 
                      values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character",
                       values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_ad_plots_leg <- plot_grid(fig_d3_ad_plots, fig_d3_ad_leg,
                                 ncol = 1, rel_heights = c(1, 0.05))

fig_d3_ad_title <- ggdraw() + 
  draw_label("Study 3: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_ad_plots_leg_title <- plot_grid(fig_d3_ad_title, fig_d3_ad_plots_leg,
                                       ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

XX

```{r}
d3_ad_scored_ad_diff <- diff_fun(d3_ad_scored_ad)
saveRDS(d3_ad_scored_ad_diff, "./stored/diffscore_data/d3_ad_scored_ad_diff")
```

```{r}
d3_ad_scored_ad_diff <- diff_fun(d3_ad_scored_ad)
```

```{r}
plot_d3_ad_scored_ad_diff <- diffplot_fun(d3_ad_scored_ad_diff, colors09)
```

```{r}
# r_d3_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_ad_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_ad_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d3_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d3_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_ad_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_ad_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d3_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d3_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d3_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_ad_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d3_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_ad_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d3_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d3_ad_scored_ad_diff_HEART_MIND)
```

### Children (7-9y)

```{r}
# just for table
scales_efa_wdm_d3_79 <- scale_fun(efa_wdm_d3_79, 
                                   factor_names = factor_names_efa_wdm_d3_79)
saveRDS(scales_efa_wdm_d3_79, file = "./stored/scales/scales_efa_wdm_d3_79")
```

```{r}
d3_79_scored_ad <- score_fun(d3_79, scales_efa_wdm_d3_ad)
saveRDS(d3_79_scored_ad, file = "./stored/scored_data/d3_79_scored_ad")
```

#### Visualization

XX

```{r}
plots_d3_79_scored_ad <- relviz_fun(d3_79_scored_ad, colors = colors09)
```

```{r}
fig_d3_79_scored_ad_plots <- plot_grid(plots_d3_79_scored_ad[[1]] + 
                                         theme(legend.position = "none"),
                                       plots_d3_79_scored_ad[[2]] + 
                                         theme(legend.position = "none"),
                                       plots_d3_79_scored_ad[[3]] + 
                                         theme(legend.position = "none"),
                                       labels = c("B1", "B2", "B3"), ncol = 3)

fig_d3_79_scored_ad_leg <- get_legend(
  plots_d3_79_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", 
                      values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character",
                       values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_79_scored_ad_plots_leg <- plot_grid(
  fig_d3_79_scored_ad_plots, fig_d3_79_scored_ad_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d3_79_scored_ad_title <- ggdraw() + 
  draw_label("Study 3: Children, 7-9y (scored using adults' scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_79_scored_ad_plots_leg_title <- plot_grid(
  fig_d3_79_scored_ad_title, fig_d3_79_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

```{r}
d3_79_scored_ad_diff <- diff_fun(d3_79_scored_ad)
saveRDS(d3_79_scored_ad_diff, "./stored/diffscore_data/d3_79_scored_ad_diff")
```

```{r}
plot_d3_79_scored_ad_diff <- diffplot_fun(d3_79_scored_ad_diff, colors09)
```

```{r}
# r_d3_79_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_79_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_79_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d3_79_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_79_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d3_79_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d3_79_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d3_79_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_79_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_79_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d3_79_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_79_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d3_79_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d3_79_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d3_79_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_79_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_79_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_79_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d3_79_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_79_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d3_79_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d3_79_scored_ad_diff_HEART_MIND)
```

### Children (4-6y)

```{r}
d3_46_scored_ad <- score_fun(d3_46, scales_efa_wdm_d3_ad)
saveRDS(d3_46_scored_ad, file = "./stored/scored_data/d3_46_scored_ad")
```

#### Visualization

```{r}
plots_d3_46_scored_ad <- relviz_fun(d3_46_scored_ad, colors = colors09)
```

```{r}
fig_d3_46_scored_ad_plots <- plot_grid(plots_d3_46_scored_ad[[1]] + 
                                         theme(legend.position = "none"),
                                       plots_d3_46_scored_ad[[2]] + 
                                         theme(legend.position = "none"),
                                       plots_d3_46_scored_ad[[3]] + 
                                         theme(legend.position = "none"),
                                       labels = c("C1", "C2", "C3"), ncol = 3)

fig_d3_46_scored_ad_leg <- get_legend(
  plots_d3_46_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors09,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 9)) +
    scale_color_manual("Target character", values = colors09,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_46_scored_ad_plots_leg <- plot_grid(
  fig_d3_46_scored_ad_plots, fig_d3_46_scored_ad_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d3_46_scored_ad_title <- ggdraw() + 
  draw_label("Study 3: Children, 4-6y (scored using adults' scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_46_scored_ad_plots_leg_title <- plot_grid(
  fig_d3_46_scored_ad_title, fig_d3_46_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

```{r}
d3_46_scored_ad_diff <- diff_fun(d3_46_scored_ad)
saveRDS(d3_46_scored_ad_diff, "./stored/diffscore_data/d3_46_scored_ad_diff")
```

```{r}
plot_d3_46_scored_ad_diff <- diffplot_fun(d3_46_scored_ad_diff, colors09)
```

```{r}
# r_d3_46_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1,
#   data = d3_46_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d3_46_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d3_46_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1,
#   data = d3_46_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d3_46_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d3_46_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_46_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character),
#   data = d3_46_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09))

r_d3_46_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character,
  data = d3_46_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv09))

# r_d3_46_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1,
#   data = d3_46_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d3_46_scored_ad_diff_HEART_MIND)
```

### Developmental comparison

```{r}
# r_d3_ad7946_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09,
#                    age_group = contrasts_dum3_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_ad7946_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_dv09,
#                    age_group = contrasts_dum3_agegp))

r_d3_ad7946_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character * age_group,
  data = d3_ad_scored_ad_diff %>% 
    full_join(d3_79_scored_ad_diff) %>%
    full_join(d3_46_scored_ad_diff) %>%
    filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_dv09,
                   age_group = contrasts_dum3_agegp))

# r_d3_ad7946_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1 + age_group,
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(age_group = contrasts_dum3_agegp))

summary(r_d3_ad7946_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d3_ad7946_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09,
#                    age_group = contrasts_dum3_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_ad7946_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_dv09,
#                    age_group = contrasts_dum3_agegp))

r_d3_ad7946_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character * age_group,
  data = d3_ad_scored_ad_diff %>% 
    full_join(d3_79_scored_ad_diff) %>%
    full_join(d3_46_scored_ad_diff) %>%
    filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_dv09,
                   age_group = contrasts_dum3_agegp))

# r_d3_ad7946_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1 + age_group,
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(age_group = contrasts_dum3_agegp))

summary(r_d3_ad7946_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d3_ad7946_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09,
#                    age_group = contrasts_dum3_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d3_ad7946_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_dv09,
#                    age_group = contrasts_dum3_agegp))

r_d3_ad7946_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character * age_group,
  data = d3_ad_scored_ad_diff %>% 
    full_join(d3_79_scored_ad_diff) %>%
    full_join(d3_46_scored_ad_diff) %>%
    filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_dv09,
                   age_group = contrasts_dum3_agegp))

# r_d3_ad7946_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1 + age_group,
#   data = d3_ad_scored_ad_diff %>%
#     full_join(d3_79_scored_ad_diff) %>%
#     full_join(d3_46_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(age_group = contrasts_dum3_agegp))

summary(r_d3_ad7946_scored_ad_diff_HEART_MIND)
```

## Discussion

XX

```{r}
scales_study3 <- bind_rows(scales_efa_wdm_d3_ad %>% 
                             mutate(study = "Study 3: Adults"),
                           scales_efa_wdm_d3_79 %>% 
                             mutate(study = "Study 3: Children, 7-9y")) %>%
  select(-c(loading, order)) %>%
  distinct() %>%
  spread(study, factor) %>%
  mutate(ur_factor = `Study 3: Adults`) %>%
  left_join(scales_efa_wdm_d3_ad %>% 
              select(capacity, order) %>% rename(order_ad = order)) %>%
  left_join(scales_efa_wdm_d3_79 %>% 
              select(capacity, order) %>% rename(order_79 = order)) %>%
  arrange(ur_factor, order_ad, order_79) %>%
  select(-ur_factor) #%>%
# select(-starts_with("order"))
```

```{r}
plots_agegp_d3_scored_ad <- relviz_agegp_fun(
  d_scored = d3_ad_scored_ad %>% 
    full_join(d3_79_scored_ad) %>% 
    full_join(d3_46_scored_ad), 
  age_groups = c("children46", "children79", "adults"),
  age_group_labels = c("Children, (4-6y)", "Children (7-9y)", "Adults"),
  colors = colors09)
```

```{r}
fig_d3_all_scored_ad_plots <- plot_grid(plots_agegp_d3_scored_ad[[1]] + 
                                          theme(legend.position = "none"),
                                        plots_agegp_d3_scored_ad[[2]] + 
                                          theme(legend.position = "none"),
                                        plots_agegp_d3_scored_ad[[3]] + 
                                          theme(legend.position = "none"),
                                        labels = c("D1", "D2", "D3"), ncol = 3)

fig_d3_all_scored_ad_leg <- get_legend(
  plots_agegp_d3_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_color_manual("Target character", values = colors09,
                       na.translate = F,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 9)))

fig_d3_all_scored_ad_plots_leg <- plot_grid(
  fig_d3_all_scored_ad_plots, fig_d3_all_scored_ad_leg,
  ncol = 1, rel_heights = c(1, 0.05))

fig_d3_all_scored_ad_title <- ggdraw() + 
  draw_label("Tracking development between 4-9y and adulthood (scored using adults' scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d3_all_scored_ad_plots_leg_title <- plot_grid(
  fig_d3_all_scored_ad_title, fig_d3_all_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r}
figure4.6 <- plot_grid(fig_d3_ad_plots_leg_title, 
                       fig_d3_79_scored_ad_plots_leg_title,
                       fig_d3_46_scored_ad_plots_leg_title, 
                       fig_d3_all_scored_ad_plots_leg_title,
                       ncol = 1)

figure4.6_cap <- add_sub(figure4.6, str_wrap("Figure 4.6: Relationships among US adults', older children's, and younger children's attributions of conceptual units in Study 3, scored using adults' BODY, HEART, and MIND scales (see Table 4.2). (A) Adults. (B) Older children (7-9y of age). (C) Younger children (4-6y of age). (D) A visualization of development between 4-9y and adulthood, using mean scores by character and age group. Plots are organized by sample (rows) and by pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. In panels A-C, individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.8}
ggdraw(figure4.6_cap)
```

```{r}
figure4.7_plots <- plot_grid(
  plot_d3_ad_scored_ad_diff +
    labs(title = "Study 3: Adults") +
    theme(legend.position = "none"),
  plot_d3_79_scored_ad_diff +
    labs(title = "Study 3: Children, 7-9y (scored using adults' scales)") +
    theme(legend.position = "none"),
  plot_d3_46_scored_ad_diff + 
    labs(title = "Study 3: Children, 4-6y (scored using adults' scales)") +
    theme(legend.position = "none"), 
  ncol = 3, rel_widths = c(1, 1, 1),
  labels = "AUTO")

figure4.7_plots_leg <- plot_grid(figure4.7_plots,
                                 get_legend(plot_d3_ad_scored_ad_diff),
                                 ncol = 1, rel_heights = c(1, 0.1))

figure4.7_cap <- add_sub(figure4.7_plots_leg, str_wrap("Figure 4.7: Difference scores between US adults' and children's attributions of conceptual units in Study 3. this includes difference scores using adults' BODY, HEART, and MIND scales (panel B) and difference scores using children's own scales (panel C; see Table 4.2). For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 180), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 8, fig.asp = 0.38}
ggdraw(figure4.7_cap)
```


# Study 4: A focus on early childhood (4-5y)

In Study 4, `r nrow(d4_ad_wide)/2` US adults and `r nrow(d4_46_wide)/2` US children between the ages of `r summary(d4_46$age)["Min."] %>% round(2)`-`r summary(d4_46$age)["Max."] %>% round(2)` years (median: `r summary(d4_46$age)["Median"] %>% round(2)`y) each assessed two target characters on 18 mental capacities. To make the study appropriate for children in this age range, this study employed a new set of 18 mental capacities (some but not all of which were used in Studies 1-3). In addition, participants were presented with a more child-friendly visual representation of the 3-point response scale ("no," coded as 0; "kinda," coded as 0.5, "yes," coded as 1). This study employed the "edge case" variant of the general approach, with participants assessing both a beetle or a robot in sequence (with order counterbalanced across participants). (See Chapter II for detailed methods.)

## Special notes on data processing and analysis

## Results

### Adults

#### Scale construction

```{r}
scales_efa_wdm_d4_ad <- scale_fun(efa_wdm_d4_ad, 
                                  factor_names = factor_names_efa_wdm_d4_ad)
d4_ad_scored_ad <- score_fun(d4_ad, scales_efa_wdm_d4_ad)

saveRDS(scales_efa_wdm_d4_ad, file = "./stored/scales/scales_efa_wdm_d4_ad")
saveRDS(d4_ad_scored_ad, file = "./stored/scored_data/d4_ad_scored_ad")
```

Following the steps described in "General analysis plan," above, yielded `r fact_name_fun(factor_names_efa_wdm_d4_ad)` scales of `r scales_efa_wdm_d4_ad %>% count(factor) %>% summarise(mean = mean(n)) %>% select(mean) %>% as.numeric()` items each; see Table 4.2.

#### Visualization

XX

```{r}
plots_d4_ad_scored_ad <- relviz_fun(d4_ad_scored_ad, colors = colors02)
```

```{r}
fig_d4_ad_plots <- plot_grid(plots_d4_ad_scored_ad[[1]] + 
                               theme(legend.position = "none"),
                             plots_d4_ad_scored_ad[[2]] + 
                               theme(legend.position = "none"),
                             plots_d4_ad_scored_ad[[3]] + 
                               theme(legend.position = "none"),
                             labels = c("A1", "A2", "A3"), ncol = 3)

fig_d4_ad_leg <- get_legend(
  plots_d4_ad_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal", 
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d4_ad_plots_leg <- plot_grid(fig_d4_ad_plots, fig_d4_ad_leg,
                                 ncol = 1, rel_heights = c(1, 0.05))

fig_d4_ad_title <- ggdraw() + 
  draw_label("Study 4: Adults", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d4_ad_plots_leg_title <- plot_grid(fig_d4_ad_title, fig_d4_ad_plots_leg,
                                       ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

XX

```{r}
d4_ad_scored_ad_diff <- diff_fun(d4_ad_scored_ad)
saveRDS(d4_ad_scored_ad_diff, "./stored/diffscore_data/d4_ad_scored_ad_diff")
```

```{r}
plot_d4_ad_scored_ad_diff <- diffplot_fun(d4_ad_scored_ad_diff, colors02)
```

```{r}
# r_d4_ad_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_ad_scored_ad_diff_BODY_HEART <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_ad_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d4_ad_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d4_ad_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_ad_scored_ad_diff_BODY_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_ad_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d4_ad_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d4_ad_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_ad_scored_ad_diff_HEART_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_ad_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_ad_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d4_ad_scored_ad_diff_HEART_MIND)
```

### Children (4-5y)

```{r}
d4_46_scored_ad <- score_fun(d4_46, scales_efa_wdm_d4_ad)
saveRDS(d4_46_scored_ad, file = "./stored/scored_data/d4_46_scored_ad")
```

#### Visualization

```{r}
plots_d4_46_scored_ad <- relviz_fun(d4_46_scored_ad, colors = colors02)
```

```{r}
fig_d4_46_scored_ad_plots <- plot_grid(plots_d4_46_scored_ad[[1]] + 
                                         theme(legend.position = "none"),
                                       plots_d4_46_scored_ad[[2]] + 
                                         theme(legend.position = "none"),
                                       plots_d4_46_scored_ad[[3]] + 
                                         theme(legend.position = "none"),
                                       labels = c("B1", "B2", "B3"), ncol = 3)

fig_d4_46_scored_ad_leg <- get_legend(
  plots_d4_46_scored_ad[[1]] +
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_fill_manual("Target character", values = colors02,
                      guide = guide_legend(title.position = "left",
                                           direction = "horizontal",
                                           ncol = 2)) +
    scale_color_manual("Target character", values = colors02,
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d4_46_scored_ad_plots_leg <- plot_grid(fig_d4_46_scored_ad_plots,
                                           fig_d4_46_scored_ad_leg,
                                           ncol = 1, rel_heights = c(1, 0.05))

fig_d4_46_scored_ad_title <- ggdraw() + 
  draw_label("Study 4: Children, 4-5y (scored using adults' scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d4_46_scored_ad_plots_leg_title <- plot_grid(
  fig_d4_46_scored_ad_title, fig_d4_46_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

#### Analysis of asymmetries

```{r}
d4_46_scored_ad_diff <- diff_fun(d4_46_scored_ad)
saveRDS(d4_46_scored_ad_diff, "./stored/diffscore_data/d4_46_scored_ad_diff")
```

```{r}
plot_d4_46_scored_ad_diff <- diffplot_fun(d4_46_scored_ad_diff, colors02)
```

```{r}
# r_d4_46_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_ad_diff_BODY_HEART <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_ad_diff %>% filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "BODY - HEART"))

summary(r_d4_46_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d4_46_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_ad_diff_BODY_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_ad_diff %>% filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "BODY - MIND"))

summary(r_d4_46_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d4_46_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_46_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | character) + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge))

r_d4_46_scored_ad_diff_HEART_MIND <- lmer(
  diff ~ 1 + character + (1 | subid),
  data = d4_46_scored_ad_diff %>% filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge))

# r_d4_46_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + (1 | subid),
#   data = d4_46_scored_ad_diff %>% filter(pair == "HEART - MIND"))

summary(r_d4_46_scored_ad_diff_HEART_MIND)
```

### Developmental comparison

```{r}
# r_d4_ad46_scored_ad_diff_BODY_HEART <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d4_ad_scored_ad_diff %>%
#     full_join(d4_46_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_ad46_scored_ad_diff_BODY_HEART <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d4_ad_scored_ad_diff %>%
#     full_join(d4_46_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp))

r_d4_ad46_scored_ad_diff_BODY_HEART <- lm(
  diff ~ 1 + character * age_group,
  data = d4_ad_scored_ad_diff %>% 
    full_join(d4_46_scored_ad_diff) %>%
    filter(pair == "BODY - HEART"),
  contrasts = list(character = contrasts_sum_edge,
                   age_group = contrasts_dum2_agegp))

# r_d4_ad46_scored_ad_diff_BODY_HEART <- lm(
#   diff ~ 1 + age_group,
#   data = d4_ad_scored_ad_diff %>%
#     full_join(d4_46_scored_ad_diff) %>%
#     filter(pair == "BODY - HEART"),
#   contrasts = list(age_group = contrasts_dum2_agegp))

summary(r_d4_ad46_scored_ad_diff_BODY_HEART)
```

```{r}
# r_d4_ad46_scored_ad_diff_BODY_MIND <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d4_ad_scored_ad_diff %>%
#     full_join(d4_46_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_ad46_scored_ad_diff_BODY_MIND <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d4_ad_scored_ad_diff %>%
#     full_join(d4_46_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp))

r_d4_ad46_scored_ad_diff_BODY_MIND <- lm(
  diff ~ 1 + character * age_group,
  data = d4_ad_scored_ad_diff %>% 
    full_join(d4_46_scored_ad_diff) %>%
    filter(pair == "BODY - MIND"),
  contrasts = list(character = contrasts_sum_edge,
                   age_group = contrasts_dum2_agegp))

# r_d4_ad46_scored_ad_diff_BODY_MIND <- lm(
#   diff ~ 1 + age_group,
#   data = d4_ad_scored_ad_diff %>%
#     full_join(d4_46_scored_ad_diff) %>%
#     filter(pair == "BODY - MIND"),
#   contrasts = list(age_group = contrasts_dum2_agegp))

summary(r_d4_ad46_scored_ad_diff_BODY_MIND)
```

```{r}
# r_d4_ad46_scored_ad_diff_HEART_MIND <- brm(
#   diff ~ 1 + age_group + (1 | character),
#   data = d4_ad_scored_ad_diff %>%
#     full_join(d4_46_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp),
#   cores = 4, control = list(adapt_delta = 0.999))

# r_d4_ad46_scored_ad_diff_HEART_MIND <- lmer(
#   diff ~ 1 + age_group + (1 | character),
#   data = d4_ad_scored_ad_diff %>%
#     full_join(d4_46_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(character = contrasts_sum_edge,
#                    age_group = contrasts_dum2_agegp))

r_d4_ad46_scored_ad_diff_HEART_MIND <- lm(
  diff ~ 1 + character * age_group,
  data = d4_ad_scored_ad_diff %>% 
    full_join(d4_46_scored_ad_diff) %>%
    filter(pair == "HEART - MIND"),
  contrasts = list(character = contrasts_sum_edge,
                   age_group = contrasts_dum2_agegp))

# r_d4_ad46_scored_ad_diff_HEART_MIND <- lm(
#   diff ~ 1 + age_group,
#   data = d4_ad_scored_ad_diff %>%
#     full_join(d4_46_scored_ad_diff) %>%
#     filter(pair == "HEART - MIND"),
#   contrasts = list(age_group = contrasts_dum2_agegp))

summary(r_d4_ad46_scored_ad_diff_HEART_MIND)
```

## Discussion

XX

```{r}
scales_study4 <- bind_rows(scales_efa_wdm_d4_ad %>% 
                             mutate(study = "Study 4: Adults")) %>%
  select(-c(loading, order)) %>%
  distinct() %>%
  spread(study, factor) %>%
  mutate(ur_factor = `Study 4: Adults`) %>%
  left_join(scales_efa_wdm_d4_ad %>% 
              select(capacity, order) %>% rename(order_ad = order)) %>%
  arrange(ur_factor, order_ad) %>%
  select(-ur_factor) #%>%
# select(-starts_with("order"))
```

```{r}
table4.2 <- scales_study2 %>% 
  mutate(capacity = case_when(
    grepl("sad", capacity) ~ "feel/get sad",
    grepl("scared", capacity) ~ "feel/get scared",
    grepl("hear", capacity) ~ "hear [sounds]",
    grepl("see", capacity) ~ "see [things]",
    grepl("hungry", capacity) ~ "get/feel hungry",
    grepl("sick", capacity) ~ "get/feel sick[...]",
    grepl("thoughts", capacity) | grepl("think", capacity) ~ "have thoughts/think",
    grepl("figure", capacity) ~ "figure out how to do things/figure things out",
    grepl("love" ,capacity) ~ "feel love/love someone",
    grepl("guilt", capacity) | grepl("sorry", capacity) ~ "feel guilty/sorry",
    TRUE ~ capacity)) %>%
  rename(order_ad_s2 = order_ad,
         order_79_s2 = order_79) %>%
  full_join(scales_study3 %>%
              mutate(capacity = case_when(
                grepl("sad", capacity) ~ "feel/get sad",
                grepl("scared", capacity) ~ "feel/get scared",
                grepl("hear", capacity) ~ "hear [sounds]",
                grepl("see", capacity) ~ "see [things]",
                grepl("hungry", capacity) ~ "get/feel hungry",
                grepl("sick", capacity) ~ "get/feel sick[...]",
                grepl("thoughts", capacity) | grepl("think", capacity) ~ "have thoughts/think",
                grepl("figure", capacity) ~ "figure out how to do things/figure things out",
                grepl("love", capacity) ~ "feel love/love someone",
                grepl("guilt", capacity) | grepl("sorry", capacity) ~ "feel guilty/sorry",
                TRUE ~ capacity)) %>%
              rename(order_ad_s3 = order_ad,
                     order_79_s3 = order_79)) %>%
  full_join(scales_study4 %>%
              mutate(capacity = case_when(
                grepl("sad", capacity) ~ "feel/get sad",
                grepl("scared", capacity) ~ "feel/get scared",
                grepl("hear", capacity) ~ "hear [sounds]",
                grepl("see", capacity) ~ "see [things]",
                grepl("hungry", capacity) ~ "get/feel hungry",
                grepl("sick", capacity) ~ "get/feel sick[...]",
                grepl("thoughts", capacity) | grepl("think", capacity) ~ "have thoughts/think",
                grepl("figure", capacity) ~ "figure out how to do things/figure things out",
                grepl("love", capacity) ~ "feel love/love someone",
                grepl("guilt", capacity) | grepl("sorry", capacity) ~ "feel guilty/sorry",
                TRUE ~ capacity)) %>%
              rename(order_ad_s4 = order_ad)) %>%
  mutate(ur_factor = case_when(
    !is.na(`Adults`) ~ `Adults`,
    !is.na(`Children, 7-9y`) ~ `Children, 7-9y`,
    !is.na(`Study 3: Adults`) ~ `Study 3: Adults`,
    !is.na(`Study 3: Children, 7-9y`) ~ `Study 3: Children, 7-9y`,
    !is.na(`Study 4: Adults`) ~ `Study 4: Adults`,
    TRUE ~ NA_integer_)) %>%
  mutate(ur_factor = factor(ur_factor, levels = c("BODY", "HEART", "MIND"))) %>%
  arrange(ur_factor, order_ad_s2, order_79_s2, order_ad_s3, order_ad_s4) %>%
  select(-ur_factor, -starts_with("order")) %>%
  mutate_at(vars(-capacity),
            funs(ifelse(is.na(.), "", "✓"))) %>%
  rename(Capacity = capacity,
         `Adults` = `Study 3: Adults`,
         `Children, 7-9y` = `Study 3: Children, 7-9y`,
         `Adults` = `Study 4: Adults`) %>%
  kable(format = "html",
        caption = "Table 4.2: Scales for each of the conceptual units (factors) identified by EFA for US Adults in Studies 2-4 and for 7- to 9-year-old childrenin Studies 2 and 3. (See Appendix B for alternative scales based on younger children's EFA results, for Studies 3 and 4.) A checkmark indicates that a mental capacity was included in a scale for a particular sample.") %>%
  kable_styling() %>%
  add_header_above(c(" " = 1,
                     "Study 2" = 2,
                     "Study 3" = 2,
                     "Study 4" = 1)) %>%
  group_rows("BODY scale", 1, 9) %>%
  group_rows("HEART scale", 10, 19) %>%
  group_rows("MIND scale", 20, 31)
```

```{r table4.2, include = T}
table4.2
```

```{r}
plots_agegp_d4_scored_ad <- relviz_agegp_fun(
  d_scored = d4_ad_scored_ad %>% 
    full_join(d4_46_scored_ad), 
  age_groups = c("children46", "adults"),
  age_group_labels = c("Children, (4-5y)", "Adults"),
  colors = colors02)
```

```{r}
fig_d4_all_scored_ad_plots <- plot_grid(plots_agegp_d4_scored_ad[[1]] + 
                                          theme(legend.position = "none"),
                                        plots_agegp_d4_scored_ad[[2]] + 
                                          theme(legend.position = "none"),
                                        plots_agegp_d4_scored_ad[[3]] + 
                                          theme(legend.position = "none"),
                                        labels = c("D1", "D2", "d4"), ncol = 3)

fig_d4_all_scored_ad_leg <- get_legend(
  plots_agegp_d4_scored_ad[[1]] + 
    theme(legend.position = "bottom", legend.direction = "horizontal") +
    scale_color_manual("Target character", values = colors02, na.translate = F, 
                       guide = guide_legend(title.position = "left",
                                            direction = "horizontal",
                                            ncol = 2)))

fig_d4_all_scored_ad_plots_leg <- plot_grid(fig_d4_all_scored_ad_plots,
                                            fig_d4_all_scored_ad_leg,
                                            ncol = 1, rel_heights = c(1, 0.05))

fig_d4_all_scored_ad_title <- ggdraw() + 
  draw_label("Tracking development between 4-5y and adulthood (scored using adults' scales)", size = 16, fontface = 'bold', x = 0, hjust = 0)

fig_d4_all_scored_ad_plots_leg_title <- plot_grid(
  fig_d4_all_scored_ad_title, fig_d4_all_scored_ad_plots_leg,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r}
figure4.8 <- plot_grid(fig_d4_ad_plots_leg_title, 
                       fig_d4_46_scored_ad_plots_leg_title,
                       fig_d4_all_scored_ad_plots_leg_title,
                       ncol = 1)

figure4.8_cap <- add_sub(figure4.8, str_wrap("Figure 4.8: Relationships among US adults' and children's attributions of conceptual units in Study 4, scored using adults' BODY, HEART, and MIND scales (see Table 4.2). (A) Adults. (B) Children (4-5y of age). (C) A visualization of development between 4-5y and adulthood, using mean scores by character and age group. Plots are organized by sample (rows) and by pair of conceptual units (columns). For each conceptual unit, scores could range from 0-1. In panels A-B, individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted.", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.4}
ggdraw(figure4.8_cap)
```

```{r}
figure4.9_plots <- plot_grid(
  plot_d4_ad_scored_ad_diff +
    labs(title = "Study 4: Adults") +
    theme(legend.position = "bottom"),
  plot_d4_46_scored_ad_diff + 
    labs(title = "Study 4: Children, 4-6y (scored using adults' scales)") +
    theme(legend.position = "bottom"), 
  ncol = 2, rel_widths = c(1, 1),
  labels = "AUTO")

figure4.9_cap <- add_sub(figure4.9_plots, str_wrap("Figure 4.9: Difference scores between US adults' and children's attributions of conceptual units in Study 4. For each conceptual unit, scores could range from 0-1, such that difference scores could range from -1 to +1. Individual participants are plotted as small, translucent circles, and mean difference scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. The dotted line corresponds to equal endorsements of the two conceptual units plotted (i.e., a difference score of 0).", 180), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 8, fig.asp = 0.38}
ggdraw(figure4.9_cap)
```


# General discussion

XX


# Chapter conclusion

In this chapter, I explored a second aspect of conceptual representations of mental life among US children and adults: The relationships among conceptual units. Studies 2-4 are consistent with the following theory: XX. 

As in Chapter III, I urge the reader to remember that this is not the only possible interpretation of the pattern of results presented here; additional studies—in particular, studies designed to test the hypothesis that XX— could provide converging evidence or could challenge this theoretical interpretation. Instead, the primary role of the re-analysis discussed here has been to inspire the hypothesis stated in the previous paragraph and to the foundation for future tests of this hypothesis, in turn refining a general theory of this aspect of conceptual development.  

In the next chapter, I apply the same exploratory spirit to the third and final aspect of conceptual representations of mental life: the application or deployment of these conceptual units in reasoning about various kinds of beings.


# TO DO

- implement overall plan
- study 1: adults for each sample = 4 regs total
- study 2: adults for each sample (2); children's for child sample (1); comparison (1) = 4 regs total
- study 3: adults for each sample (3); comparison (1) = 4 regs total
- study 4: adults for each sample (2); comparison (1) = 3 regs total 
- make regression tables
- study 1 (4 regs: studies 1a-1d)
- study 2 (3 regs: adult scales for adults, children; child scales)
- study 2 (1 reg: developmental comparison)
- study 3 (3 regs: adult scales for adults, older, young children)
- study 3 (1 reg: developmental comparison)
- study 4 (2 regs: adult scles for adults, children)
- study 4 (1 reg: developmental comparison)
- move to appendix
- study 2: adults' 4-factor solution for adults? for 7-9yo?
- study 3: 7-9yo for 7-9yo (1); 4-6yo for 4-6yo x 2 (2)
- study 4: 4-6yo for 4-6yo x 2 (2)
- reconsider adding to appendix
- study 3: 7-9yo for 4-6yo?
- all studies: comparisons across pairs of units (instead of separate regs for each unit)?




