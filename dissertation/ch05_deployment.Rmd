---
title: "Chapter V: Changes in deployment of the concept"
output:
  html_notebook:
    toc: yes
    toc_depth: 4
    toc_float: yes
always_allow_html: yes
---

```{r global_options, include = F}
knitr::opts_chunk$set(fig.width = 3, fig.asp = 0.67,
                      include = F, echo = F)
```

```{r}
# # for knitting to .docx
# output:
#   word_document:
#     reference_docx: "./word-styles-reference.docx"
# always_allow_html: yes

# # for knitting to .nb.html 
# output:
#   html_notebook:
#     toc: yes
#     toc_depth: 4
#     toc_float: yes
```

```{r}
# run ur-setup script (which runs other scripts)
source("./scripts/_SETUP.R")

# load in EFAs & names from Chapters III & IV
source("./scripts/stored_ch03.R")
source("./scripts/stored_ch04.R")
```


# Chapter overview

In this chapter, I focus on the third of my three key questions about the development of representations of mental life: _HowÂ do people of different ages deploy their conceptual representations of mental life to reason about specific entities in the world?_ As in Chapters III-IV, to address this question I draw on data from all of the current studies (Studies 1-4); for details about the methods of these studies, see Chapter II. The goal of this chapter is to provide "snapshots" of mental capacity attributions to various target characters in early childhood, middle childhood, and adulthood, and to explore in finer-grained detail more continuous changes in children's beliefs about the mental lives of these characters between 4-9y of age, with particular attention to children's assessment of animate vs. inanimate beings.


# General analysis plan

## High-level overview

In analyzing these datasets with an eye toward documenting the application or deployment of the conceptual representations described in Chapters III-IV, the basic insight is that the attribution of specific mental capacities to specific target characters provides evidence of how conceptual representations of mental life are deployed in everyday social cognition. In Chapter II, I illustrated this with the following example: If participants who assess the mental capacities of Characters 1, 2, and 3 share one general pattern of mental capacity attributions, and participants who assess the mental capacities of Characters 4, 5, and 6 share another pattern, this provides some evidence that conceptual representations of mental life might play a role in structuring representations of (and interactions with) different classes of beings in the world. Here I will translate this general intuition into a specific analysis plan to be applied to each of these datasets in turn. 

## Details of analyses

```{r}
anim_lookup <- data.frame(character = levels(scores_all$character)) %>%
  mutate(anim_inan = case_when(
    character %in% c("adult", "child", "infant", 
                     "person in a persistent vegetative state", 
                     "person in a PVS", "fetus", "chimpanzee", 
                     "elephant", "dolphin", "bear", "dog", "goat", 
                     "mouse", "frog", "blue jay", "bird", "fish", 
                     "beetle", "microbe") ~ "animate",
    character %in% c("robot", "computer", "car", "teddy bear", 
                     "doll", "stapler") ~ "inanimate",
    TRUE ~ NA_character_),
    anim_inan = factor(anim_inan, levels = c("animate", "inanimate")))
```

XX

# Study 1: An adult endpoint

In the context of this dissertation, Study 1 serves to describe a developmental endpoint for conceptual representations of mental life. In this chapter, I focus on what this study can reveal about how US adults use this concept to understand the beings in their world: Which aspects of mental life do they extend to which kinds of target characters? This topic was covered only very briefly in the original publication of this work (Weisman et al., 2017). 

To review, Studies 1a-1c employed the "edge case" variant of the general approach, with participants assessing the mental capacities of a beetle, a robot, or both. Studies 1a and 1b were identical: US adults (Study 1a: _n_=`r nrow(d1a_ad_wide)`; Study 1b: _n_=`r nrow(d1b_ad_wide)`) each assessed a single target character on 40 mental capacities. Study 1c employed very similar methods, with the exception that participants (_n_=`r nrow(d1c_ad_wide)/2`) each assessed _both_ target characters side by side (with left-right position counterbalanced across participants). Because these studies were so similar, in this chapter, I will discuss them in tandem.

Study 1d employed the "diverse characters" variant of the general approach, in which `r nrow(d1d_ad_wide)` US adults were randomly assigned to assess the same set of 40 mental capacities used in Studies 1a-1d for one of the following 21 target characters: an adult, a child, an infant, a person in a persistent vegetative state, a fetus, a chimpanzee, an elephant, a dolphin, a bear, a dog, a goat, a mouse, a frog, a blue jay, a fish, a beetle, a microbe, a robot, a computer, a car, or a stapler. (See Chapter II and Weisman et al., 2017, for detailed methods.)

## Results

### Studies 1a-1c

```{r}
plots_d1a <- character_multiplot(d1a_ad_scored_ad, 
                                 plot_labels = c("A1", "A2"))

plots_d1a_title <- plot_grid(
  ggdraw() + 
    draw_label("Study 1a: Adults", size = 16, 
               fontface = 'bold', x = 0, hjust = 0),
  plots_d1a,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r}
plots_d1b <- character_multiplot(d1b_ad_scored_ad, 
                                 plot_labels = c("B1", "B2"))

plots_d1b_title <- plot_grid(
  ggdraw() + 
    draw_label("Study 1b: Adults", size = 16, 
               fontface = 'bold', x = 0, hjust = 0),
  plots_d1b,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r}
plots_d1c <- character_multiplot(d1c_ad_scored_ad, 
                                 plot_labels = c("C1", "C2"))

plots_d1c_title <- plot_grid(
  ggdraw() + 
    draw_label("Study 1c: Adults", size = 16, 
               fontface = 'bold', x = 0, hjust = 0),
  plots_d1c,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 9, fig.asp = 0.4}
# interim plot for ease of writing
plot_grid(plots_d1a_title, plots_d1b_title, plots_d1c_title, ncol = 3)
```

### Study 1d

```{r}
plots_d1d <- character_multiplot(d1d_ad_scored_ad, show_anim_by_subj = T,
                                 plot_labels = c("D1", "D2", "D3"))

plots_d1d_title <- plot_grid(
  ggdraw() + 
    draw_label("Study 1d: Adults", size = 16, 
               fontface = 'bold', x = 0, hjust = 0),
  plots_d1d,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 9, fig.asp = 0.4}
# interim plot for ease of writing
plots_d1d_title
```

## Discussion

```{r}
figure5.1_plots <- plot_grid(
  plot_grid(plots_d1a_title, plots_d1b_title, plots_d1c_title, ncol = 3),
  plots_d1d_title, ncol = 1)
```

```{r}
figure5.1_plots_cap <- add_sub(figure5.1_plots, str_wrap("Figure 5.1: US adults' attributions of BODY, HEART, and MIND in (A) Study 1a, (B) Study 1b, (C) Study 1c, and (D) Study 1d. For each conceptual unit, scores could range from 0-1. Plots include scores by target character (panels A1, B1, C1, and D1), scores by animacy status (when not redundant with target character: panel D2), and distributions of scores (panels A2, B2, C2, and D3). Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals.", 205), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 9, fig.asp = 0.8}
ggdraw(figure5.1_plots_cap)
```


# Study 2: Conceptual change between middle childhood (7-9y) and adulthood

In the context of this dissertation, Study 2 serves to provide an initial investigation of representations of mental life earlier in development, in what I have called middle childhood (7-9y). In this chapter, I focus on what this study can reveal about changes in the deployment of this concept between middle childhood and adulthood: How do US 7- to 9-year-old children's attributions of BODY, HEART, and MIND compare to those of adults in their cultural context?

To review, in Study 2, `r nrow(d2_ad_wide)` US adults and `r nrow(d2_79_wide)` US children between the ages of `r summary(d2_79$age)["Min."] %>% round(2) %>% format(nsmall = 2)`-`r summary(d2_79$age)["Max."] %>% round(2) %>% format(nsmall = 2)` years (median: `r summary(d2_79$age)["Median"] %>% round(2) %>% format(nsmall = 2)`y) each assessed a single target character on 40 mental capacities. This study employed the "edge case" variant of the general approach, with participants randomly assigned to assess either a beetle or a robot. (See Chapter II for detailed methods.)

## Special notes on data processing and analysis

To facilitate comparison between children and adults in Study 2, I use adults' _BODY_, _HEART_, and _MIND_ scales (as described in Chapter IV) to analyze both age groups. For analyses using scales derived from EFA of children's own responses, see [XX Appendix C].

## Results

### Adults

```{r}
plots_d2_ad <- character_multiplot(d2_ad_scored_ad, 
                                   plot_labels = c("A1", "A2"))

plots_d2_ad_title <- plot_grid(
  ggdraw() + 
    draw_label("Study 2: Adults", size = 16, 
               fontface = 'bold', x = 0, hjust = 0),
  plots_d2_ad,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 4, fig.asp = 1}
# interim plot for ease of writing
plots_d2_ad_title
```

### Children (7-9y)

```{r}
plots_d2_79 <- character_multiplot(d2_79_scored_ad, 
                                   plot_labels = c("B1", "B2"))

plots_d2_79_title <- plot_grid(
  ggdraw() + 
    draw_label("Study 2: Children, 7-9y", size = 16, 
               fontface = 'bold', x = 0, hjust = 0),
  plots_d2_79,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 4, fig.asp = 1}
# interim plot for ease of writing
plots_d2_79_title
```

```{r}
figure5.2_plots <- plot_grid(plots_d2_ad_title, plots_d2_79_title, ncol = 2)
```

```{r}
figure5.2_plots_cap <- add_sub(figure5.2_plots, str_wrap("Figure 5.2: Attributions of BODY, HEART, and MIND among (A) adults and (B) 7- to 9-year-old children in Study 2. For each conceptual unit, scores could range from 0-1. Plots include scores by target character (panels A1 and B1) and distributions of scores (panels A2 and B2). Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals.", 135), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 6, fig.asp = 0.6}
ggdraw(figure5.2_plots_cap)
```

### Developmental comparison

#### Children vs. adults

```{r}
d2_79ad_scored_ad <- full_join(d2_ad_scored_ad, d2_79_scored_ad) %>%
  left_join(anim_lookup) %>%
  mutate(character = factor(character,
                            levels = levels(d2_ad_scored_ad$character)),
         age_group = factor(age_group))

contrasts(d2_79ad_scored_ad$character) <- contrasts_sum_edge
contrasts(d2_79ad_scored_ad$factor) <- contrasts_cnt3_factor
contrasts(d2_79ad_scored_ad$anim_inan) <- contrasts_sum2_anim
contrasts(d2_79ad_scored_ad$age_group) <- contrasts_dum2_agegp
```

```{r}
# r_d2_devgp_BODY <- brm(score ~ anim_inan * age_group,
#                           data = d2_79ad_scored_ad %>%
#                             filter(factor == "BODY"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d2_devgp_BODY, "./stored/brms_models/r_d2_devgp_BODY")

r_d2_devgp_BODY <- readRDS("./stored/brms_models/r_d2_devgp_BODY")

summary(r_d2_devgp_BODY)
```

```{r}
# r_d2_devgp_HEART <- brm(score ~ anim_inan * age_group,
#                           data = d2_79ad_scored_ad %>%
#                             filter(factor == "HEART"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d2_devgp_HEART, "./stored/brms_models/r_d2_devgp_HEART")

r_d2_devgp_HEART <- readRDS("./stored/brms_models/r_d2_devgp_HEART")

summary(r_d2_devgp_HEART)
```

```{r}
# r_d2_devgp_MIND <- brm(score ~ anim_inan * age_group,
#                           data = d2_79ad_scored_ad %>%
#                             filter(factor == "MIND"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d2_devgp_MIND, "./stored/brms_models/r_d2_devgp_MIND")

r_d2_devgp_MIND <- readRDS("./stored/brms_models/r_d2_devgp_MIND")

summary(r_d2_devgp_MIND)
```

```{r}
regtab_d2_devgp <- regtab_devgp_fun(
  reg_body = r_d2_devgp_BODY, 
  reg_heart = r_d2_devgp_HEART,
  reg_mind = r_d2_devgp_MIND,
  age_levels = c("age_group_child"), 
  age_labels = c("Children vs. adults"))
```

```{r}
table5.1 <- devgp_table_fun(regtab_devgp = regtab_d2_devgp, 
                            n_characters = 2, 
                            table_name = "Table 5.1", 
                            study_name = "Study 2", 
                            age_group = "7- to 9-year-old children", 
                            n_age_groups = 1,
                            char_compare_label = "Beetle vs. GM")
```

```{r, include = T}
table5.1
```

Children's _BODY_ scores were generally higher than adults' (see Table 5.1, "Children vs. adults" row for the BODY domain). This appears to have been particularly true for the robot (see Figure 5.2, top row); as a result, the difference between the beetle and the robot was attenuated among children, relative to adults (see Table 5.1, "Interaction" row for the BODY domain).

Children's _HEART_ scores were also higher than adults' (see Table 5.1, "Children vs. adults" row for the HEART domain, and Figure 5.2, middle row), but this difference did not vary substantially across target characters (see Table 5.1, "Interaction" row for the BODY domain).

There were no substantial differences between children and adults in their _MIND_ scores (see Table 5.1 and Figure 5.2, bottom row)

#### Age-related differences between 7-9y

```{r}
d2_79age_scored_ad <- d2_79_scored_ad %>%
  left_join(d2_79 %>% distinct(subid, age)) %>%
  left_join(anim_lookup) %>%
  filter(!is.na(age)) %>%
  mutate(character = factor(character,
                            levels = levels(d2_ad_scored_ad$character)),
         age_centered = scale(age, scale = F))

contrasts(d2_79age_scored_ad$character) <- contrasts_sum_edge
contrasts(d2_79age_scored_ad$factor) <- contrasts_cnt3_factor
contrasts(d2_79age_scored_ad$anim_inan) <- contrasts_sum2_anim
```

```{r}
# r_d2_devscore_BODY <- brm(score ~ anim_inan * age_centered,
#                           data = d2_79age_scored_ad %>%
#                             filter(factor == "BODY"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d2_devscore_BODY, "./stored/brms_models/r_d2_devscore_BODY")

r_d2_devscore_BODY <- readRDS("./stored/brms_models/r_d2_devscore_BODY")

summary(r_d2_devscore_BODY)
```

```{r}
# r_d2_devscore_HEART <- brm(score ~ anim_inan * age_centered,
#                           data = d2_79age_scored_ad %>%
#                             filter(factor == "HEART"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d2_devscore_HEART, "./stored/brms_models/r_d2_devscore_HEART")

r_d2_devscore_HEART <- readRDS("./stored/brms_models/r_d2_devscore_HEART")

summary(r_d2_devscore_HEART)
```

```{r}
# r_d2_devscore_MIND <- brm(score ~ anim_inan * age_centered,
#                           data = d2_79age_scored_ad %>%
#                             filter(factor == "MIND"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d2_devscore_MIND, "./stored/brms_models/r_d2_devscore_MIND")

r_d2_devscore_MIND <- readRDS("./stored/brms_models/r_d2_devscore_MIND")

summary(r_d2_devscore_MIND)
```

```{r}
regtab_d2_devscore <- regtab_devscore_fun(reg_body = r_d2_devscore_BODY,
                                          reg_heart = r_d2_devscore_HEART,
                                          reg_mind = r_d2_devscore_MIND)
```

```{r}
table5.2 <- devscore_table_fun(regtab_devscore = regtab_d2_devscore, 
                               n_characters = 2, 
                               table_name = "Table 5.2", 
                               study_name = "Study 2", 
                               age_range = "7- to 9-year-old children", 
                               mean_age = mean(d2_79$age, na.rm = T), 
                               char_compare_label = "Beetle vs. GM")
```

```{r, include = T}
table5.2
```

In line with an adult-like understanding of the animate-inanimate distinction, _BODY_ scores were generally higher among children who assessed the beetle (the animate target character) than among children who assessed the robot (the inanimate target character; see Table 5.2, "Beetle vs. GM" row for the BODY domain). With age, however, children's _BODY_ scores generally decreased (and Table 5.2, "Exact age" row for the BODY domain), driven by changes in children's attributions of BODY to the robot. As a result, the difference between the beetle and the robot increased over the age range (see Table 5.2, "Interaction" row for the BODY domain, and Figure 5.3, leftmost plot).

Children's _HEART_ scores did not differ reliably across the two target characters in this study (see Table 5.2, "Beetle vs. GM" row for the HEART domain). With age, children's _HEART_ scores for both characters generally decreased (and Table 5.2, "Exact age" and "Interaction" rows for the HEART domain, and Figure 5.3, center plot).

Finallyâin contrast to what one might expect if children attributed more mental life across the board to animate than inanimate objectsâ_MIND_ scores were generally higher among children who assessed the robot (the inanimate target character) than among children who assessed the beetle (the animate target character; see Table 5.2, "Beetle vs. GM" row for the MIND domain). Moreover, with age, children's _MIND_ scores for both characters generally increased (and Table 5.2, "Exact age" and "Interaction" rows for the MIND domain, and Figure 5.3, rightmost plot).

```{r}
plots_d2_dev <- character_devplot(df_scored_ad = d2_ad_scored_ad, 
                                  df_scored_ch = d2_79_scored_ad, 
                                  df_age = d2_79)
```

```{r}
figure5.3 <- plots_d2_dev +
  labs(title = "Study 2: Children, 7-9y")
```

```{r}
figure5.3_plots_cap <- add_sub(figure5.3, str_wrap("Figure 5.3: Changes in attributions of BODY, HEART, and MIND among 7- to 9-year-old children in Study 2. For each conceptual unit, scores could range from 0-1. Individual children are plotted as small, translucent circles; mean scores among adults are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. Lines correspond to simple linear regressions (formula: score ~ age).", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 0.5}
ggdraw(figure5.3_plots_cap)
```


## Discussion


# Study 3: Conceptual change over early and middle childhood (4-9y)

Study 3 builds on the investigation of middle childhood (7-9y) initiated in Study 2 and extends this exploration of conceptual change into earlier childhood (4-6y). In this chapter, I again focus on what this study can reveal about changes in the deployment of this conceptâi.e., the attribution of BODY, HEART, and MIND to various beings in the worldâover the course of early and middle childhood (7-9y).

To review, in Study 3, `r nrow(d3_ad_wide)` US adults, `r nrow(d3_79_wide)` "older" children (`r summary(d3_79$age)["Min."] %>% round(2) %>% format(nsmall = 2)`-`r summary(d3_79$age)["Max."] %>% round(2) %>% format(nsmall = 2)` years; median: `r summary(d3_79$age)["Median"] %>% round(2) %>% format(nsmall = 2)`y), and `r nrow(d3_46_wide)` "younger" children (`r summary(d3_46$age)["Min."] %>% round(2) %>% format(nsmall = 2)`-`r summary(d3_46$age)["Max."] %>% round(2) %>% format(nsmall = 2)` years; median: `r summary(d3_46$age)["Median"] %>% round(2) %>% format(nsmall = 2)`y) each assessed a single target character on 20 mental capacities. This study employed the "diverse characters" variant of the general approach, with participants randomly or pseudo-randomly assigned to assess one of the following 9 characters: an elephant, a goat, a mouse, a bird, a beetle, a teddy bear, a doll, a robot, or a computer. (See Chapter II for detailed methods.)

## Special notes on data processing and analysis

As in Study 2, to facilitate comparison between the three age groups included in Study 3, I use adults' _BODY_, _HEART_, and _MIND_ scales (as described in Chapter IV) to analyze both age groups. For analyses using scales derived from EFA of children's own responses, see [XX Appendix C].

## Results

### Adults

```{r}
plots_d3_ad <- character_multiplot(d3_ad_scored_ad, show_anim_by_subj = T,
                                   plot_labels = c("A1", "A2"))

plots_d3_ad_title <- plot_grid(
  ggdraw() + 
    draw_label("Study 3: Adults", size = 16, 
               fontface = 'bold', x = 0, hjust = 0),
  plots_d3_ad,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 5, fig.asp = 0.6}
# interim plot for ease of writing
plots_d3_ad_title
```

### Children (7-9y)

```{r}
plots_d3_79 <- character_multiplot(d3_79_scored_ad, show_anim_by_subj = T,
                                   plot_labels = c("B1", "B2"))

plots_d3_79_title <- plot_grid(
  ggdraw() + 
    draw_label("Study 3: Children, 7-9y", size = 16, 
               fontface = 'bold', x = 0, hjust = 0),
  plots_d3_79,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 5, fig.asp = 0.6}
# interim plot for ease of writing
plots_d3_79_title
```

### Children (4-6y)

```{r}
plots_d3_46 <- character_multiplot(d3_46_scored_ad, show_anim_by_subj = T,
                                   plot_labels = c("C1", "C2"))

plots_d3_46_title <- plot_grid(
  ggdraw() + 
    draw_label("Study 3: Children, 4-6y", size = 16, 
               fontface = 'bold', x = 0, hjust = 0),
  plots_d3_46,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 5, fig.asp = 0.6}
# interim plot for ease of writing
plots_d3_46_title
```

```{r}
figure5.4_plots <- plot_grid(plots_d3_ad_title, 
                             plots_d3_79_title,
                             plots_d3_46_title,
                             ncol = 1)
```

```{r}
figure5.4_plots_cap <- add_sub(figure5.4_plots, str_wrap("Figure 5.4: Attributions of BODY, HEART, and MIND among (A) adults, (B) 7- to 9-year-old children, and (C) 4- to 6-year-old children in Study 3. For each conceptual unit, scores could range from 0-1. Plots include scores by target character (panels A1, B1, and C1), scores by animacy status (A2, B2, and C2), and distributions of scores (panels A3, B3, and C3). Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals.", 115), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1.7}
ggdraw(figure5.4_plots_cap)
```

### Developmental comparison

#### Children vs. adults

```{r}
d3_4679ad_scored_ad <- full_join(d3_ad_scored_ad, d3_79_scored_ad) %>%
  full_join(d3_46_scored_ad) %>%
  left_join(anim_lookup) %>%
  mutate(character = factor(character,
                            levels = levels(d3_ad_scored_ad$character)),
         age_group = factor(age_group))

contrasts(d3_4679ad_scored_ad$character) <- contrasts_sum_dv09
contrasts(d3_4679ad_scored_ad$factor) <- contrasts_cnt3_factor
contrasts(d3_4679ad_scored_ad$anim_inan) <- contrasts_sum2_anim
contrasts(d3_4679ad_scored_ad$age_group) <- contrasts_dum3_agegp
```

```{r}
# r_d3_devgp_BODY <- brm(score ~ anim_inan * age_group,
#                           data = d3_4679ad_scored_ad %>%
#                             filter(factor == "BODY"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d3_devgp_BODY, "./stored/brms_models/r_d3_devgp_BODY")

r_d3_devgp_BODY <- readRDS("./stored/brms_models/r_d3_devgp_BODY")

summary(r_d3_devgp_BODY)
```

```{r}
# r_d3_devgp_HEART <- brm(score ~ anim_inan * age_group,
#                           data = d3_4679ad_scored_ad %>%
#                             filter(factor == "HEART"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d3_devgp_HEART, "./stored/brms_models/r_d3_devgp_HEART")

r_d3_devgp_HEART <- readRDS("./stored/brms_models/r_d3_devgp_HEART")

summary(r_d3_devgp_HEART)
```

```{r}
# r_d3_devgp_MIND <- brm(score ~ anim_inan * age_group,
#                           data = d3_4679ad_scored_ad %>%
#                             filter(factor == "MIND"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d3_devgp_MIND, "./stored/brms_models/r_d3_devgp_MIND")

r_d3_devgp_MIND <- readRDS("./stored/brms_models/r_d3_devgp_MIND")

summary(r_d3_devgp_MIND)
```

```{r}
regtab_d3_devgp <- regtab_devgp_fun(
  reg_body = r_d3_devgp_BODY, 
  reg_heart = r_d3_devgp_HEART,
  reg_mind = r_d3_devgp_MIND,
  age_levels = c("age_group_old", "age_group_yng"), 
  age_labels = c("Older children (7-9y) vs. adults",
                 "Younger children (4-6y) vs. adults"))
```

```{r}
table5.3 <- devgp_table_fun(regtab_devgp = regtab_d3_devgp, 
                            n_characters = 2, 
                            table_name = "Table 5.3", 
                            study_name = "Study 3", 
                            age_group = "4- to 9-year-old children",
                            n_age_groups = , 
                            char_compare_label = "Animate characters vs. GM")
```

```{r, include = T}
table5.3
```

Neither older nor younger children's _BODY_ scores were generally higher than adults' (see Table 5.3, "Older children vs. adults" and "Younger children vs. adults" rows for the BODY domain), but in both groups of children the difference in _BODY_ scores between animate vs. inanimate characters was attenuated, relative to adults (see Table 5.3, "Interaction" row for the BODY domain).

In the _HEART_ domain, both older and younger children's _HEART_ scores were generally higher than adults' (see Table 5.3, "Children vs. adults" row for the HEART domain, and Figure 5.4, middle row), but this difference did not vary substantially across target characters (see Table 5.3, "Interaction" row for the BODY domain).

Finally, in the _MIND_ domain, younger children's (but not older children's) _MIND_ scores were substantially lower than adults' (see Table 5.3, "Older children vs. adults" and "Younger children vs. adults" rows for the MIND domain). In addition, in both groups of children the difference in _MIND_ scores between animate vs. inanimate characters was attenuated, relative to adults (see Table 5.3, "Interaction" row for the MIND domain).

#### Age-related differences between 4-9y

```{r}
d3_4679_scored_ad <- full_join(d3_79_scored_ad %>% 
                                 mutate(subid = paste0(subid, "_79")),
                               d3_46_scored_ad %>%
                                 mutate(subid = paste0(subid, "_46"))) %>%
  left_join(full_join(d3_79 %>% mutate(subid = paste0(subid, "_79")),
                      d3_46 %>% mutate(subid = paste0(subid, "_46"))) %>%
              distinct(subid, age)) %>%
  left_join(anim_lookup) %>%
  filter(!is.na(age)) %>%
  mutate(character = factor(character,
                            levels = levels(d3_ad_scored_ad$character)),
         age_centered = scale(age, scale = F))

contrasts(d3_4679_scored_ad$character) <- contrasts_sum_dv09
contrasts(d3_4679_scored_ad$factor) <- contrasts_cnt3_factor
contrasts(d3_4679_scored_ad$anim_inan) <- contrasts_sum2_anim
```

```{r}
# r_d3_devscore_BODY <- brm(score ~ anim_inan * age_centered +
#                             (1 | character),
#                           data = d3_4679_scored_ad %>%
#                             filter(factor == "BODY"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d3_devscore_BODY, "./stored/brms_models/r_d3_devscore_BODY")

r_d3_devscore_BODY <- readRDS("./stored/brms_models/r_d3_devscore_BODY")

summary(r_d3_devscore_BODY)
```

```{r}
# r_d3_devscore_HEART <- brm(score ~ anim_inan * age_centered +
#                             (1 | character),
#                           data = d3_4679_scored_ad %>%
#                             filter(factor == "HEART"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d3_devscore_HEART, "./stored/brms_models/r_d3_devscore_HEART")

r_d3_devscore_HEART <- readRDS("./stored/brms_models/r_d3_devscore_HEART")

summary(r_d3_devscore_HEART)
```

```{r}
# r_d3_devscore_MIND <- brm(score ~ anim_inan * age_centered +
#                             (1 | character),
#                           data = d3_4679_scored_ad %>%
#                             filter(factor == "MIND"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d3_devscore_MIND, "./stored/brms_models/r_d3_devscore_MIND")

r_d3_devscore_MIND <- readRDS("./stored/brms_models/r_d3_devscore_MIND")

summary(r_d3_devscore_MIND)
```

```{r}
regtab_d3_devscore <- regtab_devscore_fun(reg_body = r_d3_devscore_BODY,
                                          reg_heart = r_d3_devscore_HEART,
                                          reg_mind = r_d3_devscore_MIND)
```

```{r}
table5.4 <- devscore_table_fun(regtab_devscore = regtab_d3_devscore, 
                               n_characters = 9, 
                               table_name = "Table 5.4", 
                               study_name = "Study 3", 
                               age_range = "4- to 9-year-old children", 
                               mean_age = mean(d3_4679_scored_ad$age, 
                                               na.rm = T), 
                               char_compare_label = "Animate characters vs. GM")
```

```{r, include = T}
table5.4
```

In line with an adult-like understanding of the animate-inanimate distinction, _BODY_ scores were generally higher among children who assessed one of the animate target characters (elephant, goat, mouse, bird, or beetle) than among children who assessed one of the inanimate target characters (teddy bear, doll, robot, or computer; see Table 5.4, "Animate characters vs. GM" row for the BODY domain). There were no overall differences in _BODY_ scores over the age range (see Table 5.4, "Exact age" row for the BODY domain), but this difference between animate and inanimate characters increased with age (see Table 5.4, "Interaction" row for the BODY domain, and Figure 5.5, panel B, leftmost plot). Visual inspection of Figure 5.5, panel A, suggests that these general trends held true for all animate vs. inanimate target characters.

As in the BODY domain, _HEART_ scores were generally higher among children who assessed one of the animate target characters than among those who assessed one of the inanimate target characters (see Table 5.4, "Animate characters vs. GM" row for the HEART domain). This analysis revealed no substantial age-related changes in children's _HEART_ scores (see Table 5.4, "Exact age" and "Interaction" rows for the HEART domain,, and Figure 5.5, panel B, center plot). Visual inspection of Figure 5.5, panel A, suggests that this may reflect variability across specific target characters: For some characters (most notably, the robot) attributions of HEART appeared to increase over this age range (4-9y), while for other characters (most notably, the beetle, the doll, and the computer) attributions appeared to decrease; for many of the target characters included in this study there appeared to be no systematic age-related differences in attributions of HEART.

Finally, as in the BODY and MIND domains, _MIND_ scores were generally higher among children who assessed one of the animate target characters than among those who assessed one of the inanimate target characters (see Table 5.4, "Beetle vs. GM" row for the MIND domain). With age, children's _MIND_ scores generally increased (see Table 5.4, "Exact age" row for the MIND domain). The difference betwen animate and inanimate characters in _MIND_ scores did not vary substantially with age (see Table 5.4, "Interaction" row for the MIND domain, and Figure 5.5, panel B, rightmost plot). However, visual inspection of Figure 5.5, panel A, suggests that there were two target characters for whom attributions of MIND did _NOT_ increase with ageânamely, the two inert toys (the teddy bear and the doll). Interestingly, this plot suggests that the two technologies (the robot and the computer) appear to be among the characters for whom age-related changes in attributions of MIND may have been most dramaticâbut this general trend of increasing attributions of MIND also appears to have applied to all of the animate characters.

```{r}
plots_d3_dev_char <- character_devplot(
  df_scored_ad = d3_ad_scored_ad, 
  df_scored_ch = full_join(d3_79_scored_ad %>% 
                             mutate(subid = paste0(subid, "_79")),
                           d3_46_scored_ad %>%
                             mutate(subid = paste0(subid, "_46"))), 
  df_age = full_join(d3_79 %>%
                       mutate(subid = paste0(subid, "_79")),
                     d3_46 %>%
                       mutate(subid = paste0(subid, "_46"))))
```

```{r}
plots_d3_dev_anim <- character_devplot(
  df_scored_ad = d3_ad_scored_ad %>%
    left_join(anim_lookup) %>%
    mutate(character = anim_inan), 
  df_scored_ch = full_join(d3_79_scored_ad %>% 
                             mutate(subid = paste0(subid, "_79")),
                           d3_46_scored_ad %>%
                             mutate(subid = paste0(subid, "_46"))) %>%
    left_join(anim_lookup) %>%
    mutate(character = anim_inan), 
  df_age = full_join(d3_79 %>%
                       mutate(subid = paste0(subid, "_79")),
                     d3_46 %>%
                       mutate(subid = paste0(subid, "_46"))))
```

```{r}
figure5.5_char <- plots_d3_dev_char +
  labs(title = "Study 3: Children, 4-9y (by target character)")

figure5.5_anim <- plots_d3_dev_anim +
  labs(title = "Study 3: Children, 4-9y (by animacy status)") +
  scale_color_manual("Animacy status", values = colorsAI,
                     guide = guide_legend(direction = "horizontal",
                                          override.aes = list(alpha = 1))) +
  scale_fill_manual("Animacy status", values = colorsAI,
                    guide = guide_legend(direction = "horizontal",
                                         override.aes = list(alpha = 1)))

figure5.5_plots <- plot_grid(figure5.5_char, figure5.5_anim, 
                             ncol = 1, labels = "AUTO")
```

```{r}
figure5.5_plots_cap <- add_sub(figure5.5_plots, str_wrap("Figure 5.5: Changes in attributions of BODY, HEART, and MIND among 4- to 9-year-old children in Study 3. For each conceptual unit, scores could range from 0-1. Individual children are plotted as small, translucent circles; mean scores among adults are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. Lines correspond to simple linear regressions (formula: score ~ age).", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 1}
ggdraw(figure5.5_plots_cap)
```

## Discussion


# Study 4: A focus on early childhood (4-5y)

Study 4 builds on Study 3 by providing a targeted investigation of representations of mental life in the preschool years (4-5y). In this chapter, I again focus on what this study can reveal about attributions of BODY, HEART, and MIND at the earliest point in development that I have examined so far, and compare the deployment of this concept among young children vs. adults. 

To review, in Study 4, `r nrow(d4_ad_wide)/2` US adults and `r nrow(d4_46_wide)/2` US children between the ages of `r summary(d4_46$age)["Min."] %>% round(2) %>% format(nsmall = 2)`-`r summary(d4_46$age)["Max."] %>% round(2) %>% format(nsmall = 2)` years (median: `r summary(d4_46$age)["Median"] %>% round(2) %>% format(nsmall = 2)`y) each assessed two target characters on 18 mental capacities, with all aspects of the experimental design tailored to be appropriate for this youngest age group. This study employed the "edge case" variant of the general approach, with participants assessing both a beetle or a robot in sequence (with order counterbalanced across participants). (See Chapter II for detailed methods.)

## Special notes on data processing and analysis

As in Studies 2 and 3, to facilitate comparison between children and adults in Study 4, I use adults' _BODY_, _HEART_, and _MIND_ scales (as described in Chapter IV) to analyze both age groups. For analyses using scales derived from EFA of children's own responses, see [XX Appendix C].

## Results

### Adults

```{r}
plots_d4_ad <- character_multiplot(d4_ad_scored_ad, bin_width = 1/10,
                                   plot_labels = c("A1", "A2"))

plots_d4_ad_title <- plot_grid(
  ggdraw() + 
    draw_label("Study 4: Adults", size = 16, 
               fontface = 'bold', x = 0, hjust = 0),
  plots_d4_ad,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 4, fig.asp = 1}
# interim plot for ease of writing
plots_d4_ad_title
```

### Children (4-5y)

```{r}
plots_d4_46 <- character_multiplot(d4_46_scored_ad, bin_width = 1/10,
                                   plot_labels = c("B1", "B2"))

plots_d4_46_title <- plot_grid(
  ggdraw() + 
    draw_label("Study 4: Children, 4-5y", size = 16, 
               fontface = 'bold', x = 0, hjust = 0),
  plots_d4_46,
  ncol = 1, rel_heights = c(0.12, 1))
```

```{r, fig.width = 4, fig.asp = 1}
# interim plot for ease of writing
plots_d4_46_title
```

```{r}
figure5.6_plots <- plot_grid(plots_d4_ad_title, plots_d4_46_title,
                             ncol = 2)
```

```{r}
figure5.6_plots_cap <- add_sub(figure5.6_plots, str_wrap("Figure 5.6: Attributions of BODY, HEART, and MIND among (A) adults and (B) 4- to 5-year-old children in Study 4. For each conceptual unit, scores could range from 0-1. Plots include scores by target character (panels A1 and B1) and distributions of scores (panels A2 and B2). Individual participants are plotted as small, translucent circles, and mean scores by character are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals.", 135), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 6, fig.asp = 0.6}
ggdraw(figure5.6_plots_cap)
```

### Developmental comparison

#### Children vs. adults

```{r}
d4_46ad_scored_ad <- full_join(d4_ad_scored_ad, d4_46_scored_ad) %>%
  left_join(anim_lookup) %>%
  mutate(character = factor(character,
                            levels = levels(d4_ad_scored_ad$character)),
         age_group = factor(age_group))

contrasts(d4_46ad_scored_ad$character) <- contrasts_sum_edge
contrasts(d4_46ad_scored_ad$factor) <- contrasts_cnt3_factor
contrasts(d4_46ad_scored_ad$anim_inan) <- contrasts_sum2_anim
contrasts(d4_46ad_scored_ad$age_group) <- contrasts_dum2_agegp
```

```{r}
# r_d4_devgp_BODY <- brm(score ~ anim_inan * age_group,
#                           data = d4_46ad_scored_ad %>%
#                             filter(factor == "BODY"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d4_devgp_BODY, "./stored/brms_models/r_d4_devgp_BODY")

r_d4_devgp_BODY <- readRDS("./stored/brms_models/r_d4_devgp_BODY")

summary(r_d4_devgp_BODY)
```

```{r}
# r_d4_devgp_HEART <- brm(score ~ anim_inan * age_group,
#                           data = d4_46ad_scored_ad %>%
#                             filter(factor == "HEART"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d4_devgp_HEART, "./stored/brms_models/r_d4_devgp_HEART")

r_d4_devgp_HEART <- readRDS("./stored/brms_models/r_d4_devgp_HEART")

summary(r_d4_devgp_HEART)
```

```{r}
# r_d4_devgp_MIND <- brm(score ~ anim_inan * age_group,
#                           data = d4_46ad_scored_ad %>%
#                             filter(factor == "MIND"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d4_devgp_MIND, "./stored/brms_models/r_d4_devgp_MIND")

r_d4_devgp_MIND <- readRDS("./stored/brms_models/r_d4_devgp_MIND")

summary(r_d4_devgp_MIND)
```

```{r}
regtab_d4_devgp <- regtab_devgp_fun(
  reg_body = r_d4_devgp_BODY, 
  reg_heart = r_d4_devgp_HEART,
  reg_mind = r_d4_devgp_MIND,
  age_levels = c("age_group_child"), 
  age_labels = c("Children vs. adults"))
```

```{r}
table5.5 <- devgp_table_fun(regtab_devgp = regtab_d4_devgp, 
                            n_characters = 2, 
                            table_name = "Table 5.5", 
                            study_name = "Study 4", 
                            age_group = "4- to 5-year-old children", 
                            n_age_groups = 1,
                            char_compare_label = "Beetle vs. GM")
```

```{r, include = T}
table5.5
```

The age comparison between 4- to 5-year-old children and adults in Study 4 yielded remarkably similar results to the parallel comparison between 7- to 9-year-old children and adults in Study 2. 

As in Study 2, children's _BODY_ scores were generally higher than adults' (see Table 5.5, "Children vs. adults" row for the BODY domain). This appears to have been particularly true for the robot (see Figure 5.6, top row); as a result, the difference between the beetle and the robot was attenuated among children, relative to adults (see Table 5.5, "Interaction" row for the BODY domain).

Again, as in Study 2, children's _HEART_ scores were also higher than adults' (see Table 5.5, "Children vs. adults" row for the HEART domain, and Figure 5.6, middle row). In Study 4, this difference between children and adults was slightly more pronounced for the robot than the beetle (see Table 5.5, "Interaction" row for the BODY domain).

And yet again, as in Study 2, there were no substantial differences between children and adults in their _MIND_ scores (see Table 5.5 and Figure 5.6, bottom row)

#### Age-related differences between 4-5y

```{r}
d4_46age_scored_ad <- d4_46_scored_ad %>%
  left_join(d4_46 %>% distinct(subid, age)) %>%
  left_join(anim_lookup) %>%
  filter(!is.na(age)) %>%
  mutate(character = factor(character,
                            levels = levels(d4_ad_scored_ad$character)),
         age_centered = scale(age, scale = F))

contrasts(d4_46age_scored_ad$character) <- contrasts_sum_edge
contrasts(d4_46age_scored_ad$factor) <- contrasts_cnt3_factor
contrasts(d4_46age_scored_ad$anim_inan) <- contrasts_sum2_anim
```

```{r}
# r_d4_devscore_BODY <- brm(score ~ anim_inan * age_centered + (1 | subid),
#                           data = d4_46age_scored_ad %>%
#                             filter(factor == "BODY"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d4_devscore_BODY, "./stored/brms_models/r_d4_devscore_BODY")

r_d4_devscore_BODY <- readRDS("./stored/brms_models/r_d4_devscore_BODY")

summary(r_d4_devscore_BODY)
```

```{r}
# r_d4_devscore_HEART <- brm(score ~ anim_inan * age_centered + (1 | subid),
#                           data = d4_46age_scored_ad %>%
#                             filter(factor == "HEART"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d4_devscore_HEART, "./stored/brms_models/r_d4_devscore_HEART")

r_d4_devscore_HEART <- readRDS("./stored/brms_models/r_d4_devscore_HEART")

summary(r_d4_devscore_HEART)
```

```{r}
# r_d4_devscore_MIND <- brm(score ~ anim_inan * age_centered + (1 | subid),
#                           data = d4_46age_scored_ad %>%
#                             filter(factor == "MIND"),
#                           cores = 4, control = list(adapt_delta = 0.99))
# 
# saveRDS(r_d4_devscore_MIND, "./stored/brms_models/r_d4_devscore_MIND")

r_d4_devscore_MIND <- readRDS("./stored/brms_models/r_d4_devscore_MIND")

summary(r_d4_devscore_MIND)
```

```{r}
regtab_d4_devscore <- regtab_devscore_fun(reg_body = r_d4_devscore_BODY,
                                          reg_heart = r_d4_devscore_HEART,
                                          reg_mind = r_d4_devscore_MIND)
```

```{r}
table5.6 <- devscore_table_fun(regtab_devscore = regtab_d4_devscore, 
                               n_characters = 2, 
                               table_name = "Table 5.6", 
                               study_name = "Study 4", 
                               age_range = "4- to 5-year-old children", 
                               mean_age = mean(d4_46$age, na.rm = T), 
                               char_compare_label = "Beetle vs. GM",
                               ranef_subid = T)
```

```{r, include = T}
table5.6
```

Echoing the results of Studies 2 and 3, _BODY_ scores were generally higher among children who assessed the beetle (the animate target character) than among children who assessed the robot (the inanimate target character; see Table 5.6, "Beetle vs. GM" row for the BODY domain)âbut this difference increased over the age range (see Table 5.6, "Interaction" row for the BODY domain, and Figure 5.7, leftmost plot). Interestingly, visual inspection of Figure 5.7 suggests that this was driven by increasing attributions of BODY to the beetle, rather than decreasing attributions to the robotâthe reverse of what one might predict if preschool-age children were displaying an "animist" tendency in their mental capacity attributions.

In both the HEART and MIND domains, children's scores did not differ reliably across the two target characters in this study (see Table 5.6, "Beetle vs. GM" row for the HEART and MIND domains), and did not vary reliably over the age range (see Table 5.6, "Exact age" and "Interaction" rows for the HEART and MIND domains, and Figure 5.7, center and rightmost plots).

```{r}
plots_d4_dev <- character_devplot(df_scored_ad = d4_ad_scored_ad, 
                                  df_scored_ch = d4_46_scored_ad, 
                                  df_age = d4_46)
```

```{r}
figure5.7 <- plots_d4_dev +
  labs(title = "Study 4: Children, 4-5y")
```

```{r}
figure5.7_plots_cap <- add_sub(figure5.7, str_wrap("Figure 5.7: Changes in attributions of BODY, HEART, and MIND among 4- to 5-year-old children in Study 4. For each conceptual unit, scores could range from 0-1. Individual children are plotted as small, translucent circles; mean scores among adults are plotted as larger, solid diamonds. Error bars are 95% bootstrapped confidence intervals. Lines correspond to simple linear regressions (formula: score ~ age).", 110), x = 0, hjust = 0)
```

```{r, include = T, fig.width = 5, fig.asp = 0.5}
ggdraw(figure5.7_plots_cap)
```

## Discussion


# General discussion


# Chapter conclusion









# SCRAPS

## Documenting the application or deployment of conceptual representations through XX

[XX CORRECT TO BE NOT ABOUT FACTOR SCORES! change from factor scores to endorsements. Factor scores don't give a sense of absolutely yes/no.]

Having inferred a conceptual structure for a given group of participants via EFA, I then sought to examine attributions of mental capacities to the particular target characters included in each study within this conceptual structure: To what extent did participants attribute each of the fundamental components of mental life revealed by EFA to a given target character, and how did this attributions vary with age (either within an age group or between age groups)? 

To explore this question, for each study I projected children's data into adults' conceptual space and examined "factor scores"âsummaries of each participant's attributions of each of factors revealed by EFA. I used the correlation-preserving "ten Berge" method (as implemented in the "psych" package; Revelle, 2018), imputing missing values using the mean (by target character, capacity, and age group). This yielded one factor score for each of (adults') factors, for each participant. I consider these to be summaries of that person's attributions of the corresponding latent construct.

I analyzed these factor scores via mixed effects Bayesian regression analyses using the "brms" package for R (BÃ¼rkner, 2017). In all of these analyses, I included the maximal random effect structures given the design for the relevant study. Further details varied by study, depending on the number of target characters included in that study, the number of factors revealed by EFA for the relevant group(s) of participants, and the goals of the analysis (e.g., comparing two age groups vs. examining continuous effects of age within one or more groups of participants).
