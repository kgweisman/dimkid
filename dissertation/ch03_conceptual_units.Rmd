---
title: "Chapter III: Changes in conceptual units"
output:
  html_notebook:
    toc: yes
    toc_depth: 4
    toc_float: yes
always_allow_html: yes
---

```{r global_options, include = F}
knitr::opts_chunk$set(fig.width = 3, fig.asp = 0.67,
                      include = F, echo = F)
```

```{r}
# # for knitting to .docx
# output:
#   word_document:
#     reference_docx: "./word-styles-reference.docx"
# always_allow_html: yes
   
# # for knitting to .nb.html 
# output:
#   html_notebook:
#     toc: yes
#     toc_depth: 4
#     toc_float: yes
```

```{r}
set.seed(12345)

# packages
source("./scripts/libraries.R")

# supporting functions
source("./scripts/efa_param.R")
source("./scripts/max_factors_efa.R")
source("./scripts/reten_fun.R")
source("./scripts/plot_fun.R")
source("./scripts/efa_fun.R")
source("./scripts/ms_fun.R")

# data scripts
source("./scripts/data_s1.R")
source("./scripts/data_s2_ad.R")
source("./scripts/data_s2_79.R")
source("./scripts/data_s3_ad.R")
source("./scripts/data_s3_79.R")
source("./scripts/data_s3_46.R")
source("./scripts/data_s4_ad.R")
source("./scripts/data_s4_46.R")
```


# Chapter overview

In this chapter, I focus on the first of my three key questions about the development of representations of mental life: _What are the components, or "conceptual units," that anchor representations of mental life at different points in development?_ As described in Chapter II, to address this question I draw on data from all of the current studies (Studies 1-4); for details about the methods of these studies, see Chapter II. The goal of this chapter is to provide "snapshots" of the sets of conceptual units available to participants in early childhood, middle childhood, and adulthood. 

(Note that this was the primary planned analysis for all of the studies included in this dissertation; see, e.g., Weisman et al., 2017.)


# General analysis plan

## High-level overview

In analyzing these datasets with an eye toward identifying "conceptual units," the basic insight is that tracking the covariance of mental capacity attributions provides a way of discovering suites of mental capacities that "hang together" in reasoning about mental life, and that these suites of mental capacities might correspond to the units of some larger conceptual representation of this general domain. To borrow an example from Chapter II: If participants who endorse Capacity X also tend to endorse Capacities Y and Z, this provides some evidence that Capacities X, Y, and Z consitute a suite of mental capacities that are closely associated with the same underlying "conceptual unit." 

In other words, my goal in the current chapter is to uncover a set of latent constructs—"conceptual units"—that could have given rise to the correlations among mental capacity attributions as observed in a given group of participants. A canonical way to identify latent constructs via observed correlations is exploratory factor analysis (EFA), a form of dimensionality reduction that posits that the observed variables in a given dataset are related, to varying degrees, to a smaller set of unobserved "factors"; and that individual observations of each of these variables reflect a combination of (a) the state of these latent factors, (b) a particular variable's relationship to each of these latent factors, and (c) noise. Following this logic, I posit that, for any of the current datasets, the many mental capacities included in that dataset are related, to varying degrees, to a smaller set of latent "conceptual units"; and that a participant's attributions of each of these mental capacities to a particular target character reflect a combination of (a) the participant's beliefs about the extent to which these conceptual units apply to that target character, (b) each mental capacity's relationships to each of the conceptual units, and (c) noise. In other words, one way to identify conceptual units for a particular sample of interest (e.g., US adults; children of different age groups) is to conduct an EFA over participants' mental capacity attributions and treat the resulting "factors" as candidate conceptual units.

## Details of analyses

In the remainder of this chapter, I report EFAs for each age group included in each of the current studies (Studies 1-4). Conducting an EFA requires making a variety of analysis choices, including how to handle missing data, what kind of correlations to use, the choice of factoring algorithm, how to determine the number of factors to retain, the choice of rotation method (if any), and the method for calculating factor scores. In the analysis code for this chapter I have included easy short-cuts for the interest reader to explore different options for each of these parameters. Here, I have set all of these parameters to be constant across EFAs of different samples so as to maximize comparability across studies. To conduct these EFAs, I use the "psych" package for R (Revelle, 2018).

```{r}
# see "./scripts/efa_param.R" for parameter setting
```

```{r}
# overview of missing data
n_missing <- NULL
for(i in list(d1a_ad_wide, d1b_ad_wide, d1c_ad_wide, d1d_ad_wide,
              d2_ad_wide, d2_79_wide, d3_ad_wide, d3_79_wide, d3_46_wide,
              d4_ad_wide, d4_46_wide)){
  n_missing <- c(n_missing, missing_percent_fun(i))
}
```

### Missing data

For all EFAs, I impute missing trial-level data (e.g., skipped trials among child participants) using the median response for that mental capacity among other participants who evaluated the same target character. For example, if an 8-year-old participant in the "beetle" condition failed to provide a response to a question about a beetle's capacity for happiness, I fill in this datapoint with the median response to the happiness question among all other children from the 7- to 9-year-old age group for that study who evaluated the beetle (ignoring responses from other age groups, and ignoring children who evaluated some other target character). Across all studies, fewer than `r ceiling_dec(max(n_missing), 2)  %>% format(nsmall = 2)`% of trials in any age group were missing data. In my judgment, the advantages of retaining the most participants per sample (particularly for EFA, which is highly sensitive to sample size) justify imputing values for this small number of missing datapoints. 

### Correlation type

I conduct analyses over Pearson correlations among mental capacity attributions, using pairwise complete observations. In principle, polychoric correlations are better suited to handle responses on the three-point scales employed in Studies 2-4; however, in my experience with these data, conducting EFAs with polychoric correlations instead of Pearson correlations tends to generate errors further down the analysis pipeline (e.g., generating correlation matrices that are not positive definite) and appears to be somewhat vulnerable to over-fitting (e.g., suggesting retaining six or more factors that each account for only a very small amount of the shared variance).

### Factoring algorithm

I use ordinary least squares to find the minimum residual solution, which is robust to a variety of ways that matrices can be "badly behaved" (see Revelle, 2018). While this dissertation does not include a systematic exploration of all of the factoring algorithms available when conducting EFA, in my casual explorations of the various algorithms available I have yet to observe any substantial differences to the number of factors retained or to the resulting solutions that would change the interpretations offered here.

### Factor retention protocol

I examine the results of three factor retention protocols: (1) Parallel Analysis, which compares the observed correlation structure to the correlation structure arising from random datasets of the same size; (2) Minimizing the Bayesian Information Criterion (BIC), which is one method of optimizing both goodness of fit and parsimony; and (3) The factor retention protocol reported in the original publication of Study 1 (Weisman et al., 2017), which specifies extracting the maximal number of factors according to an analysis of degrees of freedom and retaining factors that meet all three of the following criteria: (a) have eigenvalues >1.00, (b) individually account for >5% of the shared variance before rotation, and (c) are the "dominant" factor (the factor with the strongest absolute factor loading) for at least 1 mental capacity after rotation. 

For each study, my interpretation of how best to characterize the dataset (i.e., how many factors I observed) is determined by the degree of consensus among these three protocols and by the interpretability of the retained factors under each protocol (e.g., the percent of shared variance explained by each factor, the strength of factor loadings for each factor, and my subjective assessment of the ease with which I can identify the "latent construct" captured by each factor). See Table 3.1 for the results of all factor retention protocols for all studies and samples. In the main text of this chapter, I focus on just one or two solutions (see Table 3.1, rightmost column); any suggested solutions that are not discussed in this chapter can be found in Appendix A. 

### Rotation

To maximize interpretability, I present varimax-rotated solutions, in which factors are constrained to be orthogonal (i.e., inter-factor correlations are constrained to be 0) and rotated to maximize the sum of the variances of the squared factor loadings with the goal of achieving "simple structure" (Thurstone, 1949). For unrotated solutions and solutions applying oblique ("oblimin") transformations, in which factors are allowed to correlate, see Appendix A.

### Factor scores

I use the method developed by ten Berge, Krijnen, Wansbeek, & Shapiro (1999) to calculate factor scores, as suggested by Revelle (2018). (I include this parameter here for completeness; this chapter does not include any analyses of factor scores.)


# Study 1: An adult endpoint

In the context of this dissertation, Study 1 serves the role of describing a developmental endpoint for conceptual representations of mental life. In this chapter, I focus on what these studies can reveal about the fundamental components of this representation: What are the conceptual units available to US adults in reasoning about the mental lives of various beings in the world?

An in-depth analysis and discussion of these results is provided in the original publication of these studies (Weisman et al., 2017). Here I present these analyses anew, with slight tweaks to the analysis pipeline to maximize comparability to Studies 2-4—namely, examining multiple factor retention protocols (rather than only one), and recoding the response scale used in these studies to begin at 0 (rather than being centered at 0). 

## Special notes on data processing and analysis

As noted in Chapter II, in the original analysis of Studies 1a-1d responses were recoded to run from -3 to +3 before analyses (Weisman et al., 2017); in this dissertation, I maintain the 0-6 coding for comparability to Studies 2-4. 

Finally, on Study 1c, participants assessed two target characters side by side (in contrast to Studies 1a, 1b, and 1d, in which each participant assessed just one target character). In the current analyses (as in the original publication of these results; Weisman et al., 2017), I treat each participant's assessments of each target character as a separate set of observations (as if they came from different participants), in effect doubling the sample size for these studies (but ignoring the within-subject design).

## Results

```{r}
reten_report <- list("Study 1a" = d1a_ad_wide_i, 
                     "Study 1b" = d1b_ad_wide_i,
                     "Study 1c" = d1c_ad_wide_i, 
                     "Study 1d" = d1d_ad_wide_i,
                     "Study 2: Adults" = d2_ad_wide_i,
                     "Study 2: Children (7-9y)" = d2_79_wide_i,
                     "Study 3: Adults" = d3_ad_wide_i,
                     "Study 3: Older children (7-9y)" = d3_79_wide_i,
                     "Study 3: Younger children (4-6y)" = d3_46_wide_i,
                     "Study 4: Adults" = d4_ad_wide_i,
                     "Study 4: Children (4-5y)" = d4_46_wide_i) %>% 
  reten_report_fun()
```

```{r}
reten_report_byprotocol <- reten_report %>% 
  gather(protocol, nfact) %>% 
  group_by(protocol) %>% 
  summarise(min = min(nfact), 
            max = max(nfact), 
            mean = mean(nfact), 
            median = median(nfact)) %>%
  ungroup()

reten_report_byprotocol
```

```{r}
reten_report_bystudy <- reten_report %>% 
  rownames_to_column("study") %>%
  gather(protocol, nfact, -study) %>% 
  group_by(study) %>% 
  summarise(min = min(nfact), 
            max = max(nfact), 
            mean = mean(nfact), 
            median = median(nfact)) %>%
  ungroup()

reten_report_bystudy
```

### Study 1a

In Study 1a, `r nrow(d1a_ad_wide)` US adults each assessed a single target character on 40 mental capacities. This study employed the "edge case" variant of the general approach, with participants randomly assigned to assess either a beetle or a robot. (See Chapter II and Weisman et al., 2017, for detailed methods.)

#### How many conceptual units?

```{r}
reten_report["Study 1a",]
```

```{r}
efa_par_d1a_ad <- fa_fun(d1a_ad_wide_i, reten_report["Study 1a", "par"])
efa_bic_d1a_ad <- fa_fun(d1a_ad_wide_i, reten_report["Study 1a", "bic"])
efa_wdm_d1a_ad <- fa_fun(d1a_ad_wide_i, reten_report["Study 1a", "wdm"])

saveRDS(efa_par_d1a_ad, file = "./efas/efa_par_d1a_ad")
saveRDS(efa_bic_d1a_ad, file = "./efas/efa_bic_d1a_ad")
saveRDS(efa_wdm_d1a_ad, file = "./efas/efa_wdm_d1a_ad")

# efa_par_d1a_ad <- readRDS(file = "./efas/efa_par_d1a_ad")
# efa_bic_d1a_ad <- readRDS(file = "./efas/efa_bic_d1a_ad")
# efa_wdm_d1a_ad <- readRDS(file = "./efas/efa_wdm_d1a_ad")
```

```{r}
efa_bic_d1a_ad$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_bic_d1a_ad)
loadings_summarize_fun(efa_bic_d1a_ad) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

Two of the three protocols for determining how many factors to retain (parallel analysis and the factor retention criteria reported in the original publication of Study 1; Weisman et al., 2017) suggested retaining three factors, while the third (minimizing BIC) suggested retaining five factors; see Table 3.1. 

Three of the five factors suggested by minimizing BIC were qualitatively very similar to the three factors suggested by the other protocols, and even in the 5-factor solution these three factors together accounted for fully `r efa_bic_d1a_ad$Vaccounted["Cumulative Proportion", "F3"] %>% round(2) * 100`% of the shared variance. The fourth and fifth factors each accounted for <`r efa_bic_d1a_ad$Vaccounted["Proportion Explained", c("F4", "F5")] %>% max() %>% ceiling_dec(2) * 100`% of the shared variance, and neither was the dominant factor for any of the 40 mental capacities included in this study. Indeed, factor loadings for these two factors were all quite weak (absolute loadings all <`r data.frame(loadings_summarize_fun(efa_bic_d1a_ad) %>% filter(factor %in% c("F4", "F5")))$max_abs %>% max() %>% ceiling_dec(2) %>% format(nsmall = 2)`). Given all this, I will limit my interpretations to the three-factor solution; see Appendix A for the 5-factor solution.

```{r}
table3.1 <- reten_report %>%
  rownames_to_column("study") %>%
  # full_join(reten_report_bystudy) %>%
  # mutate(mean = round(mean, 2)) %>%
  mutate(`Focus of interpretation` = c(rep("3-factor solution", 4), 
                                       "3- and 4-factor solutions",
                                       rep("3-factor solution", 3),
                                       "2- and 3-factor solutions",
                                       "3-factor solution",
                                       "3- and 4-factor solutions")) %>%
  mutate(study = gsub("Study ", "", study),
         study = gsub(".\\: ", "", study)) %>%
  rename(` ` = study, 
         `Parallel analysis` = par,
         `Minimizing BIC` = bic,
         `Weisman et al. (2017)` = wdm) %>%
         # `min.` = min,
         # `max.` = max) %>%
  kable(format = "html", 
        caption = "Table 3.1: Number of factors suggested by three factor retention protocols: parallel analysis, minimizing BIC, and the factor retention criteria specified in Weisman et al. (2017). Results are grouped by study and age group. The final column gives the focus of my interpretation in Chapter III; see Appendix A for additional solutions not reported in this chapter.") %>%  
  kable_styling() %>%
  group_rows("Study 1: An adult endpoint", 1, 4) %>%
  group_rows("Study 2: Conceptual change between middle childhood (7-9y) and adulthood", 5, 6) %>%
  group_rows("Study 3: Conceptual change over early and middle childhood (4-9y)", 7, 9) %>%
  group_rows("Study 4: A focus on early childhood (4-5y)", 10, 11) %>%
  # add_header_above(c(" " = 1, "Protocol alternatives" = 3, 
  #                    "Summary of suggestions" = 4)) %>%
  column_spec(4, border_right = T)
```

```{r table3.1, include = T}
table3.1
```

#### What are these conceptual units?

```{r}
factor_names_efa_wdm_d1a_ad <- c("BODY", "HEART", "MIND")
```

After rotation, the first factor corresponded primarily to physiological sensations related to biological needs—a suite of capacities that I will refer to as BODY (a label employed in the original reporting of this study; Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d1a_ad, 4, "F1", "pos")`, and accounted for `r round(efa_wdm_d1a_ad$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d1a_ad$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to capacities for self- and other-relevant emotions—a suite of capacities that I will refer to as HEART (as in Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d1a_ad, 4, "F2", "pos")`, and accounted for `r round(efa_wdm_d1a_ad$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d1a_ad$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor corresponded primarily to perceptual-cognitive abilities to detect and use information about the environment—a suite of capacities that I will refer to as MIND (as in Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d1a_ad, 4, "F3", "pos")`, and accounted for `r round(efa_wdm_d1a_ad$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d1a_ad$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions.

Together, these three factors accounted for `r round(sum(efa_wdm_d1a_ad$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.1 for all factor loadings.

### Study 1b

Study 1b was a direct replication of Study 1a: `r nrow(d1b_ad_wide)` US adults each assessed a single target character (either a beetle or a robot) on 40 mental capacities. (See Chapter II and Weisman et al., 2017, for detailed methods.)

#### How many conceptual units?

```{r}
reten_report["Study 1b",]
```

```{r}
efa_par_d1b_ad <- fa_fun(d1b_ad_wide_i, reten_report["Study 1b", "par"])
efa_bic_d1b_ad <- fa_fun(d1b_ad_wide_i, reten_report["Study 1b", "bic"])
efa_wdm_d1b_ad <- fa_fun(d1b_ad_wide_i, reten_report["Study 1b", "wdm"])

saveRDS(efa_par_d1b_ad, file = "./efas/efa_par_d1b_ad")
saveRDS(efa_bic_d1b_ad, file = "./efas/efa_bic_d1b_ad")
saveRDS(efa_wdm_d1b_ad, file = "./efas/efa_wdm_d1b_ad")

# efa_par_d1b_ad <- readRDS(file = "./efas/efa_par_d1b_ad")
# efa_bic_d1b_ad <- readRDS(file = "./efas/efa_bic_d1b_ad")
# efa_wdm_d1b_ad <- readRDS(file = "./efas/efa_wdm_d1b_ad")
```

```{r}
efa_wdm_d1b_ad$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_wdm_d1b_ad)
loadings_summarize_fun(efa_wdm_d1b_ad) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

```{r}
efa_par_d1b_ad$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_par_d1b_ad)
loadings_summarize_fun(efa_par_d1b_ad) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

```{r}
efa_bic_d1b_ad$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_bic_d1b_ad)
loadings_summarize_fun(efa_bic_d1b_ad) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

Two of the three protocols for determining how many factors to retain (parallel analysis and the factor retention criteria reported in the original publication of Study 1; Weisman et al., 2017) suggested retaining three factors, while the third (minimizing BIC) suggested retaining four factors; see Table 3.1. 

Three of the four factors suggested by minimizing BIC were qualitatively very similar to the three factors suggested by the other protocols, and together accounted for fully `r efa_bic_d1b_ad$Vaccounted["Cumulative Proportion", "F3"] %>% round(2) * 100`% of the shared variance. The fourth factor accounted for only `r efa_bic_d1b_ad$Vaccounted["Proportion Explained", "F4"] %>% round(2) * 100`% of the shared variance, and was not the dominant factor for any of the 40 mental capacities included in this study, with weak loadings for all capacities (absolute loadings all <`r data.frame(loadings_summarize_fun(efa_bic_d1b_ad) %>% filter(factor == "F4"))$max_abs %>% max() %>% ceiling_dec(2) %>% format(nsmall = 2)`). 

Given all this, I will again focus the remainder of my analyses on the three-factor solution; see Appendix A for the four-factor solution.

#### What are these conceptual units?

```{r}
factor_names_efa_wdm_d1b_ad <- c("BODY", "HEART", "MIND")
```

After rotation, the first factor corresponded primarily to the physiological sensations that I labeled BODY in Study 1a (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d1b_ad, 4, "F1", "pos")`, and accounted for `r round(efa_wdm_d1b_ad$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d1b_ad$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to the social-emotional abilities that I labeled HEART in Study 1a (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d1b_ad, 4, "F2", "pos")`, and accounted for `r round(efa_wdm_d1b_ad$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d1b_ad$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor corresponded primarily to the perceptual-cognitive abilities that I referred to as MIND in Study 1a (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d1b_ad, 4, "F3", "pos")`, and accounted for `r round(efa_wdm_d1b_ad$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d1b_ad$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions. 

Together, these three factors accounted for `r round(sum(efa_wdm_d1b_ad$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.1 for all factor loadings.

### Study 1c

In Study 1c, `r nrow(d1c_ad_wide)/2` US adults each assessed two target characters on 40 mental capacities. Like Studies 1a and 1b, this study employed the "edge case" variant of the general approach; but in this study, all participants assessed both of these target characters side by side (with left-right position counterbalanced across participants). (See Chapter II and Weisman et al., 2017, for detailed methods.)

#### How many conceptual units?

```{r}
reten_report["Study 1c",]
```

```{r}
efa_par_d1c_ad <- fa_fun(d1c_ad_wide_i, reten_report["Study 1c", "par"])
efa_bic_d1c_ad <- fa_fun(d1c_ad_wide_i, reten_report["Study 1c", "bic"])
efa_wdm_d1c_ad <- fa_fun(d1c_ad_wide_i, reten_report["Study 1c", "wdm"])

saveRDS(efa_par_d1c_ad, file = "./efas/efa_par_d1c_ad")
saveRDS(efa_bic_d1c_ad, file = "./efas/efa_bic_d1c_ad")
saveRDS(efa_wdm_d1c_ad, file = "./efas/efa_wdm_d1c_ad")

# efa_par_d1c_ad <- readRDS(file = "./efas/efa_par_d1c_ad")
# efa_bic_d1c_ad <- readRDS(file = "./efas/efa_bic_d1c_ad")
# efa_wdm_d1c_ad <- readRDS(file = "./efas/efa_wdm_d1c_ad")
```

```{r}
efa_bic_d1c_ad$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_bic_d1c_ad)
loadings_summarize_fun(efa_bic_d1c_ad) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

The factor retention criteria reported in the original publication of Study 1 (Weisman et al., 2017) suggested retaining three factors, while the other two protocols for determining how many factors to retain (parallel analysis and minimizing BIC) suggested retaining four factors; see Table 3.1. 

Much as in Studies 1a and 1b, three of the four factors suggested by parallel analysis and minimizing BIC were qualitatively very similar to the three factors suggested by the original factor retention criteria, and together accounted for fully `r efa_bic_d1c_ad$Vaccounted["Cumulative Proportion", "F3"] %>% round(2) * 100`% of the shared variance. The fourth factor accounted for only `r efa_bic_d1c_ad$Vaccounted["Proportion Explained", "F4"] %>% round(2) * 100`% of the shared variance and was not the dominant factor for any of the 40 mental capacities included in this study, with weak factor loadings for all capacities (absolute loadings all <`r data.frame(loadings_summarize_fun(efa_bic_d1c_ad) %>% filter(factor == "F4"))$max_abs %>% max() %>% ceiling_dec(2) %>% format(nsmall = 2)`). Given all this, I will again focus the remainder of my analyses on the three-factor solution; see Appendix A for the four-factor solution.

#### What are these conceptual units?

```{r}
factor_names_efa_wdm_d1c_ad <- c("BODY", "HEART", "MIND")
```

After rotation, the first factor corresponded primarily to the physiological sensations that I labeled BODY in Studies 1a and 1b (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d1c_ad, 4, "F1", "pos")`, and accounted for `r round(efa_wdm_d1c_ad$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d1c_ad$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to the social-emotional abilities that I labeled HEART in Studies 1a and 1b (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d1c_ad, 4, "F2", "pos")`, and accounted for `r round(efa_wdm_d1c_ad$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d1c_ad$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor corresponded primarily to the perceptual-cognitive abilities that I referred to as MIND in Studies 1a and 1b (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d1c_ad, 4, "F3", "pos")`, and accounted for `r round(efa_wdm_d1c_ad$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d1c_ad$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions.

Together, these three factors accounted for `r round(sum(efa_wdm_d1c_ad$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.1 for all factor loadings.

### Study 1d

In Study 1d, `r nrow(d1d_ad_wide)` US adults each assessed a single target character on 40 mental capacities. Unlike Studies 1a-1c, this study employed the "many characters" variant of the general approach, in which participants were randomly assigned to assess one of the following 21 target characters: an adult, a child, an infant, a person in a persistent vegetative state, a fetus, a chimpanzee, an elephant, a dolphin, a bear, a dog, a goat, a mouse, a frog, a blue jay, a fish, a beetle, a microbe, a robot, a computer, a car, or a stapler. (See Chapter II and Weisman et al., 2017, for detailed methods.)

#### How many conceptual units?

```{r}
reten_report["Study 1d",]
```

```{r}
efa_par_d1d_ad <- fa_fun(d1d_ad_wide_i, reten_report["Study 1d", "par"])
efa_bic_d1d_ad <- fa_fun(d1d_ad_wide_i, reten_report["Study 1d", "bic"])
efa_wdm_d1d_ad <- fa_fun(d1d_ad_wide_i, reten_report["Study 1d", "wdm"])

saveRDS(efa_par_d1d_ad, file = "./efas/efa_par_d1d_ad")
saveRDS(efa_bic_d1d_ad, file = "./efas/efa_bic_d1d_ad")
saveRDS(efa_wdm_d1d_ad, file = "./efas/efa_wdm_d1d_ad")

# efa_par_d1d_ad <- readRDS(file = "./efas/efa_par_d1d_ad")
# efa_bic_d1d_ad <- readRDS(file = "./efas/efa_bic_d1d_ad")
# efa_wdm_d1d_ad <- readRDS(file = "./efas/efa_wdm_d1d_ad")
```

```{r}
efa_wdm_d1d_ad$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_wdm_d1d_ad)
loadings_summarize_fun(efa_wdm_d1d_ad) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

```{r}
efa_par_d1d_ad$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_par_d1d_ad)
loadings_summarize_fun(efa_par_d1d_ad) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

```{r}
efa_bic_d1d_ad$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_bic_d1d_ad)
loadings_summarize_fun(efa_bic_d1d_ad) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

Each of the three factor retention protocols suggested a different number of factors to retain; see Table 3.1.

The retention criteria used in the original reporting of this study (Weisman et al., 2017) suggested retaining three factors. 

Parallel analysis suggested retaining four factors. However, three of these four factors were qualitatively very similar to the three factors suggested by Weisman et al.'s (2017) original retention criteria, and together accounted for fully `r efa_par_d1d_ad$Vaccounted["Cumulative Proportion", "F3"] %>% round(2) * 100`% of the shared variance. The fourth factor accounted for only `r efa_par_d1d_ad$Vaccounted["Proportion Explained", "F4"] %>% round(2) * 100`% of the shared variance and was not the dominant factor for any of the 40 mental capacities included in this study, with weak loadings for all capacities (absolute loadings all <`r data.frame(loadings_summarize_fun(efa_par_d1d_ad) %>% filter(factor == "F4"))$max_abs %>% max() %>% ceiling_dec(2) %>% format(nsmall = 2)`). 

Likewise, minimizing BIC suggested retaining five factors, but three of these five factors were qualitatively very similar to the three factors suggested by the original retention criteria, and together accounted for fully `r efa_bic_d1d_ad$Vaccounted["Cumulative Proportion", "F3"] %>% round(2) * 100`% of the shared variance. The fourth and fifth factors each accounted for <`r efa_bic_d1d_ad$Vaccounted["Proportion Explained", c("F4", "F5")] %>% max() %>% ceiling_dec(2) * 100`% of the shared variance, and neither was the dominant factor for any of the 40 mental capacities included in this study. Indeed, factor loadings for these two factors were all quite weak (absolute loadings all <`r data.frame(loadings_summarize_fun(efa_bic_d1d_ad) %>% filter(factor %in% c("F4", "F5")))$max_abs %>% max() %>% ceiling_dec(2) %>% format(nsmall = 2)`). 

Given all this, I will once more focus the remainder of my analyses on the three-factor solution; see Appendix A for the 4- and 5-factor solutions.

#### What are these conceptual units?

```{r}
factor_names_efa_wdm_d1d_ad <- c("BODY", "HEART", "MIND")
```

After rotation, the first factor corresponded primarily to the physiological sensations that I labeled BODY in Studies 1a-1c (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d1d_ad, 4, "F1", "pos")`, and accounted for `r round(efa_wdm_d1d_ad$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d1d_ad$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to the social-emotional abilities that I labeled HEART in Studies 1a-1c (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d1d_ad, 4, "F2", "pos")`, and accounted for `r round(efa_wdm_d1d_ad$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d1d_ad$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor corresponded primarily to the perceptual-cognitive abilities that I referred to as MIND in Studies 1a-1c (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d1d_ad, 4, "F3", "pos")`, and accounted for `r round(efa_wdm_d1d_ad$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d1d_ad$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions.

Together, these three factors accounted for `r round(sum(efa_wdm_d1d_ad$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.1 for all factor loadings.

```{r}
plot_efa_wdm_d1a_ad <- heatmap_fun(efa_wdm_d1a_ad, 
                                   factor_names_efa_wdm_d1a_ad) +
  labs(title = "Study 1a", subtitle = "3-factor solution") +
  theme(legend.position = "none")
plot_efa_wdm_d1b_ad <- heatmap_fun(efa_wdm_d1b_ad, 
                                   factor_names_efa_wdm_d1b_ad) +
  labs(title = "Study 1b", subtitle = "3-factor solution") +
  theme(legend.position = "none")
plot_efa_wdm_d1c_ad <- heatmap_fun(efa_wdm_d1c_ad, 
                                   factor_names_efa_wdm_d1c_ad) +
  labs(title = "Study 1c", subtitle = "3-factor solution") +
  theme(legend.position = "none")
plot_efa_wdm_d1d_ad <- heatmap_fun(efa_wdm_d1d_ad, 
                                   factor_names_efa_wdm_d1d_ad) +
  labs(title = "Study 1d", subtitle = "3-factor solution")
```

```{r}
figure3.1 <- plot_grid(plot_efa_wdm_d1a_ad, plot_efa_wdm_d1b_ad,
                       plot_efa_wdm_d1c_ad, plot_efa_wdm_d1d_ad,
                       labels = "AUTO", ncol = 4, rel_widths = c(1, 1, 1, 1.2))

figure3.1_cap <- add_sub(figure3.1, str_wrap("Figure 3.1: Factor loadings from exploratory factor analyses of Studies 1a-1d (see also Weisman et al., 2017). (A-B) In Studies 1a and 1b, US adults assessed one of two 'edge case' characters (a beetle or a robot). (C) In Study 1c, US adults assess both of these 'edge cases' side by side (with left-right position counterbalanced across participants). (D) In Study 1d, US adults assessed one of 21 diverse target characters. In this and all figures portraying factor loadings, factors have been plotted in the same order (BODY, HEART, MIND), when applicable, to facilitate comparison across studies. A factor loading of +1 indicates a perfectly positive relationship between mental capacity and underlying construct; a loading of -1 indicates a perfectly negative relationship.", 210), x = 0, hjust = 0)
```

```{r figure3.1, include = T, fig.width = 9, fig.asp = 0.6}
ggdraw(figure3.1_cap)
```

## Discussion

The general pattern that emerged from Studies 1a-1d is clear and appears to be highly reliable: In four large-scale studies, US adults' mental capacity attributions were anchored by a three-way distinction between the physiological sensations of the BODY, the social-emotional abilities of the HEART, and the perceptual-cognitive abilities of the MIND. Given the range of mental capacities included in each study, a number of additional or alternative factors could have emerged (including "experience" or "agency," as in Gray et al.'s 2007 work on mind perception). Nonetheless, a common set of factors—i.e., a stable set of "conceptual units"—emerged across independent analyses of four studies, whether participants judged a single "edge case" target character in isolation (Studies 1a and 1b), compared two "edge cases" that highlighted a contrast in biological animacy (Study 1c), or evaluated a diverse range of target characters, from inert objects to canonical social partners (Study 1d).For an extended discussion of these results, see Weisman et al. (2017). 

Studies 1a-1d provide a clear developmental endpoint for this aspect of conceptual representations of mental life: As a group, US adults appear to have access to three fundamental conceptual units—BODY, HEART, and MIND—when reasoning about the mental lives of various beings in the world. Studies 2-4 were designed to explore the developmental trajectory that leads up to this endpoint: How do US children come to represent mental life in this way?


# Study 2: Conceptual change between middle childhood (7-9y) and adulthood

Study 2 provides a first glimpse of the emergence of conceptual representations of mental life prior to adulthood. In this chapter, I focus on the fundamental components of this representation: What are the conceptual units available to US children in reasoning about the mental lives of various beings in the world, and how do they compare to those available to US adults (as revealed in Study 1)?

Pursuing this question with children required developing an age-appropriate experimental paradigm. In particular, the wording of some of the 40 mental capacities employed in Study 1 was modified to use more age-appropriate vocabulary, and participants responded on a three-point scale ("no," coded as 0; "kinda," coded as 0.5, "yes," coded as 1), , rather than a seven-point scale. Study 2 employed the "edge case" variant of the general approach, with participants randomly assigned to assess either a beetle or a robot. As in Studies 1a, 1b, and 1d, in Study 2 each participant assessed a single target character on all 40 mental capacities. To validate the modified paradigm (i.e., to assess whether this paradigm produced similar results to Study 1), and to provide a direct comparison for child participants, participants included a sample of `r nrow(d2_ad_wide)` US adults. As an initial foray into exploring development in this domain, the child sample consisted of `r nrow(d2_79_wide)` US children between the ages of `r summary(d2_79$age)["Min."] %>% round(2)`-`r summary(d2_79$age)["Max."] %>% round(2)`y (median: `r summary(d2_79$age)["Median"] %>% round(2)`y). (See Chapter II for detailed methods.)

## Results

### Adults

#### How many conceptual units?

```{r}
reten_report["Study 2: Adults",]
```

```{r}
efa_par_d2_ad <- fa_fun(d2_ad_wide_i, reten_report["Study 2: Adults", "par"])
efa_bic_d2_ad <- fa_fun(d2_ad_wide_i, reten_report["Study 2: Adults", "bic"])
efa_wdm_d2_ad <- fa_fun(d2_ad_wide_i, reten_report["Study 2: Adults", "wdm"])

saveRDS(efa_par_d2_ad, file = "./efas/efa_par_d2_ad")
saveRDS(efa_bic_d2_ad, file = "./efas/efa_bic_d2_ad")
saveRDS(efa_wdm_d2_ad, file = "./efas/efa_wdm_d2_ad")

# efa_par_d2_ad <- readRDS(file = "./efas/efa_par_d2_ad")
# efa_bic_d2_ad <- readRDS(file = "./efas/efa_bic_d2_ad")
# efa_wdm_d2_ad <- readRDS(file = "./efas/efa_wdm_d2_ad")
```

```{r}
efa_par_d2_ad$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_par_d2_ad)
loadings_summarize_fun(efa_par_d2_ad) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

Two of the three protocols for determining how many factors to retain (minimizing BIC and the factor retention criteria employed in the original publication of Study 1; Weisman et al., 2017) suggested retaining three factors, while the third (parallel analysis) suggested retaining four factors; see Table 3.1. Unlike in Studies 1a-1d, in which factors beyond the first three uniformly accounted for very small amounts of the shared variance, were not the dominant factor for any mental capacities, and tended to have weak factor loadings for all mental capacities, none of these considerations clearly rules out the fourth factor suggested by parallel analysis. Given this, I will present and interpret both three- and four-factor solutions.

#### What are these conceptual units?

##### Three-factor solution

```{r}
factor_names_efa_wdm_d2_ad <- c("HEART", "BODY", "MIND")
```

First, I will examine the three-factor solution suggested by minimizing BIC and by the factor retention criteria employed in the original publication of Study 1 (Weisman et al., 2017). Importantly, this is the number of factors retained among US adults in all of my previous studies with US adults (Studies 1a-1d).

After rotation, the first factor corresponded primarily to the social-emotional abilities that I labeled HEART in Study 1 (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d2_ad, 4, "F1", "pos")`, and accounted for `r round(efa_wdm_d2_ad$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d2_ad$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to the physiological sensations that I labeled BODY in Study 1 (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d2_ad, 4, "F2", "pos")`, and accounted for `r round(efa_wdm_d2_ad$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d2_ad$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor corresponded primarily to the perceptual-cognitive abilities that I referred to as MIND in Study 1 (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d2_ad, 4, "F3", "pos")`, and accounted for `r round(efa_wdm_d2_ad$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d2_ad$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions. 

Together, these three factors accounted for `r round(sum(efa_wdm_d2_ad$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.2 for all factor loadings.

##### Four-factor solution

```{r}
factor_names_efa_par_d2_ad <- c("BODY", "HEART", "MIND (cognition/agency)", 
                                "MIND (perception)")
```

In the four-factor solution suggested by parallel analysis, after rotation, the first factor corresponded primarily to physiological sensations (BODY). It was the dominant factor for such items as `r top_n_domCap(efa_par_d2_ad, 4, "F1", "pos")`, and accounted for `r round(efa_par_d2_ad$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated four-factor solution, and `r round(efa_par_d2_ad$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to the social-emotional abilities (HEART). It was the dominant factor for such items as `r top_n_domCap(efa_par_d2_ad, 4, "F2", "pos")`, and accounted for `r round(efa_par_d2_ad$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated four-factor solution, and `r round(efa_par_d2_ad$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor corresponded primarily to the more "cognitive" and "agentic" of the perceptual-cognitive abilities that I have been referring to as MIND. It was the dominant factor for such items as `r top_n_domCap(efa_par_d2_ad, 4, "F3", "pos")`, and accounted for `r round(efa_par_d2_ad$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated four-factor solution, and `r round(efa_par_d2_ad$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions. 

The fourth factor corresponded primarily to the more "perceptual" of the perceptual-cognitive abilities that I have been referring to as MIND. It was the dominant factor for such items as `r top_n_domCap(efa_par_d2_ad, 4, "F4", "pos")`, and accounted for `r round(efa_par_d2_ad$Vaccounted["Proportion Explained", "F4"], 2) * 100`% of the shared variance in the rotated four-factor solution, and `r round(efa_par_d2_ad$Vaccounted["Proportion Var", "F4"], 2) * 100`% of the total variance in participants' mental capacity attributions. 

Together, these four factors accounted for `r round(sum(efa_par_d2_ad$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.2 for all factor loadings.

##### Interim discussion

Two of the three factor retention protocols suggested a three-factor solution, which was characterized by a distinction between BODY, HEART, and MIND. This three-factor structure is highly similar to the three-factor structures revealed by Studies 1a-1d, suggesting that the child-friendly paradigm developed for Study 2 was valid: Providing adult participants with more "child-friendly" items to assess using a three-point (rather than seven-point) response scale elicited the same conceptual units that have been revealed by more complex, "adult-friendly" experimental paradigms. 

Meanwhile, I would summarize the four-factor solution suggested by parallel analysis as a slight variant on this three-factor solution—again characterized by distinct constructs of BODY and HEART but including a further differention of the suite of mental capacities I have referred to as MIND into cognitive/agentic abilities (e.g., thinking, choosing, reasoning, planning) vs. perceptual abilities (e.g., hearing, seeing, sensing). Reanalyzing Studies 1a-1d using different EFA parameters (in particular, retaining more factors and examining an oblique transformation of EFA solutions rather than an orthogonal rotation) provides some converging evidence for this cognitive/agentic vs. perception distinction in the correlation structure of US adults' mental capacity attributions; see Appendix A. However, this distinction does not appear to be robust enough to emerge reliably across studies and analysis decisions in the kinds of experimental paradigms employed in this dissertation.

### Children (7-9y)

#### How many conceptual units?

```{r}
reten_report["Study 2: Children",]
```

```{r}
efa_par_d2_79 <- fa_fun(d2_79_wide_i, reten_report["Study 2: Children", "par"])
efa_bic_d2_79 <- fa_fun(d2_79_wide_i, reten_report["Study 2: Children", "bic"])
efa_wdm_d2_79 <- fa_fun(d2_79_wide_i, reten_report["Study 2: Children", "wdm"])

saveRDS(efa_par_d2_79, file = "./efas/efa_par_d2_79")
saveRDS(efa_bic_d2_79, file = "./efas/efa_bic_d2_79")
saveRDS(efa_wdm_d2_79, file = "./efas/efa_wdm_d2_79")

# efa_par_d2_79 <- readRDS(file = "./efas/efa_par_d2_79")
# efa_bic_d2_79 <- readRDS(file = "./efas/efa_bic_d2_79")
# efa_wdm_d2_79 <- readRDS(file = "./efas/efa_wdm_d2_79")
```

All three protocols for determining how many factors to retain suggested retaining three factors; see Table 3.1.

#### What are these conceptual units?

```{r}
cong_efa_wdm_d2_ad_79 <- cong_table_fun(efa_ad = efa_wdm_d2_ad, 
                                        efa_ch = efa_wdm_d2_79, 
                                        factor_names_efa_wdm_d2_ad)
cong_efa_wdm_d2_ad_79
```

```{r}
factor_names_efa_wdm_d2_79 <- c("HEART", "BODY", "MIND")
```

After rotation, the first factor corresponded primarily to social-emotional abilities. An analysis of factor congruence with the three-factor solution among adults confirmed that this factor was most similar to adults' HEART factor (`r cong_report_fun(efa_ad = efa_wdm_d2_ad, efa_ch = efa_wdm_d2_79, factor = "F1", factor_names_ad = factor_names_efa_wdm_d2_ad)`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d2_79, 4, "F1", "pos")`, and accounted for `r round(efa_wdm_d2_79$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d2_79$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to physiological sensations. An analysis of factor congruence confirmed that this factor was most similar to adults' BODY factor (`r cong_report_fun(efa_ad = efa_wdm_d2_ad, efa_ch = efa_wdm_d2_79, factor = "F2", factor_names_ad = factor_names_efa_wdm_d2_ad)`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d2_79, 4, "F2", "pos")`, and accounted for `r round(efa_wdm_d2_79$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d2_79$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor corresponded primarily to perceptual-cognitive abilities. An analysis of factor congruence confirmed that this factor was most similar to adults' MIND factor (`r cong_report_fun(efa_ad = efa_wdm_d2_ad, efa_ch = efa_wdm_d2_79, factor = "F3", factor_names_ad = factor_names_efa_wdm_d2_ad)`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d2_79, 4, "F3", "pos")`, and accounted for `r round(efa_wdm_d2_79$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d2_79$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions.

Together, these three factors accounted for `r round(sum(efa_wdm_d2_79$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.2 for all factor loadings, and Table 3.2 for cosine similarities between child and adult factors.

In sum, like adults in Study 1, and like the three-factor solution for adults in the current study, 7- to 9-year-old children's mental capacity attributions were dominated by a three-way distinction between physiological, social-emotional, and perceptual-cognitive abilities—i.e., BODY, HEART, and MIND.

```{r}
plot_efa_wdm_d2_ad <- heatmap_fun(efa_wdm_d2_ad, factor_names_efa_wdm_d2_ad) +
  labs(title = "Adults", subtitle = "3-factor solution") +
  theme(legend.position = "none")
plot_efa_par_d2_ad <- heatmap_fun(efa_par_d2_ad, factor_names_efa_par_d2_ad) +
  labs(title = "Adults", subtitle = "4-factor solution") +
  theme(legend.position = "none")
plot_efa_wdm_d2_79 <- heatmap_fun(efa_wdm_d2_79, factor_names_efa_wdm_d2_79) +
  labs(title = "Children, 7-9y", subtitle = "3-factor solution")
```

```{r}
figure3.2 <- plot_grid(plot_efa_wdm_d2_ad, plot_efa_par_d2_ad,
                       plot_efa_wdm_d2_79,
                       labels = "AUTO", ncol = 3, rel_widths = c(1, 1.5, 1.2))

figure3.2_cap <- add_sub(figure3.2, str_wrap("Figure 3.2: Factor loadings from exploratory factor analyses of Study 2, in which participants assessed one of two 'edge case' characters (a beetle or a robot). (A) Results for US adults, retaining 3 factors (as suggested by minimizing BIC and by the original factor retention criteria reported in Weisman et al., 2017). (B) Results for US adults, retaining 4 factors (as suggested by parallel analysis). (C) Results for US children ages 7-9y. In this and all figures portraying factor loadings, factors have been plotted in the same order (BODY, HEART, MIND), when applicable, to facilitate comparison across studies. A factor loading of +1 indicates a perfectly positive relationship between mental capacity and underlying construct; a loading of -1 indicates a perfectly negative relationship.", 210), x = 0, hjust = 0)
```

```{r figure3.2, include = T, fig.width = 9, fig.asp = 0.6}
ggdraw(figure3.2_cap)
```

## Discussion

Exploratory factor analyses suggested that by midddle childhood (7-9y), the conceptual structure underlying US children's attributions of mental life is very similar to that of US adults, anchored by suites of mental capacities related to BODY (physiological sensations), HEART (social-emotional abilities), and MIND (perceptual-cognitive abilities). In principle, a number of additional or alternative latent factors could have emerged from the factor analysis of children's responses. For example, children might have distinguished primarily between internal "experience" and external action or "agency" (Gray et al., 2007), or they might have demonstrated finer-grained groupings of mental capacities based on phrasing, rote knowledge, etc. Instead, the latent conceptual structure underlying children's responses appears to be very similar to that of adults, both in this study and in Weisman et al.'s (2017) previous work. In other words, any dramatic developmental changes to this conceptual structure likely occur prior to the age of 7y.


# Study 3: Conceptual change over early and middle childhood (4-9y)

Study 3 continues my exploration of the emergence of conceptual representations of mental life in childhood. Again, in this chapter, I focus in particular on the fundamental components of this representation: What are the conceptual units available to US children at different points in development, and how might this aspect of conceptual representation change?

In Study 3, I aimed to extend my findings with 7- to 9-year-old children in Study 2 by expanding the list of the target characters to include not only the two "edge cases" from Study 2 (a beetle and a robot), but a also a wider range of animate beings (a bird, a goat, and an elephant) and inanimate objects (a computer, a teddy bear, and a doll)—in other words, employing the "diverse characters" (rather than "edge case") variant of the overall approach. In Study 1, these two approaches yielded very similar pictures of the conceptual units available to adults (see also Weisman et al., 2017). I reasoned that if this three-part conceptual structure is stable and robust by the age of 7-9y, it should manifest among 7- to 9-year-old children under the same range of conditions that it does among adults. 

This study also provides a first glimpse of the earlier development of conceptual structure in a group of younger children. I targeted 4- to 6-year-old children for the younger age group because this has been identified as a period of dramatic development in several relevant domains. Many studies have documented shifts in children's abilities to take others' perspectives, represent false beliefs, and integrate representations of intentions and outcomes in evaluating moral responsibility (for reveiws, see Flavell, 1999; Wellman, 2015). The preschool years have also been the focus of a rich tradition of work on lay biology and the animate-inanimate distinction extending back nearly a century (e.g., Carey, 1985; R. Gelman, Spelke, & Meck, 1983; Medin, Waxman, Woodring, & Washinawatok, 2010; Piaget, 1929; for a review, see S. Gelman & Opfer, 2002). All of these accounts make the case that becoming a sophisticated reasoner—and particularly a sophisticated social reasoner—requires substantial refinement of one's representations of others' experiences, beliefs, desires, and needs. Might these refinements include changes to the structure of children's concepts of mental life—in particular, the conceptual units availalbe to children when reasoning about other beings? 

Participants in Study 3 each assessed a single target character on 20 mental capacities. Participants were randomly or pseudo-randomly assigned to assess either one of the following 9 characters: an elephant, a goat, a mouse, a bird, a beetle, a teddy bear, a doll, a robot, or a computer. To make the study appropriate for children as young as 4y of age, participants assessed a subset of the 40 mental capacities employed in Study 2, chosen to represent the three "conceptual units" revealed by Studies 1 and 2 (BODY, HEART, and MIND) and to cover a similar range of mental capacities as Studies 1 and 2. As in Study 2, participants responded on a three-point scale ("no," coded as 0; "kinda," coded as 0.5, "yes," coded as 1). 

To validate the modified paradigm (i.e., to assess whether this paradigm produced similar results to Studies 1 and 2), and to provide a direct comparison for child participants, participants included a sample of `r nrow(d3_ad_wide)` US adults, as well as a sample of `r nrow(d3_79_wide)` "older" children (`r summary(d3_79$age)["Min."] %>% round(2)`-`r summary(d3_79$age)["Max."] %>% round(2)`y; median: `r summary(d3_79$age)["Median"] %>% round(2)`y), and a sample of `r nrow(d3_46_wide)` "younger" children (`r summary(d3_46$age)["Min."] %>% round(2)`-`r summary(d3_46$age)["Max."] %>% round(2)`y; median: `r summary(d3_46$age)["Median"] %>% round(2)`y). (See Chapter II for detailed methods.)

## Results

### Adults

#### How many conceptual units?

```{r}
reten_report["Study 3: Adults",]
```

```{r}
efa_par_d3_ad <- fa_fun(d3_ad_wide_i, reten_report["Study 3: Adults", "par"])
efa_bic_d3_ad <- fa_fun(d3_ad_wide_i, reten_report["Study 3: Adults", "bic"])
efa_wdm_d3_ad <- fa_fun(d3_ad_wide_i, reten_report["Study 3: Adults", "wdm"])

saveRDS(efa_par_d3_ad, file = "./efas/efa_par_d3_ad")
saveRDS(efa_bic_d3_ad, file = "./efas/efa_bic_d3_ad")
saveRDS(efa_wdm_d3_ad, file = "./efas/efa_wdm_d3_ad")

# efa_par_d3_ad <- readRDS(file = "./efas/efa_par_d3_ad")
# efa_bic_d3_ad <- readRDS(file = "./efas/efa_bic_d3_ad")
# efa_wdm_d3_ad <- readRDS(file = "./efas/efa_wdm_d3_ad")
```

```{r}
efa_bic_d3_ad$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_bic_d3_ad)
loadings_summarize_fun(efa_bic_d3_ad) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

Two of the three protocols for determining how many factors to retain (parallel analysis and the factor retention criteria employed in the original publication of Study 1; Weisman et al., 2017) suggested retaining three factors, while the third (minimizing BIC) suggested retaining four factors; see Table 3.1. 

Three of the four factors suggested by minimizing BIC were qualitatively very similar to the three factors suggested by the other protocols, and together accounted for fully `r efa_bic_d3_ad$Vaccounted["Cumulative Proportion", "F3"] %>% round(2) * 100`% of the shared variance. The fourth factor accounted for only `r efa_bic_d3_ad$Vaccounted["Proportion Explained", "F4"] %>% round(2) * 100`% of the shared variance, was the dominant factor for only one of the 40 mental capacities included in this study (`r top_n_domCap(efa_bic_d3_ad, n = 1, "F4", abs_pos = "abs")`), and had moderately weak factor loadings for all other capacities (absolute loadings <`r efa_bic_d3_ad %>% loadings_fun() %>% filter(capacity != "feel happy", factor == "F4") %>% summarise(max_abs = max(abs(loading))) %>% as.numeric() %>% ceiling_dec(2) %>% format(nsmall = 2)`). Given all this, I will again focus the remainder of my analyses on the three-factor solution; see Appendix A for the four-factor solution.

#### What are these conceptual units?

```{r}
factor_names_efa_wdm_d3_ad <- c("BODY", "HEART", "MIND")
```

After rotation, the first factor corresponded primarily to the physiological sensations that I labeled BODY in Studies 1 and 2 (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d3_ad, 4, "F1", "pos")`, and accounted for `r round(efa_wdm_d3_ad$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d3_ad$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to the social-emotional abilities that I labeled HEART in Studies 1 and 2 (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d3_ad, 4, "F2", "pos")`, and accounted for `r round(efa_wdm_d3_ad$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d3_ad$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor corresponded primarily to the perceptual-cognitive abilities that I referred to as MIND in Studies 1 and 2 (see also Weisman et al., 2017). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d3_ad, 4, "F3", "pos")`, and accounted for `r round(efa_wdm_d3_ad$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d3_ad$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions.

Together, these three factors accounted for `r round(sum(efa_wdm_d3_ad$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.3 for all factor loadings.

In sum, as in Study 1 and the three-factor solution for Study 2, the conceptual structure revealed by this analysis among adults was characterized by a three-way distinction between BODY, HEART, and MIND. This suggests that the modified child-friendly paradigm developed for Study 3 was valid: Using a shorter list of items and a wider range of target characters elicited the same three conceptual units, among US adults, that was revealed in Studies 1 and 2. 

### Older children (7-9y)

#### How many conceptual units?

```{r}
reten_report["Study 3: Older children",]
```

```{r}
efa_par_d3_79 <- fa_fun(d3_79_wide_i, 
                        reten_report["Study 3: Older children", "par"])
efa_bic_d3_79 <- fa_fun(d3_79_wide_i, 
                        reten_report["Study 3: Older children", "bic"])
efa_wdm_d3_79 <- fa_fun(d3_79_wide_i, 
                        reten_report["Study 3: Older children", "wdm"])

saveRDS(efa_par_d3_79, file = "./efas/efa_par_d3_79")
saveRDS(efa_bic_d3_79, file = "./efas/efa_bic_d3_79")
saveRDS(efa_wdm_d3_79, file = "./efas/efa_wdm_d3_79")

# efa_par_d3_79 <- readRDS(file = "./efas/efa_par_d3_79")
# efa_bic_d3_79 <- readRDS(file = "./efas/efa_bic_d3_79")
# efa_wdm_d3_79 <- readRDS(file = "./efas/efa_wdm_d3_79")
```

As was the case among this age group in Study 2, all three factor retention protocols suggested retaining three factors; see Table 3.1.

#### What are these conceptual units?

```{r}
cong_efa_wdm_d3_ad_79 <- cong_table_fun(efa_ad = efa_wdm_d3_ad,
                                        efa_ch = efa_wdm_d3_79,
                                        factor_names_efa_wdm_d3_ad)
cong_efa_wdm_d3_ad_79
```

```{r}
factor_names_efa_wdm_d3_79 <- c("BODY", "HEART", "MIND")
```

After rotation, the first factor corresponded primarily to physiological sensations. An analysis of factor congruence confirmed that this factor was most similar to adults' BODY factor (`r cong_report_fun(efa_ad = efa_wdm_d3_ad, efa_ch = efa_wdm_d3_79, factor = "F1", factor_names_ad = c("BODY", "HEART", "MIND"))`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d3_79, 4, "F1", "pos")`, and accounted for `r round(efa_wdm_d3_79$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d3_79$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to social-emotional abilities. An analysis of factor congruence confirmed that this factor was most similar to adults' HEART factor (`r cong_report_fun(efa_ad = efa_wdm_d3_ad, efa_ch = efa_wdm_d3_79, factor = "F2", factor_names_ad = c("BODY", "HEART", "MIND"))`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d3_79, 4, "F2", "pos")`, and accounted for `r round(efa_wdm_d3_79$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d3_79$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor corresponded primarily to perceptual-cognitive abilities. An analysis of factor congruence confirmed that this factor was most similar to adults' MIND factor (`r cong_report_fun(efa_ad = efa_wdm_d3_ad, efa_ch = efa_wdm_d3_79, factor = "F3", factor_names_ad = c("BODY", "HEART", "MIND"))`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d3_79, 4, "F3", "pos")`, and accounted for `r round(efa_wdm_d3_79$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d3_79$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions.

Together, these three factors accounted for `r round(sum(efa_wdm_d3_79$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.3 for all factor loadings, and Table 3.2 for cosine similarities between child and adult factors.

I consider this to be a close conceptual replication of Study 1, suggesting that by the age of 7-9y, this three-part conceptual structure is stable and robust to a range of experimental conditions.

### Younger children (4-6y)

#### How many conceptual units?

```{r}
reten_report["Study 3: Younger children",]
```

```{r}
efa_par_d3_46 <- fa_fun(d3_46_wide_i, 
                        reten_report["Study 3: Younger children", "par"])
efa_bic_d3_46 <- fa_fun(d3_46_wide_i, 
                        reten_report["Study 3: Younger children", "bic"])
efa_wdm_d3_46 <- fa_fun(d3_46_wide_i, 
                        reten_report["Study 3: Younger children", "wdm"])

saveRDS(efa_par_d3_46, file = "./efas/efa_par_d3_46")
saveRDS(efa_bic_d3_46, file = "./efas/efa_bic_d3_46")
saveRDS(efa_wdm_d3_46, file = "./efas/efa_wdm_d3_46")

# efa_par_d3_46 <- readRDS(file = "./efas/efa_par_d3_46")
# efa_bic_d3_46 <- readRDS(file = "./efas/efa_bic_d3_46")
# efa_wdm_d3_46 <- readRDS(file = "./efas/efa_wdm_d3_46")
```

```{r}
efa_bic_d3_46$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_bic_d3_46)
loadings_summarize_fun(efa_bic_d3_46) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

```{r}
efa_par_d3_46$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_par_d3_46)
loadings_summarize_fun(efa_par_d3_46) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

```{r}
efa_wdm_d3_46$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_wdm_d3_46)
loadings_summarize_fun(efa_wdm_d3_46) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

Each of the three factor retention protocols suggested a different number of factors to retain; see Table 3.1.

Minimizing BIC suggested a null solution consisting of a single factor; in other words, this protocol indicated that the correlation structure of younger children's responses provided no evidence for distinct latent constructs.  

Meanwhile, parallel analysis suggested retaining two factors, and the retention criteria employed in the original publication of Study 1; Weisman et al., 2017) suggested retaining three factors. In both the two- and three-factor solutions, each factor accounted for a substantial amount of the shared variance, was the dominant factor for several mental capacities, and had strong factor loadings for some subset of mental capacities.

Given all this, I will present and interpret both two- and three-factor solutions; see Appendix A for the null, one-factor solution suggested by minimizing BIC.

#### What are these conceptual units?

##### Two-factor solution

```{r}
cong_efa_par_d3_ad_46 <- cong_table_fun(efa_ad = efa_wdm_d3_ad,
                                        efa_ch = efa_par_d3_46,
                                        factor_names_efa_wdm_d3_ad)
cong_efa_par_d3_ad_46
```

```{r}
factor_names_efa_par_d3_46 <- c("BODY-HEART", "MIND")
```

First, I will examine the two-factor solution suggested by parallel analysis. 

After rotation, the first factor encompassed both physiological sensations and emotions. An analysis of factor congruence indicated that this factor was most similar to adults' BODY factor, but was also quite similar to adults' HEART factor (`r cong_report_fun(efa_ad = efa_par_d3_ad, efa_ch = efa_par_d3_46, factor = "F1", factor_names_ad = c("BODY", "HEART", "MIND"))`). It was the dominant factor for such items as `r top_n_domCap(efa_par_d3_46, 4, "F1", "pos")`, and accounted for `r round(efa_par_d3_46$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated two-factor solution, and `r round(efa_par_d3_46$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to perceptual-cognitive abilities, as well as one complex negative emotion (_feel guilty_). An analysis of factor congruence confirmed that this factor was most similar to adults' MIND factor (`r cong_report_fun(efa_ad = efa_par_d3_ad, efa_ch = efa_par_d3_46, factor = "F2", factor_names_ad = c("BODY", "HEART", "MIND"))`). It was the dominant factor for such items as `r top_n_domCap(efa_par_d3_46, 4, "F2", "pos")`, and accounted for `r round(efa_par_d3_46$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated two-factor solution, and `r round(efa_par_d3_46$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

Together, these two factors accounted for `r round(sum(efa_par_d3_46$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.3 for all factor loadings, and Table 3.2 for cosine similarities between child and adult factors.

In relation to the BODY-HEART-MIND structure found among older children and adults, I would describe this two-factor structure as being anchored by a contrast between the more abstract, cognitive capacities of the MIND vs. a set of warmer, more visercal experiences that constitute a more integrated representation of BODY-HEART.

##### Three-factor solution

```{r}
cong_efa_wdm_d3_ad_46 <- cong_table_fun(efa_ad = efa_wdm_d3_ad,
                                        efa_ch = efa_wdm_d3_46,
                                        factor_names_efa_wdm_d3_ad)
cong_efa_wdm_d3_ad_46
```

```{r}
factor_names_efa_wdm_d3_46 <- c("BODY*", "MIND", "HEART*")
```

I will now turn to the three-factor solution suggested by the factor retention criteria employed in the original publication of Study 1 (Weisman et al., 2017). Importantly, this is also the number of factors retained among US adults and older children in this study.

After rotation, the first factor corresponded primarily to physiological sensations, as well as some positive emotions. An analysis of factor congruence indicated that this factor was most similar to adults' BODY factor, but was also quite similar to adults' HEART factor (`r cong_report_fun(efa_ad = efa_wdm_d3_ad, efa_ch = efa_wdm_d3_46, factor = "F1", factor_names_ad = c("BODY", "HEART", "MIND"))`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d3_46, 4, "F1", "pos")`, and accounted for `r round(efa_wdm_d3_46$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d3_46$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to perceptual-cognitive abilities, as well as one complex negative emotion (_feel guilty_). An analysis of factor congruence confirmed that this factor was most similar to adults' MIND factor (`r cong_report_fun(efa_ad = efa_wdm_d3_ad, efa_ch = efa_wdm_d3_46, factor = "F2", factor_names_ad = c("BODY", "HEART", "MIND"))`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d3_46, 4, "F2", "pos")`, and accounted for `r round(efa_wdm_d3_46$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d3_46$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor corresponded primarily to social-emotional abilities, with particularly strong loadings for positive emotions. An analysis of factor congruence indicated that this factor was most similar to adults' HEART factor, but also quite similar to adults' BODY factor (`r cong_report_fun(efa_ad = efa_wdm_d3_ad, efa_ch = efa_wdm_d3_46, factor = "F3", factor_names_ad = c("BODY", "HEART", "MIND"))`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d3_46, 4, "F3", "pos")`, and accounted for `r round(efa_wdm_d3_46$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d3_46$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions.

Together, these three factors accounted for `r round(sum(efa_wdm_d3_46$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.3 for all factor loadings, and Table 3.2 for cosine similarities between child and adult factors.

I would describe this conceptual structure as reminiscent of the BODY-HEART-MIND structure found among older children and adults, but not as fully "adult-like." In particular, in this solution, the physiological sensations associated with the BODY among older children and adults are not as clearly differentiated from the emotional experiences associated with the HEART. Indeed, it it not clear that BODY vs. HEART is the most salient distinction among the first and third factors in this solution; a cleaner description of these factors might be negatively-valenced experiences vs. positively-valenced experiences. 

```{r}
plot_efa_wdm_d3_ad <- heatmap_fun(efa_wdm_d3_ad, factor_names_efa_wdm_d3_ad) +
  labs(title = "Adults", subtitle = "3-factor solution") +
  theme(legend.position = "none")
plot_efa_wdm_d3_79 <- heatmap_fun(efa_wdm_d3_79, factor_names_efa_wdm_d3_79) +
  labs(title = "Older children, 7-9y", subtitle = "3-factor solution") +
  theme(legend.position = "none")
plot_efa_wdm_d3_46 <- heatmap_fun(efa_wdm_d3_46, factor_names_efa_wdm_d3_46) +
  labs(title = "Younger children, 4-6y", subtitle = "3-factor solution") +
  theme(legend.position = "none")
plot_efa_par_d3_46 <- heatmap_fun(efa_par_d3_46, factor_names_efa_par_d3_46) +
  labs(title = "Younger children, 4-6y", subtitle = "2-factor solution")
```

```{r}
figure3.3 <- plot_grid(plot_efa_wdm_d3_ad, plot_efa_wdm_d3_79,
                       plot_efa_wdm_d3_46, plot_efa_par_d3_46,
                       labels = "AUTO", ncol = 4, rel_widths = c(1, 1, 1, 1))

figure3.3_cap <- add_sub(figure3.3, str_wrap("Figure 3.3: Factor loadings from exploratory factor analyses of Study 3, in which participants assessed one of nine diverse target characters. (A) Results for US adults. (B) Results for US children ages 7-9y. (C) Results for US children ages 4-6y, retaining three factors (as suggested by the original factor retention criteria reported in Weisman et al., 2017). (D) Results for US children ages 4-6y, retaining two factors (as suggested parallel analysis). In this and all figures portraying factor loadings, factors have been plotted in the same order (BODY, HEART, MIND), when applicable, to facilitate comparison across studies. A factor loading of +1 indicates a perfectly positive relationship between mental capacity and underlying construct; a loading of -1 indicates a perfectly negative relationship.", 210), x = 0, hjust = 0)
```

```{r figure3.3, include = T, fig.width = 9, fig.asp = 0.6}
ggdraw(figure3.3_cap)
```

## Discussion

The results of Study 3 suggest that the three-part conceptual structure—anchored by BODY, HEART, and MIND—is reliable and robust among 7- to 9-year-old US children. As with adults in Study 1 (see also Weisman et al., 2017), the capacities that "hang together" in older children's reasoning when target characters are perceived to vary in mental capacity profiles appear to be highly similar to those that "hang together" when participants disagree about the mental lives of controversial "edge cases" in social reasoning (Study 2).

Meanwhile, this study suggests that this conceptual structure undergoes substantial changes between early and middle childhood. Like older children and adults, 4- to 6-year-old children’s responses were characterized by strong correlations among a suite of perceptual and cognitive capacities that I have labeled MIND. This highlights one aspect of conceptual structure that seems to be relatively stable from early childhood onward. However, in contrast to the clear distinction between physiological abilities and social-emotional abilities that characterized mental capacity attributions among older children and adults, younger children’s responses suggest that they perceived physiological and social-emotional abilities to be more closely integrated and the line between them to be more blurred.

```{r}
efa_par_d3_46_highload <- loadings_fun(efa_par_d3_46, "long") %>% 
  filter(loading >= 0.60) %>%
  arrange(factor, desc(loading)) %>%
  group_by(capacity) %>%
  mutate(adult_factor = case_when(
    grepl(capacity, 
          top_n_domCap(efa_wdm_d3_ad, 20, "F1", "pos")) == T ~ "BODY",
    grepl(capacity, 
          top_n_domCap(efa_wdm_d3_ad, 20, "F2", "pos")) == T ~ "HEART",
    grepl(capacity, 
          top_n_domCap(efa_wdm_d3_ad, 20, "F3", "pos")) == T ~ "MIND",
    TRUE ~ "no dominant factor")) %>%
  ungroup()
efa_par_d3_46_highload
```

One indication of this blurring comes from the two-factor solution suggested by parallel analysis, in which a single BODY-HEART factor emerged and was highly congruent with both the BODY and HEART factors of adults (cosine similarity with BODY: `r cong_efa_par_d3_ad_46["F1", "BODY"]`; with HEART: `r cong_efa_par_d3_ad_46["F1", "HEART"]`) factors of adults. Among the mental capacities that loaded strongly ($\geq$ 0.60) on this factor were both physiological sensations (e.g., `r ital_by_cap_fun(efa_par_d3_46_highload$capacity[efa_par_d3_46_highload$adult_factor=="BODY" & efa_par_d3_46_highload$factor == "F1" & efa_par_d3_46_highload$capacity != "get angry"])`) and social-emotional experiences (`r ital_by_cap_fun(efa_par_d3_46_highload$capacity[efa_par_d3_46_highload$adult_factor=="HEART" & efa_par_d3_46_highload$factor == "F1"])`), suggesting that younger children perceived physiological and social-emotional abilities to "go together" to a considerable degree.

```{r}
efa_wdm_d3_46_domCap <- loadings_fun(efa_wdm_d3_46, "long") %>% 
  arrange(desc(loading)) %>%
  group_by(capacity) %>%
  top_n(1, loading) %>%
  mutate(adult_factor = case_when(
    grepl(capacity, 
          top_n_domCap(efa_wdm_d3_ad, 20, "F1", "pos")) == T ~ "BODY",
    grepl(capacity, 
          top_n_domCap(efa_wdm_d3_ad, 20, "F2", "pos")) == T ~ "HEART",
    grepl(capacity, 
          top_n_domCap(efa_wdm_d3_ad, 20, "F3", "pos")) == T ~ "MIND",
    TRUE ~ "no dominant factor")) %>%
  ungroup() %>%
  arrange(factor, desc(loading))
efa_wdm_d3_46_domCap
```

```{r}
efa_wdm_d3_46_lowload <- loadings_fun(efa_wdm_d3_46, "long") %>% 
  filter(loading <= 0.40) %>%
  arrange(factor, desc(loading)) %>%
  group_by(factor, capacity) %>%
  mutate(adult_factor = case_when(
    grepl(capacity, 
          top_n_domCap(efa_wdm_d3_ad, 20, "F1", "pos")) == T ~ "BODY",
    grepl(capacity, 
          top_n_domCap(efa_wdm_d3_ad, 20, "F2", "pos")) == T ~ "HEART",
    grepl(capacity, 
          top_n_domCap(efa_wdm_d3_ad, 20, "F3", "pos")) == T ~ "MIND",
    TRUE ~ "no dominant factor")) %>%
  ungroup()
efa_wdm_d3_46_lowload
```

Even in the three-factor solution suggested by the original factor retention criteria reported in Weisman et al. (2017), the distinction between physiological and social-emotional abilities was somewhat blurred. While the first factor, which I have labeled BODY\*, was highly congruent with adults' BODY factor (cosine similarity: `r cong_efa_wdm_d3_ad_46["F1", "BODY"]`), it was also the dominant factor for two canonical social-emotional items (`r ital_by_cap_fun(efa_wdm_d3_46_domCap$capacity[efa_wdm_d3_46_domCap$factor == "F1" & efa_wdm_d3_46_domCap$adult_factor == "HEART"])`). And while the third factor, which I have labeled HEART\*, was highly congruent with adults' HEART factor (cosine similarity: `r cong_efa_wdm_d3_ad_46["F3", "HEART"]`), there were several canonical social-emotional items that failed to load strongly on it (loadings $\leq$ 0.40: `r ital_by_cap_fun(efa_wdm_d3_46_lowload$capacity[efa_wdm_d3_46_lowload$factor == "F3" & efa_wdm_d3_46_lowload$adult_factor == "HEART"])`). Stepping back, it is not clear that "physiological vs. social-emotional" is the best way to characterize the differences between these two factors. In fact, given that the strongest-loading items for BODY\* were negatively valenced (`r gsub("and ", "", top_n_domCap(efa_wdm_d3_46, 3, "F1", "abs"))`) while the strongest-loading items for HEART\* were positively valenced (`r gsub("and ", "", top_n_domCap(efa_wdm_d3_46, 3, "F3", "abs"))`), it seems plausible that the more salient distinction among this age group may have been positive vs. negative valence, rather than BODY vs. HEART. The salience of negative vs. positive experiences among younger children is consistent with recent work on the development of emotion concepts, which suggests that emotion representations are dominanted by a single dimension of valence in early to middle childhood, before unfolding into a two-dimensional space characterized by valence and arousal over the course of later childhood and adolesence (Nook et al., 2017).

Finally, the very fact that different approaches to factor retention yielded different results is further evidence that, although there is some evidence for a nascent distinction between BODY and HEART among 4- to 6-year-old children, this distinction was not as robust as it appeared to be among older children or adults.

# Study 4: A focus on early childhood (4-5y)

One major limitation of Studies 2 and 3 was that the study protocol involved a rather advanced set of mental state vocabulary terms, including a variety of complex mental capacities (e.g., guilt, pride, awareness, depth perception) and using somewhat complicated syntax for some items (e.g., _sense whether something is close by or far away_, _figure out how to do things_). For 4- to 6-year-old children, in particular, some of the mental capacity items might have been outside of the range of words they normally hear in discussions of mental states—let alone the words they normally use themselves. In addition, younger children may have found some aspects of the experimental paradigm distracting (e.g., being seated in front of the experimenter's laptop computer without being allowed to use it themselves) or difficult (e.g., using a three-point scale with minimal visual scaffolding).

With these considerations in mind, in Study 4 I focused on 4- to 5-year-old children, using a simpler set of mental capacities and a streamlined version of the experimental paradigm, with the aim of getting a clearer picture of conceptual structure and mental capacity attributions at this earlier point in development.

In Study 4, `r nrow(d4_ad_wide)/2` US adults and `r nrow(d4_46_wide)/2` US children between the ages of `r summary(d4_46$age)["Min."] %>% round(2)`-`r summary(d4_46$age)["Max."] %>% round(2)`y (median: `r summary(d4_46$age)["Median"] %>% round(2)`y) each assessed two target characters on 18 mental capacities. To make the study appropriate for children in this age range, this study employed a new set of 18 mental capacities (some but not all of which were used in Studies 1-3). In addition, participants were presented with a more child-friendly visual representation of the three-point response scale ("no," coded as 0; "kinda," coded as 0.5, "yes," coded as 1). This study employed the "edge case" variant of the general approach, with participants assessing both a beetle or a robot in sequence (with order counterbalanced across participants). (See Chapter II for detailed methods.)

As briefly described in Chapter II, the 18 mental capacities employed in Study 4 were selected from a larger pilot study in which 3- to 5-year-old children were asked to complete stories that began with each of these mental capacities as a premise (e.g., "Let's imagine a person who _loves someone_. What happens next?"; "Now let's pretend that someone _remembers something_. What happens next?") and were judged on the appropriateness of their story completion. 

Among the items that emerged from this pilot study as reasonable candidates for inclusion in Study 4, I selected items to represented the three "conceptual units" revealed by Studies 1-3 (BODY, HEART, and MIND). The goal here was to create a conservative test of developmental differences between younger and older children in the "conceptual units" observed in Study 3, by constructing materials that should maximize the chances of observing the same (or similar) conceptual units among young children as were observed among older children and adults in Studies 1-3. If 4- to 5-year-old children in fact have access to conceptual units similar to BODY, HEART, and MIND, the mental capacities employed in Study 4 (and the generally more child-friendly protocol) should provide the best chances of surfaces this conceptual structure. Conversely, if Study 4 reveals differences in conceptual structure despite these modifications, and despite "stacking the odds" against developmental differences in the selction of mental capacities, this provides stronger evidence for conceptual change in the number and/or kind of conceptual units available to children at different points in development.

The final set of BODY items included _feel hungry_, _get thirsty_, _feel sick_, _feel tired_, _get scared_, and _smell things_. HEART items included _love someone_, _hate someone_, _feel happy_, _get sad_, _feel sorry_, and _get lonely_. MIND items included _see_, _hear_, _think_, _remember things_, _know stuff_, and _figure things out_ (see also Table 2.1 in Chapter II). I ensured that each category included a variety of phrasings (e.g., "_feel_ hungry" vs. "_get_ thirsty"; "remember _things_" vs. "know _stuff_") and valences when appropriate (e.g., happiness vs. sadness); when possible, I aimed to have these aspects of phrasing vary orthogonally with categories, such that the framings "get X" vs. "feel X" appeared roughly equally often among the BODY and HEART items, and the word "things" appeared equally often among the BODY and MIND items.

## Special notes on data processing and analysis

In Study 4, participants assessed two target characters side by side (in contrast to Studies 1a, 1b, 1d, 2, and 3, in which each participant assessed just one target character). In the current analyses, I treat each participant's assessments of each target character as a separate set of observations (as if they came from different participants), in effect doubling the sample size for these studies (but ignoring the within-subject design).

## Results

### Adults

#### How many conceptual units?

```{r}
reten_report["Study 4: Adults",]
```

```{r}
efa_par_d4_ad <- fa_fun(d4_ad_wide_i, reten_report["Study 4: Adults", "par"])
efa_bic_d4_ad <- fa_fun(d4_ad_wide_i, reten_report["Study 4: Adults", "bic"])
efa_wdm_d4_ad <- fa_fun(d4_ad_wide_i, reten_report["Study 4: Adults", "wdm"])

saveRDS(efa_par_d4_ad, file = "./efas/efa_par_d4_ad")
saveRDS(efa_bic_d4_ad, file = "./efas/efa_bic_d4_ad")
saveRDS(efa_wdm_d4_ad, file = "./efas/efa_wdm_d4_ad")

# efa_par_d4_ad <- readRDS(file = "./efas/efa_par_d4_ad")
# efa_bic_d4_ad <- readRDS(file = "./efas/efa_bic_d4_ad")
# efa_wdm_d4_ad <- readRDS(file = "./efas/efa_wdm_d4_ad")
```

All three protocols for determining how many factors to retain suggested retaining three factors; see Table 3.1.

#### What are these conceptual units?

```{r}
factor_names_efa_wdm_d4_ad <- c("BODY", "HEART", "MIND")
```

After rotation, the first factor corresponded primarily to physiological sensations (BODY). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d4_ad, 4, "F1", "pos")`, and accounted for `r round(efa_wdm_d4_ad$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d3_46$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions, and `r round(efa_wdm_d4_ad$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to social-emotional abilities (HEART). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d4_ad, 4, "F2", "pos")`, and accounted for `r round(efa_wdm_d4_ad$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d4_ad$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor corresponded primarily to perceptual-cognitive abilities (MIND). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d4_ad, 4, "F3", "pos")`, and accounted for `r round(efa_wdm_d4_ad$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_wdm_d4_ad$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions.

Together, these three factors accounted for `r round(sum(efa_wdm_d4_ad$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.4 for all factor loadings.

In sum, as in Studies 1-3, EFA of adults' responese revealed a conceptual structure characterized by a three-way distinction between BODY, HEART, and MIND. This suggests that the modified preschooler-friendly paradigm was valid: Using simpler vocabulary and a within-subjects approach to taget characters elicited the same intuitive ontology of mental life, among US adults, that was revealed in Studies 1-3. 

### Children (4-5y)

#### How many conceptual units?

```{r}
reten_report["Study 4: Children",]
```

```{r}
efa_par_d4_46 <- fa_fun(d4_46_wide_i, reten_report["Study 4: Children", "par"])
efa_bic_d4_46 <- fa_fun(d4_46_wide_i, reten_report["Study 4: Children", "bic"])
efa_wdm_d4_46 <- fa_fun(d4_46_wide_i, reten_report["Study 4: Children", "wdm"])

saveRDS(efa_par_d4_46, file = "./efas/efa_par_d4_46")
saveRDS(efa_bic_d4_46, file = "./efas/efa_bic_d4_46")
saveRDS(efa_wdm_d4_46, file = "./efas/efa_wdm_d4_46")

# efa_par_d4_46 <- readRDS(file = "./efas/efa_par_d4_46")
# efa_bic_d4_46 <- readRDS(file = "./efas/efa_bic_d4_46")
# efa_wdm_d4_46 <- readRDS(file = "./efas/efa_wdm_d4_46")
```

```{r}
efa_bic_d4_46$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_bic_d4_46)
loadings_summarize_fun(efa_bic_d4_46) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

```{r}
efa_par_d4_46$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_par_d4_46)
loadings_summarize_fun(efa_par_d4_46) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

```{r}
efa_wdm_d4_46$Vaccounted %>% data.frame() %>% round(2)
loadings_count_dom_fun(efa_wdm_d4_46)
loadings_summarize_fun(efa_wdm_d4_46) %>% 
  mutate_at(vars(-factor), funs(round(., 2)))
```

Each of the three factor retention protocols suggested a different number of factors to retain; see Table 3.1.

As among younger children in Study 3, minimizing BIC suggested a null solution consisting of a single factor; in other words, this protocol indicated that the correlation structure of children's responses provided no evidence for distinct latent constructs.  

Meanwhile, parallel analysis suggested retaining three factors, and the retention criteria used in Weisman et al. (2017) suggested retaining four factors. In both the three- and four-factor solutions, each factor accounted for a substantial amount of the shared variance, was the dominant factor for several mental capacities, and had at least moderately strong factor loadings for some subset of mental capacities.

Given all this, I will present and interpret both three- and four-factor solutions; see Appendix A for the null, one-factor solution suggested by minimizing BIC.

#### What are these conceptual units?

##### Three-factor solution

```{r}
cong_efa_par_d4_ad_46 <- cong_table_fun(efa_ad = efa_wdm_d4_ad,
                                        efa_ch = efa_par_d4_46,
                                        factor_names_efa_wdm_d4_ad)
cong_efa_par_d4_ad_46
```

```{r}
factor_names_efa_par_d4_46 <- c("BODY", "MIND", "HEART")
```

First, I will examine the three-factor solution suggested by parallel analysis.  Importantly, this is also the number of factors retained among US adults in this study.

After rotation, the first factor corresponded primarily to physiological sensations. An analysis of factor congruence indicated that this factor was most similar to adults' BODY factor (`r cong_report_fun(efa_ad = efa_par_d4_ad, efa_ch = efa_par_d4_46, factor = "F1", factor_names_ad = factor_names_efa_wdm_d4_ad)`). It was the dominant factor for such items as `r top_n_domCap(efa_par_d4_46, 4, "F1", "pos")`, and accounted for `r round(efa_par_d4_46$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_par_d4_46$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to perceptual-cognitive abilities. An analysis of factor congruence confirmed that this factor was most similar to adults' MIND factor (`r cong_report_fun(efa_ad = efa_par_d4_ad, efa_ch = efa_par_d4_46, factor = "F2", factor_names_ad = factor_names_efa_wdm_d4_ad)`). It was the dominant factor for such items as `r top_n_domCap(efa_par_d4_46, 4, "F2", "pos")`, and accounted for `r round(efa_par_d4_46$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_par_d4_46$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor corresponded primarily to social-emotional abilities. An analysis of factor congruence confirmed that this factor was most similar to adults' HEART factor (`r cong_report_fun(efa_ad = efa_par_d4_ad, efa_ch = efa_par_d4_46, factor = "F3", factor_names_ad = factor_names_efa_wdm_d4_ad)`). It was the dominant factor for such items as `r top_n_domCap(efa_par_d4_46, 4, "F3", "pos")`, and accounted for `r round(efa_par_d4_46$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution, and `r round(efa_par_d4_46$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions.

Together, these three factors accounted for `r round(sum(efa_par_d4_46$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.4 for all factor loadings, and Table 3.2 for cosine similarities between child and adult factors.

I would describe this conceptual structure as strongly reminiscent of the BODY-HEART-MIND structure found among older children and adults. 

__CHECK BACK WITH MORE DATA!__

##### Four-factor solution

```{r}
cong_efa_wdm_d4_ad_46 <- cong_table_fun(efa_ad = efa_wdm_d4_ad,
                                        efa_ch = efa_wdm_d4_46,
                                        factor_names_efa_wdm_d4_ad)
cong_efa_wdm_d4_ad_46
```

```{r}
factor_names_efa_wdm_d4_46 <- c("MIND*", "BODY (nausea)", 
                                "BODY (other)", "HEART*")
```

I will now turn to the four-factor solution suggested by the factor retention criteria employed in the original publication of Study 1 (Weisman et al., 2017).

After rotation, the first factor corresponded primarily to perceptual-cognitive abilities, as well as some positive social-emotional abilities (e.g., _love someone_, _feel happy_). An analysis of factor congruence indicated that this factor was most similar to adults' MIND factor (`r cong_report_fun(efa_ad = efa_wdm_d4_ad, efa_ch = efa_wdm_d4_46, factor = "F1", factor_names_ad = factor_names_efa_wdm_d4_ad)`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d4_46, 4, "F1", "pos")`, and accounted for `r round(efa_wdm_d4_46$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated four-factor solution, and `r round(efa_wdm_d4_46$Vaccounted["Proportion Var", "F1"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The second factor corresponded primarily to physiological sensations, with an exceptionally strong factor loading for _feel sick_. An analysis of factor congruence confirmed that this factor was most similar to adults' BODY factor (`r cong_report_fun(efa_ad = efa_wdm_d4_ad, efa_ch = efa_wdm_d4_46, factor = "F2", factor_names_ad = factor_names_efa_wdm_d4_ad)`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d4_46, 4, "F2", "pos")`, and accounted for `r round(efa_wdm_d4_46$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated four-factor solution, and `r round(efa_wdm_d4_46$Vaccounted["Proportion Var", "F2"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The third factor also corresponded primarily to physiological sensations, as well as some perceptual abilties (e.g., _hear_, _see_). An analysis of factor congruence indicated that this factor was most similar to adults' BODY factor (`r cong_report_fun(efa_ad = efa_wdm_d4_ad, efa_ch = efa_wdm_d4_46, factor = "F3", factor_names_ad = factor_names_efa_wdm_d4_ad)`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d4_46, 4, "F3", "pos")`, and accounted for `r round(efa_wdm_d4_46$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated four-factor solution, and `r round(efa_wdm_d4_46$Vaccounted["Proportion Var", "F3"], 2) * 100`% of the total variance in participants' mental capacity attributions.

The fourth factor corresponded primarily to social-emotional abilities, particularly negative emotions. An analysis of factor congruence indicated that this factor was most similar to adults' HEART factor (`r cong_report_fun(efa_ad = efa_wdm_d4_ad, efa_ch = efa_wdm_d4_46, factor = "F4", factor_names_ad = factor_names_efa_wdm_d4_ad)`). It was the dominant factor for such items as `r top_n_domCap(efa_wdm_d4_46, 4, "F4", "pos")`, and accounted for `r round(efa_wdm_d4_46$Vaccounted["Proportion Explained", "F4"], 2) * 100`% of the shared variance in the rotated four-factor solution, and `r round(efa_wdm_d4_46$Vaccounted["Proportion Var", "F4"], 2) * 100`% of the total variance in participants' mental capacity attributions.

Together, these three factors accounted for `r round(sum(efa_wdm_d4_46$Vaccounted["Proportion Var", ]), 2) * 100`% of the total variance in participants' mental capacity attributions.

See Figure 3.4 for all factor loadings, and Table 3.2 for cosine similarities between child and adult factors.

I would summarize the four-factor solution as a variant on the three-factor solutions common among adults and older children in Studies 1-3 (and surfaced the three-factor solution discussed in the previous section). This solution is characterized by distinct constructs of HEART and MIND, suggests a further differention of what I've referred to as BODY into sub-categories that are not easy to label or describe.

__CHECK BACK WITH MORE DATA!__

```{r}
plot_efa_wdm_d4_ad <- heatmap_fun(efa_wdm_d4_ad, factor_names_efa_wdm_d4_ad) +
  labs(title = "Adults", subtitle = "3-factor solution") +
  theme(legend.position = "none")
plot_efa_par_d4_46 <- heatmap_fun(efa_par_d4_46, factor_names_efa_par_d4_46) +
  labs(title = "Younger children, 4-5y", subtitle = "3-factor solution") +
  theme(legend.position = "none")
plot_efa_wdm_d4_46 <- heatmap_fun(efa_wdm_d4_46, factor_names_efa_wdm_d4_46) +
  labs(title = "Younger children, 4-5y", subtitle = "4-factor solution")
```

```{r}
figure3.4 <- plot_grid(plot_efa_wdm_d4_ad, plot_efa_par_d4_46,
                       plot_efa_wdm_d4_46,
                       labels = "AUTO", ncol = 3, rel_widths = c(1, 1, 1.4))

figure3.4_cap <- add_sub(figure3.4, str_wrap("Figure 3.4: Factor loadings from exploratory factor analyses of Study 4, in which participants assessed two 'edge case' target characters (a beetle and a robot), one after another (with order counterbalanced across participants). (A) Results for US adults. (B) Results for US children ages 4-5y, retaining three factors (as suggested by parallel analysis). (C) Results for US children ages 4-5y, retaining four factors (as suggested by the original factor retention criteria reported in Weisman et al., 2017). In this and all figures portraying factor loadings, factors have been plotted in the same order (BODY, HEART, MIND), when applicable, to facilitate comparison across studies. A factor loading of +1 indicates a perfectly positive relationship between mental capacity and underlying construct; a loading of -1 indicates a perfectly negative relationship.", 210), x = 0, hjust = 0)
```

```{r figure3.4, include = T, fig.width = 9, fig.asp = 0.6}
ggdraw(figure3.4_cap)
```

```{r}
cong_report <- bind_rows(cong_efa_wdm_d2_ad_79 %>%
                           data.frame() %>%
                           remove_rownames() %>%
                           mutate(order = 1, 
                                  study = "Study 2",
                                  age_group = "7-9y",
                                  solution = "3-factor",
                                  ch_factor = factor_names_efa_wdm_d2_79),
                         cong_efa_wdm_d3_ad_79 %>%
                           data.frame() %>%
                           remove_rownames() %>%
                           mutate(order = 2, 
                                  study = "Study 3",
                                  age_group = "7-9y",
                                  solution = "3-factor",
                                  ch_factor = factor_names_efa_wdm_d3_79),
                         cong_efa_wdm_d3_ad_46 %>%
                           data.frame() %>%
                           remove_rownames() %>%
                           mutate(order = 3, 
                                  study = "Study 3",
                                  age_group = "4-6y",
                                  solution = "3-factor",
                                  ch_factor = factor_names_efa_wdm_d3_46),
                         cong_efa_par_d3_ad_46 %>%
                           data.frame() %>%
                           remove_rownames() %>%
                           mutate(order = 4, 
                                  study = "Study 3",
                                  age_group = "4-6y",
                                  solution = "2-factor",
                                  ch_factor = factor_names_efa_par_d3_46),
                         cong_efa_par_d4_ad_46 %>%
                           data.frame() %>%
                           remove_rownames() %>%
                           mutate(order = 5, 
                                  study = "Study 4",
                                  age_group = "4-5y",
                                  solution = "3-factor",
                                  ch_factor = factor_names_efa_par_d4_46),
                         cong_efa_wdm_d4_ad_46 %>%
                           data.frame() %>%
                           remove_rownames() %>%
                           mutate(order = 6, 
                                  study = "Study 4",
                                  age_group = "4-5y",
                                  solution = "4-factor",
                                  ch_factor = factor_names_efa_wdm_d4_46)) %>%
  arrange(order, ch_factor) %>%
  select(study, age_group, solution, ch_factor, BODY, HEART, MIND)
cong_report
```

```{r}
table3.2 <- cong_report %>%
  select(-c(study, age_group, solution)) %>%
  mutate(ch_factor = gsub("F", "Factor ", ch_factor)) %>%
  rename(#`Age group` = age_group,
         `Children's factor` = ch_factor) %>%
  mutate_at(vars(BODY, HEART, MIND),
            funs(format(., nsmall = 2))) %>%
  mutate_at(vars(BODY, HEART, MIND),
            funs(cell_spec(., "html", 
                           bold = ifelse(abs(as.numeric(.)) >= 0.75, T, F)))) %>%
  kable(format = "html", escape = F, 
        align = c("l", rep("r", 3)),
        caption = "Table 3.2: Factor congruence (as indexed by cosine similarity) between children's and adults' factors from the three-factor solution for the corresponding study (BODY, HEART, and MIND columns). Results are grouped by study and age group. In principle, cosine similarities could range from -1 (which would indicate that two factors are perfect opposites of each other) to +1 (which would indicate that two factors are perfectly identical to each other). Cosine similarities with absolute values greater than or equal to 0.75 are marked in bold.") %>%  
  kable_styling() %>%
  group_rows("Study 2, 7- to 9-year-old children", 1, 3) %>%
  group_rows("Study 3, 7- to 9-year-old children", 4, 6) %>%
  group_rows("Study 3, 4- to 6-year-old children (3-factor solution)", 7, 9) %>%
  group_rows("Study 3, 4- to 6-year-old children (2-factor solution)", 10, 11) %>%
  group_rows("Study 4, 4- to 5-year-old children (3-factor solution)", 12, 14) %>%
  group_rows("Study 4, 4- to 5-year-old children (4-factor solution)", 15, 18)
  
  # collapse_rows(columns = 1:2, valign = "top") %>%
                # latex_hline = "custom", custom_latex_hline = 1)
```

```{r table3.2, include = T, results = "asis"}
table3.2
```

## Discussion

Using a paradigm that was better tailored for young children and that featured vocabulary items expressly designed to pick out (adult) notions of BODY, HEART, and MIND in a balanced way (6 items per factor), Study 4 provided some indications that the conceptual units available to young children may be more "adult-like" than Study 3 would suggest. However, even in this modified paradigm, there are several indications that this three-part conceptual structure is not fully mature by the age of 4-5y.

```{r}
efa_par_d4_46_modload <- loadings_fun(efa_par_d4_46, "long") %>% 
  filter(loading >= 0.40) %>%
  arrange(factor, desc(loading)) %>%
  group_by(capacity) %>%
  mutate(adult_factor = case_when(
    grepl(capacity, 
          top_n_domCap(efa_par_d4_ad, 18, "F1", "pos")) == T ~ "BODY",
    grepl(capacity, 
          top_n_domCap(efa_par_d4_ad, 18, "F2", "pos")) == T ~ "HEART",
    grepl(capacity, 
          top_n_domCap(efa_par_d4_ad, 18, "F3", "pos")) == T ~ "MIND",
    TRUE ~ "no dominant factor")) %>%
  ungroup()
efa_par_d4_46_modload
```

```{r}
efa_par_d4_46_lowload <- loadings_fun(efa_par_d4_46, "long") %>% 
  filter(loading < 0.30) %>%
  arrange(factor, desc(loading)) %>%
  group_by(capacity) %>%
  mutate(adult_factor = case_when(
    grepl(capacity, 
          top_n_domCap(efa_par_d4_ad, 18, "F1", "pos")) == T ~ "BODY",
    grepl(capacity, 
          top_n_domCap(efa_par_d4_ad, 18, "F2", "pos")) == T ~ "HEART",
    grepl(capacity, 
          top_n_domCap(efa_par_d4_ad, 18, "F3", "pos")) == T ~ "MIND",
    TRUE ~ "no dominant factor")) %>%
  ungroup()
efa_par_d4_46_lowload
```

```{r}
efa_par_d4_46_domCap <- loadings_fun(efa_par_d4_46, "long") %>% 
  arrange(desc(loading)) %>%
  group_by(capacity) %>%
  top_n(1, loading) %>%
  mutate(adult_factor = case_when(
    grepl(capacity, 
          top_n_domCap(efa_par_d4_ad, 18, "F1", "pos")) == T ~ "BODY",
    grepl(capacity, 
          top_n_domCap(efa_par_d4_ad, 18, "F2", "pos")) == T ~ "HEART",
    grepl(capacity, 
          top_n_domCap(efa_par_d4_ad, 18, "F3", "pos")) == T ~ "MIND",
    TRUE ~ "no dominant factor")) %>%
  ungroup() %>%
  arrange(factor, desc(loading))
efa_par_d4_46_domCap
```

```{r}
efa_wdm_d4_46_modload <- loadings_fun(efa_wdm_d4_46, "long") %>% 
  filter(loading >= 0.40) %>%
  arrange(factor, desc(loading)) %>%
  group_by(capacity) %>%
  mutate(adult_factor = case_when(
    grepl(capacity, 
          top_n_domCap(efa_wdm_d4_ad, 18, "F1", "pos")) == T ~ "BODY",
    grepl(capacity, 
          top_n_domCap(efa_wdm_d4_ad, 18, "F2", "pos")) == T ~ "HEART",
    grepl(capacity, 
          top_n_domCap(efa_wdm_d4_ad, 18, "F3", "pos")) == T ~ "MIND",
    TRUE ~ "no dominant factor")) %>%
  ungroup()
efa_wdm_d4_46_modload
```

```{r}
efa_wdm_d4_46_lowload <- loadings_fun(efa_wdm_d4_46, "long") %>% 
  filter(loading < 0.30) %>%
  arrange(factor, desc(loading)) %>%
  group_by(capacity) %>%
  mutate(adult_factor = case_when(
    grepl(capacity, 
          top_n_domCap(efa_wdm_d4_ad, 18, "F1", "pos")) == T ~ "BODY",
    grepl(capacity, 
          top_n_domCap(efa_wdm_d4_ad, 18, "F2", "pos")) == T ~ "HEART",
    grepl(capacity, 
          top_n_domCap(efa_wdm_d4_ad, 18, "F3", "pos")) == T ~ "MIND",
    TRUE ~ "no dominant factor")) %>%
  ungroup()
efa_wdm_d4_46_lowload
```

```{r}
efa_wdm_d4_46_domCap <- loadings_fun(efa_wdm_d4_46, "long") %>% 
  arrange(desc(loading)) %>%
  group_by(capacity) %>%
  top_n(1, loading) %>%
  mutate(adult_factor = case_when(
    grepl(capacity, 
          top_n_domCap(efa_wdm_d4_ad, 18, "F1", "pos")) == T ~ "BODY",
    grepl(capacity, 
          top_n_domCap(efa_wdm_d4_ad, 18, "F2", "pos")) == T ~ "HEART",
    grepl(capacity, 
          top_n_domCap(efa_wdm_d4_ad, 18, "F3", "pos")) == T ~ "MIND",
    TRUE ~ "no dominant factor")) %>%
  ungroup() %>%
  arrange(factor, desc(loading))
efa_wdm_d4_46_domCap
```

First, the similarities. As with the younger (4- to 6-year-old) children in Study 3, 4- to 5-year-old children’s responses in Study 4 were characterized by strong correlations among a suite of perceptual and cognitive capacities that I have been referring to as MIND. This suite of MIND abilities was relatively robust to analysis choices and emerged clearly in both Studies 2 and 3, bolstering my earlier claim that this is one aspect of conceptual structure that may be relatively stable from early in childhood. 

Study 4 suggests that these similarities may extend even further. The three-factor solution suggested by parallel analysis includes recognizable BODY and MIND factors as well as a nascent HEART\* factor, on which half of the mental capacities that were designated as HEART items a priori loaded moderately strongly (loadings $\geq$ 0.40: `r ital_by_cap_fun(efa_par_d4_46_modload$capacity[efa_par_d4_46_modload$adult_factor == "HEART" & efa_par_d4_46_modload$factor == "F3"])`). (The four-factor solution includes a very similar HEART-like factor; see Figure 3.4.) This is a substantially more adult-like conceptual structure than was observed among 4- to 6-year-old children in Study 3.

However, as in Study 3, the very fact that different approaches to factor retention yielded different results is further evidence that this BODY-HEART-MIND framework is not exactly "robust" among preschool-age children. 

Consider first young children's understanding of the social-emotional abilities that we designated as representative of HEART. In Study 3, the social-emotional domain appeared to be the site of the most striking differences between 4- to 6-year-old children, on the one hand, and older children and adults on the other. EFAs of 4- to 5-year-old children’s responses in Study 4 offer convergent evidence that young children may not consider the social-emotional abilities that constitute what I have called HEART among adults to hang together as one clearly distinct component of mental life. Even in the more adult-like, three-factor solution suggested by parallel analysis, two of the six designated HEART items did _not_ load strongly on the ostensive HEART\* factor (loadings $\leq$ 0.30: `r ital_by_cap_fun(efa_par_d4_46_lowload$capacity[efa_par_d4_46_lowload$adult_factor == "HEART" & efa_par_d4_46_lowload$factor == "F3"])`); indeed, the dominant factor for these two items was MIND\*, not HEART\*. (These observations also hold in the four-factor solution suggested by Weisman et al.'s (2017) original factor retention protocol; in fact, in this solution, MIND\* was the dominant factor for three of the six designated HEART items.) As a point of comparison, among adults in Study 4 all six of the designated HEART items loaded most strongly on the HEART factor, suggesting these divergent patterns are not due merely to the use of a new set of mental capacity terms.

In addition, Study 4 provides new evidence that young children's understanding of the domain of physiological sensations (BODY) may also diverge from that of adults. In the more adult-like three-factor solution, the factor that I have labeled BODY\* elicited strong factor loadings (loadings $\geq$ 0.40) from one designated HEART item (`r ital_by_cap_fun(efa_par_d4_46_modload$capacity[efa_par_d4_46_modload$adult_factor == "HEART" & efa_par_d4_46_modload$factor == "F1"])`) and one designated MIND item (`r ital_by_cap_fun(efa_par_d4_46_modload$capacity[efa_par_d4_46_modload$adult_factor == "MIND" & efa_par_d4_46_modload$factor == "F1"])`), in addition to the six canonical physiological sensations that were designated as BODY items a priori. Moreover, in the four-factor solution physiological sensations actually differentiated into two distinct factors (though not on any easily interpretable line, in my view). Again, among adults in Study 4 all six of the designated BODY items loaded most strongly on the BODY factor, suggesting these divergent patterns are not due merely to the use of a new set of mental capacity terms. Instead, these results suggest that the conceptual unit that I have called BODY may not be as robust, distinct, and unified among young children as it appears to be among adults.


# Comparing the "size" of conceptual units across Studies 1-4

In the previous sections in this chapter, I described EFA results for Studies 1-4 and offered both qualitative comparisons of the "meaning" of the conceptual units revealed by these analyses and quantitative assessments of the similarity of conceptual units across different age groups within each study (see Table 3.2). In this final section, I explore one additional aspect of these analyses: the "size" of the conceptual units identified in each sample. In each set of results, I have included two ways of gauging size: by assessing the proportion of _shared_ variance explained by a factor, and by assessing the proportion of _total_ variance explained by a factor. Here I discuss these indices of factor size in more detail and compare the size of these factors across samples. 

## Proportion of shared variance explained

For each EFA solution, the shared variance explained by all of the retained factors is, by definition, 100%. The proportion of this shared variance explained by a single factor can be calculated by dividing the sum of squared loadings for that factor by the sum of the sum of squared loadings for all factors. This allows the researcher to gauge the relative "size" of each of the factors retained in that solution. For example, in a three-factor solution, if all factors were of equal size, each would account for 33% of the shared variance; if one factor instead accounted for 50% of the shared variance and the others each accounted for 25%, this would provide some evidence that the first factor is in some sense larger or more important than the other two factors.

```{r}
var_shared_report <- bind_rows(
  # study 1
  vac_fun(efa_wdm_d1a_ad, factor_names_efa_wdm_d1a_ad) %>%
    mutate(order = 1, study = "Study 1a",
           sample = "1a", solution = "3-factor"),
  vac_fun(efa_wdm_d1b_ad, factor_names_efa_wdm_d1b_ad) %>%
    mutate(order = 1, study = "Study 1b",
           sample = "1b", solution = "3-factor"),
  vac_fun(efa_wdm_d1c_ad, factor_names_efa_wdm_d1c_ad) %>%
    mutate(order = 1, study = "Study 1c",
           sample = "1c", solution = "3-factor"),
  vac_fun(efa_wdm_d1d_ad, factor_names_efa_wdm_d1d_ad) %>%
    mutate(order = 1, study = "Study 1d",
           sample = "1d", solution = "3-factor"),
  # study 2
  vac_fun(efa_wdm_d2_ad, factor_names_efa_wdm_d2_ad) %>%
    mutate(order = 1, study = "Study 2",
           sample = "adults", solution = "3-factor"),
  vac_fun(efa_par_d2_ad, factor_names_efa_par_d2_ad) %>%
    mutate(order = 2, study = "Study 2",
           sample = "adults", solution = "4-factor"),
  vac_fun(efa_wdm_d2_79, factor_names_efa_wdm_d2_79) %>%
    mutate(order = 3, study = "Study 2",
           sample = "7-9y", solution = "3-factor"),
  # study 3
  vac_fun(efa_wdm_d3_ad, factor_names_efa_wdm_d3_ad) %>%
    mutate(order = 1, study = "Study 3",
           sample = "adults", solution = "3-factor"),
  vac_fun(efa_wdm_d3_79, factor_names_efa_wdm_d3_79) %>%
    mutate(order = 3, study = "Study 3",
           sample = "7-9y", solution = "3-factor"),
  vac_fun(efa_wdm_d3_46, factor_names_efa_wdm_d3_46) %>%
    mutate(order = 5, study = "Study 3",
           sample = "4-6y", solution = "3-factor"),
  vac_fun(efa_par_d3_46, factor_names_efa_par_d3_46) %>%
    mutate(order = 4, study = "Study 3",
           sample = "4-6y", solution = "2-factor"),
  # study 4
  vac_fun(efa_wdm_d4_ad, factor_names_efa_wdm_d4_ad) %>%
    mutate(order = 1, study = "Study 4",
           sample = "adults", solution = "3-factor"),
  vac_fun(efa_par_d4_46, factor_names_efa_par_d4_46) %>%
    mutate(order = 5, study = "Study 4",
           sample = "4-5y", solution = "3-factor"),
  vac_fun(efa_wdm_d4_46, factor_names_efa_wdm_d4_46) %>%
    mutate(order = 6, study = "Study 4",
           sample = "4-5y", solution = "4-factor")) %>%
  # all studies
  mutate(ur_factor = case_when(factor == "BODY-HEART" ~ "BODY-HEART",
                               grepl("BODY", factor) ~ "BODY",
                               grepl("HEART", factor) ~ "HEART",
                               grepl("MIND", factor) ~ "MIND"),
         ur_factor = factor(ur_factor, 
                            levels = c("BODY", "BODY-HEART", 
                                       "HEART", "MIND")),
         ur_factor_pos = recode(ur_factor,
                                "BODY" = 1, "BODY-HEART" = 1.5,
                                "HEART" = 2, "MIND" = 3),
         age_group = case_when(
           sample %in% c("adults", "1a", "1b", "1c", "1d") ~ "Adults",
           sample == "7-9y" ~ "Children, 7-9y",
           sample %in% c("4-6y", "4-5y") ~ "Children, 4-6y"),
         age_group = factor(age_group,
                            levels = c("Adults", "Children, 7-9y",
                                       "Children, 4-6y")))
```

Among adults (Figure 3.5, panel A, left column), a clear pattern emerged in the relative size of these factors as indexed by the proportion of shared variance explained: In all eight of the EFA solutions included in this chapter, adults' BODY and HEART factors explained a disproportionately large amount of the shared variance (more than would be expected if all factors were equal in size), and their MIND factor explained a disproportionaltely small amount of the shared variance (less than would be expected if al factors were equal in size). In most of these solutions, it appears that the BODY factor explained slightly more of the shared variance than the HEART factor, but these differences were generally quite small. This suggests that the conceptual units I have referred to as BODY and HEART may play especially large roles in US adults' representations of mental life, at least in the way they use these representations to distinguish among different kinds of beings in the world.

Among 7- to 9-year-old children (Figure 3.5, panel A, middle column), a similar pattern was observed in Study 3 (orange), with children's BODY and HEART factors explaining more of the shared variance than their MIND factor. However, in Study 2 (purple), children's HEART factor explained nearly twice as much of the variance as either of the other factors. This raises the possibility that the conceptual unit I have called HEART looms especially large in the representations of children in this age range—but further studies would be required to determine whether this phenomenon is reliable and the circumstances under which is most or less likely to manifest.

Among 4- to 6-year-old children (Study 3) and 4- to 5-year-old children (Study 4; Figure 3.5, panel A, right column), the BODY-like factors explained disproportionately large amounts of the shared variance. This holds true across all solutions for both studies (when combining the two BODY-like factors in the four-factor solution) and was particularly pronounced in the two-factor solution for Study 3 (orange, top row), in which younger children's BODY-HEART factor explains nearly twice as much of the shared variance as their MIND factor (perhaps a harbinger of an impending split between BODY and HEART as young children's conceptual representations become more like the older children and adults around them). The proportion of shared variance explained by younger children's HEART-like factors in the three-factor solutions for Studies 3 and 4 (middle row) appears to have been somewhat smaller than it was among older children and adults, particularly in Study 4 (turquoise), while the proportion explained by the more MIND-like factors appears to have been roughly comparable to that of adults in all studies. 

Taken together, these observations are generally consistent with the possibility that the conceptual unit that I have called MIND may be relatively mature by the preschool years, not only in its content (the perceptual-cognitive abilities that are closely associated with this conceptual unit) but also in its size. By contrast, I would interpret these patterns as providing further indication of an ongoing negotiation of the physiological (BODY) and social-emotion (HEART) domains during early childhood.

__BOOKMARK: ADD DISUCSSION OF YOUNGER CHILDREN__

## Proportion of total variance explained

A researcher might also be interested in the proportion of total variance in all the measured variables explained by a particular factor, or by all of the retained factors in combination. The total variance in the measure variables accounted for by all of the retained factors can be estimated by taking the mean communality across all variables (where "communality" is a measure of the degree to which a given variable is correlated with all other variables, indexed by the sum of the squared loadings of that variable on each of the retained factors). The proportion of this total variance accounted for by a single factor can be calculated by diving the sum of squared loadings for that factor across all variables by the total number of measured variables.

```{r}
var_total_report <- bind_rows(
  # study 1
  vac_fun(efa_wdm_d1a_ad, factor_names_efa_wdm_d1a_ad, 
          which_stat = "Proportion Var") %>%
    mutate(order = 1, study = "Study 1a",
           sample = "1a", solution = "3-factor"),
  vac_fun(efa_wdm_d1b_ad, factor_names_efa_wdm_d1b_ad, 
          which_stat = "Proportion Var") %>%
    mutate(order = 1, study = "Study 1b",
           sample = "1b", solution = "3-factor"),
  vac_fun(efa_wdm_d1c_ad, factor_names_efa_wdm_d1c_ad, 
          which_stat = "Proportion Var") %>%
    mutate(order = 1, study = "Study 1c",
           sample = "1c", solution = "3-factor"),
  vac_fun(efa_wdm_d1d_ad, factor_names_efa_wdm_d1d_ad, 
          which_stat = "Proportion Var") %>%
    mutate(order = 1, study = "Study 1d",
           sample = "1d", solution = "3-factor"),
  # study 2
  vac_fun(efa_wdm_d2_ad, factor_names_efa_wdm_d2_ad, 
          which_stat = "Proportion Var") %>%
    mutate(order = 1, study = "Study 2",
           sample = "adults", solution = "3-factor"),
  vac_fun(efa_par_d2_ad, factor_names_efa_par_d2_ad, 
          which_stat = "Proportion Var") %>%
    mutate(order = 2, study = "Study 2",
           sample = "adults", solution = "4-factor"),
  vac_fun(efa_wdm_d2_79, factor_names_efa_wdm_d2_79, 
          which_stat = "Proportion Var") %>%
    mutate(order = 3, study = "Study 2",
           sample = "7-9y", solution = "3-factor"),
  # study 3
  vac_fun(efa_wdm_d3_ad, factor_names_efa_wdm_d3_ad, 
          which_stat = "Proportion Var") %>%
    mutate(order = 1, study = "Study 3",
           sample = "adults", solution = "3-factor"),
  vac_fun(efa_wdm_d3_79, factor_names_efa_wdm_d3_79, 
          which_stat = "Proportion Var") %>%
    mutate(order = 3, study = "Study 3",
           sample = "7-9y", solution = "3-factor"),
  vac_fun(efa_wdm_d3_46, factor_names_efa_wdm_d3_46, 
          which_stat = "Proportion Var") %>%
    mutate(order = 5, study = "Study 3",
           sample = "4-6y", solution = "3-factor"),
  vac_fun(efa_par_d3_46, factor_names_efa_par_d3_46, 
          which_stat = "Proportion Var") %>%
    mutate(order = 4, study = "Study 3",
           sample = "4-6y", solution = "2-factor"),
  # study 4
  vac_fun(efa_wdm_d4_ad, factor_names_efa_wdm_d4_ad, 
          which_stat = "Proportion Var") %>%
    mutate(order = 1, study = "Study 4",
           sample = "adults", solution = "3-factor"),
  vac_fun(efa_par_d4_46, factor_names_efa_par_d4_46, 
          which_stat = "Proportion Var") %>%
    mutate(order = 5, study = "Study 4",
           sample = "4-5y", solution = "3-factor"),
  vac_fun(efa_wdm_d4_46, factor_names_efa_wdm_d4_46, 
          which_stat = "Proportion Var") %>%
    mutate(order = 6, study = "Study 4",
           sample = "4-5y", solution = "4-factor")) %>%
  # all studies
  mutate(ur_factor = case_when(factor == "BODY-HEART" ~ "BODY-HEART",
                               grepl("BODY", factor) ~ "BODY",
                               grepl("HEART", factor) ~ "HEART",
                               grepl("MIND", factor) ~ "MIND"),
         ur_factor = factor(ur_factor, 
                            levels = c("BODY", "BODY-HEART", 
                                       "HEART", "MIND")),
         ur_factor_pos = recode(ur_factor,
                                "BODY" = 1, "BODY-HEART" = 1.5,
                                "HEART" = 2, "MIND" = 3),
         age_group = case_when(
           sample %in% c("adults", "1a", "1b", "1c", "1d") ~ "Adults",
           sample == "7-9y" ~ "Children, 7-9y",
           sample %in% c("4-6y", "4-5y") ~ "Children, 4-6y"),
         age_group = factor(age_group,
                            levels = c("Adults", "Children, 7-9y",
                                       "Children, 4-6y")))
```

```{r}
var_total_sum <- var_total_report %>%
  group_by(study, sample, age_group, solution) %>%
  summarise(value = sum(value)) %>%
  ungroup() %>%
  mutate(ur_factor = "All factors",
         ur_factor_pos = 4)
```

__BOOKMARK: ADD DISCUSSION__

```{r}
pos <- position_jitter(width = 0.1, seed = 2)

plot_var_shared <- var_shared_report %>%
  mutate(solution = paste0(solution, " solution"),
         lab = case_when(
           (solution == "4-factor solution") & 
             ((study == "Study 2" & ur_factor == "MIND") | 
                (study == "Study 4" & ur_factor == "BODY")) ~ 
             factor,
           ur_factor == "BODY-HEART" ~ factor,
           TRUE ~ NA_character_),
         design = case_when(
           study %in% c("Study 1a", "Study 1b", "Study 2") ~ "edge case (between-Ss)",
           study %in% c("Study 1c", "Study 4") ~ "edge case (within-Ss)",
           study %in% c("Study 1d", "Study 3") ~ "diverse characters (between-Ss)"),
         design = factor(design, 
                         levels = c("edge case (between-Ss)",
                                    "edge case (within-Ss)",
                                    "diverse characters (between-Ss)"))) %>%
  arrange(study, sample, ur_factor, factor) %>%
  ggplot(aes(x = ur_factor_pos, y = value, color = study, shape = design)) +
  facet_grid(solution ~ age_group, scales = "free_y") +
  geom_hline(data = data.frame(solution = c("2-factor solution",
                                            "3-factor solution",
                                            "4-factor solution"),
                               equal = c(1/2, 1/3, 1/4)),
             aes(x = NULL, y = NULL, color = NULL, yintercept = equal),
             size = 0.25, lty = 2, show.legend = F) +
  geom_path(aes(group = study), position = pos, alpha = 0.5, show.legend = F) +
  geom_point(position = pos, show.legend = T, size = 2) +
  geom_text_repel(aes(label = lab), size = 3, show.legend = F,
                  position = pos, box.padding = 0.35, na.rm = T,
                  segment.alpha = 0.5) +
  scale_colour_brewer(palette = "Dark2", direction = -1) +
  scale_shape_manual(values = c(19, 15, 17)) +
  scale_x_continuous(breaks = 1:3, labels = c("BODY", "HEART", "MIND"),
                     minor_breaks = NULL) +
  scale_y_continuous(breaks = seq(0, 1, 0.1), 
                     labels = scales::percent_format(accuracy = 1)) +
  labs(title = "Proportion of shared variance explained by each factor",
       x = "Factor", y = "Shared variance explained", color = "Study") #+
  # theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))
```

```{r}
plot_var_total <- var_total_report %>%
  mutate(solution = paste0(solution, " solution"),
         lab = case_when(
           (solution == "4-factor solution") & 
             ((study == "Study 2" & ur_factor == "MIND") | 
                (study == "Study 4" & ur_factor == "BODY")) ~ 
             factor,
           ur_factor == "BODY-HEART" ~ factor,
           TRUE ~ NA_character_),
         design = case_when(
           study %in% c("Study 1a", "Study 1b", "Study 2") ~ "edge case (between-Ss)",
           study %in% c("Study 1c", "Study 4") ~ "edge case (within-Ss)",
           study %in% c("Study 1d", "Study 3") ~ "diverse characters (between-Ss)"),
         design = factor(design, 
                         levels = c("edge case (between-Ss)",
                                    "edge case (within-Ss)",
                                    "diverse characters (between-Ss)"))) %>%
  arrange(study, sample, ur_factor, factor) %>%
  ggplot(aes(x = ur_factor_pos, y = value, color = study, shape = design)) +
  facet_grid(solution ~ age_group) +
  geom_path(aes(group = study), position = pos, alpha = 0.5, show.legend = F) +
  geom_point(position = pos, show.legend = T, size = 2) +
  geom_text_repel(aes(label = lab), size = 3, show.legend = F,
                  position = pos, box.padding = 0.35, na.rm = T,
                  segment.alpha = 0.5) +
  scale_colour_brewer(palette = "Dark2", direction = -1) +
  scale_shape_manual(values = c(19, 15, 17)) +
  scale_x_continuous(breaks = 1:4, 
                     labels = c("BODY", "HEART", "MIND", "All factors"),
                     minor_breaks = NULL) +
  scale_y_continuous(breaks = seq(0, 1, 0.1), minor_breaks = NULL, 
                     limits = c(0, max(var_total_report$value)),
                     # limits = c(0, 1),
                     labels = scales::percent_format(accuracy = 1)) +
  labs(title = "Proportion of total variance explained by each factor",
       x = "Factor", y = "Total variance explained", color = "Study") +
  theme(# axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
        legend.position = "none")
```

```{r}
plot_var_total_sum <- var_total_sum %>%
  mutate(solution = paste0(solution, " solution"),
         design = case_when(
           study %in% c("Study 1a", "Study 1b", "Study 2") ~ "edge case (between-Ss)",
           study %in% c("Study 1c", "Study 4") ~ "edge case (within-Ss)",
           study %in% c("Study 1d", "Study 3") ~ "diverse characters (between-Ss)"),
         design = factor(design, 
                         levels = c("edge case (between-Ss)",
                                    "edge case (within-Ss)",
                                    "diverse characters (between-Ss)"))) %>%
  ggplot(aes(x = ur_factor, y = value, color = study, shape = design)) +
  facet_grid(solution ~ age_group, scales = "free_x", space = "free_x") +
  geom_point(position = position_dodge(width = 1), show.legend = T, size = 2) +
  scale_colour_brewer(palette = "Dark2", direction = -1) +
  scale_shape_manual(values = c(19, 15, 17)) +
  scale_y_continuous(breaks = seq(0, 1, 0.1), minor_breaks = NULL, 
                     # limits = c(0, max(var_total_report$value)),
                     limits = c(0, 1),
                     labels = scales::percent_format(accuracy = 1)) +
  labs(title = "Total variance explained by all factors",
       x = "Factor", y = "Total variance explained", color = "Study", 
       shape = "Variant of experimental approach")
```

```{r}
t_age_79 <- t.test(age ~ study,
                   data = d2_79 %>% distinct(study, subid, age) %>%
                     full_join(d3_79 %>% distinct(study, subid, age)) %>%
                     distinct())

t_age_46 <- t.test(age ~ study,
                   data = d3_46 %>% distinct(study, subid, age) %>%
                     full_join(d4_46 %>% distinct(study, subid, age)) %>%
                     distinct())

cat("Older children:\n")
t_age_79

cat("Younger children:\n")
t_age_46
```

```{r}
figure3.5 <- plot_grid(plot_var_shared + theme(legend.position = "none"), 
                       plot_var_total + theme(legend.position = "none"), 
                       plot_var_total_sum, ncol = 3, rel_widths = c(1, 1, 1.1), 
                       labels = "AUTO")

figure3.5_cap <- add_sub(figure3.5, str_wrap(paste0(
  "Figure 3.5: Estimates of the 'size' of factors in each of the EFA solutions reported in this chapter, organized by study, age group, and solution. Note that the '4- to 6-year old' children in Study 4 were significantly younger (mean age: ", 
  format(round(t_age_46$estimate[2], 2), nsmall = 2), 
  "y) than thse in Study 3 (mean age: ", 
  format(round(t_age_46$estimate[1], 2), nsmall = 2), 
  "y; Welch's t(", 
  format(round(t_age_46$parameter, 2), nsmall = 2),
  ") = ", 
  format(round(t_age_46$statistic, 2), nsmall = 2), 
  ", p ",
  ifelse(t_age_46$p.value < 0.001, "< 0.001",
         paste0("= ", format(round(t_age_46$p.value, 3), nsmall = 3))),
  "); '7- to 9-year-old children' in Studies 2 (mean age: ",
  format(round(t_age_79$estimate[1], 2), nsmall = 2), 
  "y) and 3 (mean age: ",
  format(round(t_age_79$estimate[2], 2), nsmall = 2), 
  "y) did not different significantly in age (Welch's t(",
  format(round(t_age_79$parameter, 2), nsmall = 2),
  ") = ",
  format(round(t_age_79$statistic, 2), nsmall = 2), 
  ", p ",
  ifelse(t_age_79$p.value < 0.001, "< 0.001",
         paste0("= ", format(round(t_age_79$p.value, 3), nsmall = 3))),
  "). (A) Proportion of shared variance explained by each factor, for each solution. By definition, the total shared variance explained for each solution equals 100%. Dotted lines indicate the expected value of shared variance explained if all of the factors for a given solution were of equal size. (B) Proportion of total variance explained by each factor, for each solution (theoretical range: 0-100%). (C) Proportion of total variance explained by the combination of all factors, for each solution (theoretical range: 0-100%)."), 210), x = 0, hjust = 0)
```

```{r figure3.5, include = T, fig.width = 9, fig.asp = 0.4}
ggdraw(figure3.5_cap)
```


# General discussion of conceptual units

__XX ADD DESCRIPTION OF STUDY 1__

In three large-scale studies (total _N_=`r nrow(d2_79_wide) + nrow(d3_79_wide) + nrow(d3_46_wide) + nrow(d4_46_wide)/2` children and `r nrow(d2_ad_wide) + nrow(d3_ad_wide) + nrow(d4_ad_wide)/2` adults), I set out to expore the development of US children's conceptual representations of mental life between 4-9y of age. These studies suggest that these representations undergo substantial development over the course of early and middle childhood—in two distinct senses. 

First, analyses of the correlational structure of children's mental capacity attributions (via exploratory factor analysis) suggested changes in ontological _structure_. Between early childhood (4-6y; Studies 3-4) and middle childhood (7-9y; Studies 2 and 3), children's sense of which mental capacities "go together" seems to unfold into a higher-dimensional space, characterized by stronger differentiation of the social-emotional abilities that I have called HEART from the physiological sensations of the BODY and the perceptual-cognitive abilities of the MIND. 

# Chapter conclusion

__XX ADD CHAPTER CONCLUSION__





# TO DO LIST

- add discussion of "size" of factors (refer to figure3.5)
- write chapter conclusion
- reconsider additions to appendix A: 
  - left-right position (study 1c)
  - first-second (study 4)
  - beetle-robot (studies 1a-1c, study 2, study 4)
  - analysis of scale use across age groups

