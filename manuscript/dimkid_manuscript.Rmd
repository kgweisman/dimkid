---
title: 'Children''s developing representations of mental life: Changes in conceptual
  structure between 4-9 years of age'
author: "Kara Weisman, Carol S. Dweck, & Ellen M. Markman"
subtitle: Draft updated 2018-09-23
output:
  html_notebook:
    toc: true
    toc_depth: 4
    toc_float: true
---

```{r global_options, include = F}
knitr::opts_chunk$set(fig.width = 3, fig.asp = 0.67, 
                      include = F, echo = F)
```

```{r}
library(tidyverse)
library(psych)
library(langcog) # source: https://github.com/langcog/langcog-package
# library(lme4)
library(brms)
library(stringi)
library(cowplot)
library(kableExtra)

theme_set(theme_bw())
```

```{r}
# supporting functions
source("./scripts/max_factors_efa.R")
source("./scripts/reten_fun.R")
source("./scripts/plot_fun.R")
source("./scripts/efa_fun.R")

# data scripts
source("./scripts/data_s1_ad.R")
source("./scripts/data_s1_79.R")
source("./scripts/data_s2_ad.R")
source("./scripts/data_s2_79.R")
source("./scripts/data_s2_46.R")

# function for quickly getting counts and proportions for categorical demo variables
demo_fun <- function(df, var, n_round = NA){
  new_df <- df %>%
    distinct_("subid", var) %>%
    mutate_at(.vars = var,
              .funs = . %>% as.character() %>% replace_na(., "MISSING")) %>%
    count_(var) %>%
    mutate(prop = n/sum(n)) %>%
    arrange(desc(n))
  if(!is.na(n_round)){
    new_df <- new_df %>% mutate(prop = round(prop, n_round))
  }
  return(new_df)
}

# function for getting write-up of brms model results
write_b_95CI_fun <- function(model, param, round_n = 2){
  fixef <- fixef(model) %>% round(round_n) %>% format(nsmall = round_n)
  b <- fixef[param, "Estimate"]
  lower <- fixef[param, "Q2.5"]
  upper <- fixef[param, "Q97.5"]
  text <- paste0("_b_ = ", b, 
                 ", 95% credible interval: [", lower, ", ", upper, "]")
  text <- gsub("\\[ ", "\\[", text)
  return(text)
}

binomial_smooth <- function(...) {
  geom_smooth(method = "glm", method.args = list(family = "binomial"), ...)
}
```

```{r}
# what correlation to use
chosen_cor <- "cor" # reported
# chosen_cor <- "poly" # alternative option

# what rotation to use
chosen_rot <- "varimax" # reported
# chosen_rot <- "oblimin" # alternative option

# what factoring method to use
chosen_fm <- "minres" # reported (see alternative options in ?fa)

# what scoring method to use
chosen_scores <- "tenBerge" # reported
# chosen_scores <- "regression" # alternative option
```

# Abstract

XX

# Introduction

XX

In this paper, we first introduce a child-friendly version of Weisman et al.'s (2017) experimental paradigm, validate it among US adults, and then use this paradigm to conduct an initial exploration of this conceptual structure and mental capacity attributions among US children, focusing on 7- to 9-year-old children (Study 1). Next, we replicate our findings with 7- to 9-year-old children using a briefer experimental paradigm, and use this briefer paradigm to assess the earlier development of this conceptual structure, focusing on 4- to 6-year-old children (Study 2). We then develop an even simpler version of the paradigm, using more basic vocabulary and a streamlined experimental protocol, with the aim of validating and refining our understanding of conceptual structure among 4- to 6-year-old children, as well as exploring how younger children's attributions of different aspects of mental life might vary with age (Study 3). Finally, to supplement the group-level analyses picture of development provided by the exploratory factor analyses for Studies 1-3, we re-analyze these data using a novel, participant-level approach that allows us to observe how these conceptual structures might evolve and unfold continuously over development ("Continuous development at the participant level: A re-analysis of Studies 1-3").

# Overview of Methods and Analyses

Studies 1-3 used very similar experimental paradigms and were designed with the same analyses in mind. Here we provide an overview of the methods and planned analyses for all of these studies; any details that varied across studies are supplied in the "Methods" section of each of the studies. 

## General methods

Following Weisman et al. (2017), these studies were designed with the goal of focusing participants' attention on the similarities, differences, and relationships among various mental capacities.

To this end, each participant was either randomly or pseudo-randomly assigned to assess 1-2 target characters (e.g., a beetle, a robot, a goat, etc.) on a wide range of sensory, perceptual, emotional, social, cognitive, and other mental capacities, ranging in number from 18-40 across studies and presented in either a random or a pseudo-random (counterbalanced) order. Participants were presented with a vivid, full-color photograph of their assigned target in a naturalistic context (e.g., a beetle on a leaf; a robot in an office; a goat in a grassy field), which they had access to throughout the study. 

On each trial, participants were asked a question of the form Do you think a [target] can [do X]? (e.g., "Do you think a beetle can feel happy?"; Studies 1-2) or Can [targets] [do X]? (Study 3) (e.g., "Can beetles feel happy?"). Participants responded on a three-point scale (no, coded as 0; kinda, coded as 0.5; or yes, coded as 1). Although a three-point scale is not optimal for factor analyses, pilot testing suggested that it was critical in allowing children to move fast enough through the study to answer all questions, and maintaining this within-subjects design was our top priority for the planned analyses.

See the Methods section for each study for details of the particular target characters and mental capacities included in each study, as well as the materials and physical setup.

## Primary analysis: Exploratory factor analysis (EFA)

Our primary goal in conducting these studies was to uncover a set of latent constructs that might plausibly have given rise to the observed correlations among mental capacity attributions in each group of participants. As such, our primary planned analysis for all studies was an exploratory factor analysis (EFA). Following Weisman et al. (2017), we interpreted each of the constructs ("factors") as corresponding to a fundamental component of mental life, according to this group of participants; by extension, we consider the full set of factors for each sample to represent to the overall "conceptual structure" underlying mental capacity attributions for this group of participants.

For all EFAs, we used ordinary least squares to find the minimum residual solution, using the "psych" package for R (Revelle, 2018). Here we focus on results using Pearson correlations using pairwise complete observations. (See Online Supplementary Materials [OSM] for solutions using polychoric correlations, which are better suited to handle responses on a three-point scale but, to our eyes, tended to over-fit our data by suggesting that we should retain many factors that each accounted for only a small amount of the shared variance.)

In order to determine how many factors to retain, we examined the results of three factor retention protocols: (1) Parallel Analysis, which compares the observed correlation structure to the correlation structure arising from random datasets of the same size; (2) Minimizing the Bayesian Information Criterion (BIC), which is one method of optimizing both goodness of fit and parsimony; and (3) A set of factor retention criteria that have been used in Weisman et al.'s (2017) previous work, in which they began with the maximal number of factors according to an analysis of degrees of freedom, and retained factors that met all three of the following criteria: (a) had eigenvalues greater than 1.00, (b) individually accounted for greater than 5% of the shared variance before rotation, and (c) were the "dominant" factor (the factor with the strongest absolute factor loading) for at least 1 mental capacity after rotation. For each study, our interpretation of how best to characterize the dataset (i.e., how many factors we observe) was determined by the degree of consensus among these three protocols and the interpretability of the retained factors under each protocol. 

Here we focus our interpretations on varimax-rotated solutions, which constrain all factors to be orthogonal. (See OSM for solutions using oblique ["oblimin"] rotations, which allow for correlated factors.)

## Secondary analysis: Regression analyses of factor scores

Having inferred a conceptual structure for a given group of participants via EFA, we then sought to examine attributions of mental capacities to the particular target characters included in each study within this conceptual structure: To what extent did participants attribute each of the fundamental components of mental life revealed by EFA to a given target character, and how did this attributions vary with age (either within an age group or between age groups)? To explore this question, we examined "factor scores"—summaries of each participant's attributions of each of factors revealed by EFA. We used the correlation-preserving "ten Berge" method (as implemented in the "psych" package; Revelle, 2018), imputing missing values using the mean (by target character, capacity, and age group). This yielded one factor score for each of the factors revealed by EFA for each participant.

We analyzed these factor scores via mixed effects Bayesian regression analyses using the "brms" package for R (Bürkner, 2017). In all of these analyses, we included the maximal random effect structures given the design for the relevant study. Further details varied by study, depending on the number of target characters included in that study, the number of factors revealed by EFA for the relevant group(s) of participants, and the goals of the analysis (e.g., comparing two age groups vs. examining continuous effects of age within one or more groups of participants).

# Study 1

The goal of Study 1 was to develop a child-friendly version of Weisman et al.'s (2017) study paradigm and conduct an initial exploration of this conceptual structure among children. 

Pilot testing suggested that children as young as 7 years of age found the paradigm easy and enjoyable, and work on the development of lay biology and psychology has suggested that these concepts may continue to develop well into middle childhood (e.g., Carey, 1985; Hatano & Inagaki, 1997; Piaget, 1929; cf. Gelman & Opfer, 2002). Thus, we targeted 7- to 9-year-old children for our first child sample. We also recruited a group of adults to validate our child- friendly paradigm, i.e., to evaluate whether it replicated Weisman et al.'s (2017) original work with adults.
In Weisman et al.'s (2017) original studies, participants evaluated a target character on 40 mental capacities using a seven-point Likert-type scale. Pilot testing suggested two necessary modifications for children: rewording some of the mental capacity items, and using a simpler, three-point response scale (no, kinda, or yes; see "Overview of Methods and Analyses, above"). 

## Method

### Participants

`r nrow(d1_ad_wide) + nrow(d1_79_wide)` people participated in this study.

```{r}
# demographics
d1_ad_gender <- demo_fun(d1_ad, "gender", 2)
d1_ad_ethnicity <- demo_fun(d1_ad, "ethnicity_cat", 2)
d1_ad_english <- demo_fun(d1_ad, "englishNative", 2)
```

Adults (_n_=`r nrow(d1_ad_wide)`) participated via Amazon Mechanical Turk (MTurk) in July 2016. Adult participants had gained approval for at least 95% of their previous work on MTurk; had MTurk accounts based in the US; and indicated that they were at least 18 years old. Adults were paid \$0.30 for approximately 2-3 minutes of their time (median duration: `r summary(d1_ad$duration)["Median"] %>% round(2)` min). 

According to self report, the adult sample ranged in age from `r summary(d1_ad$age)["Min."]`-`r summary(d1_ad$age)["Max."]` years (median: `r summary(d1_ad$age)["Median"]`y) and was roughly split between women (`r d1_ad_gender$prop[d1_ad_gender$gender=="female"] * 100`%) and men (`r d1_ad_gender$prop[d1_ad_gender$gender=="male"] * 100`%; `r d1_ad_gender$prop[d1_ad_gender$gender=="other_prefNo"] * 100`% of participants identified as some other gender or opted not to disclose). Adults predominantly identified as White (`r d1_ad_ethnicity$prop[d1_ad_ethnicity$ethnicity_cat=="white"] * 100`%; `r d1_ad_ethnicity$prop[d1_ad_ethnicity$ethnicity_cat=="multi"] * 100`% identified as more than one race/ethnicity, and $\leq$ `r data.frame(d1_ad_ethnicity %>% filter(!ethnicity_cat %in% c("white", "multi")))$prop %>% max() * 100`% as any other race/ethnicity). The vast majority of adults reported English being their only native language (`r d1_ad_english$prop[d1_ad_english$englishNative == "yes_only"] * 100`%; an additional `r d1_ad_english$prop[d1_ad_english$englishNative == "yes_multiple"] * 100`% indicated that English was one of multiple native languages for them.)

```{r}
# demographics
d1_79_gender <- demo_fun(d1_79, "gender", 2)
d1_79_ethnicity <- demo_fun(d1_79, "ethnicity", 2)
d1_79_bilingual <- demo_fun(d1_79, "bilingual", 2)
```

Children (_n_=`r nrow(d1_79_wide)`) participated at one of several San Francisco Bay Area museums or at their younger sibling's preschool between July-December 2016. The study took most children under 10 minutes to complete (median duration: `r summary(d1_79$duration)["Median"] %>% round(2)` min). An additional 12 children participated but were excluded for being outside the target age range (_n_=7), being of unknown age (_n_=4), or being shown a target character other than a beetle or a robot (_n_=1). Children received a small thank-you gift (e.g., a sticker) for their participation. 

Children ranged in age from `r summary(d1_79$age)["Min."] %>% round(2)`-`r summary(d1_79$age)["Max."] %>% round(2)` years (median: `r summary(d1_79$age)["Median"] %>% round(2)`y). According to parental report, the child sample included slightly more girls (`r d1_79_gender$prop[d1_79_gender$gender=="f"] * 100`%) than boys (`r d1_79_gender$prop[d1_79_gender$gender=="m"] * 100`%; `r d1_79_gender$prop[d1_79_gender$gender=="MISSING"] * 100`% of children's gender was non-binary or unknown). Parents predominantly identified their children as White (`r d1_79_ethnicity$prop[d1_79_ethnicity$ethnicity=="white"] * 100`%), multiracial (`r d1_79_ethnicity$prop[d1_79_ethnicity$ethnicity=="multi"] * 100`%), East Asian (`r d1_79_ethnicity$prop[d1_79_ethnicity$ethnicity=="east asian"] * 100`%), or South Asian (`r d1_79_ethnicity$prop[d1_79_ethnicity$ethnicity=="south or southeast asian"] * 100`%; $\leq$ `r data.frame(d1_79_ethnicity %>% filter(!ethnicity %in% c("white", "multi", "east asian", "south or southeast asian", "MISSING")))$prop %>% max() * 100`% of children were identified as any other race/ethnicity, and `r d1_79_ethnicity$prop[d1_79_ethnicity$ethnicity=="MISSING"] * 100`% of children's race/ethnicity was unknown). Roughly half of parents (`r d1_79_bilingual$prop[d1_79_bilingual$bilingual=="yes"] * 100`%) reported that their child was bilingual (though, anecdotally, parents' interpretations of "bilingual" ranged from taking classes at school to speaking a langauge at home).

### Materials and procedure

Following Weisman et al. (2017, Studies 1-3), participants were randomly assigned to assess the mental capacities of one of two "edge cases" in social reasoning: a beetle (_n_=`r d1_ad %>% filter(character == "beetle") %>% distinct(subid) %>% nrow()` adults, _n_=`r d1_79 %>% filter(character == "beetle") %>% distinct(subid) %>% nrow()` children) or a robot (_n_=`r d1_ad %>% filter(character == "robot") %>% distinct(subid) %>% nrow()` adults, _n_=`r d1_79 %>% filter(character == "robot") %>% distinct(subid) %>% nrow()` children). Because beetles are animals and robots are artifacts, this pair provides insight into the role of biological life in attributions of mental life—an issue of particular interest from a developmental perspective, given the long history of work on the development of the animate-inanimate distinction and its relation to folk psychology. Most critically for our bottom-up approach to uncovering conceptual structure, the "mental lives" of these entities are controversial: People differ in their assessments of the mental capacities of beetles and robots. This allowed us to address the following question: When participants disagree about the mental capacities of some entity, which capacities "go together"?

Instructions to participants focused on the idea that we wanted to know what participants thought "[beetles/robots] can do and can not do." Participants rated the target character on 40 mental capacities, presented in a random order for each participant. On each trial, participants responded _no_, _kinda_, or _yes_ to the question "Do you think a [beetle/robot] can...?" The three response options were visible throughout the experiment.

The 40 mental capacities were designed to be as close as possible to those in Weisman et al.'s (2017) original studies, while being comprehensible to children in early elementary school. This set of items included physiological sensations related to biological needs (e.g., _get hungry_); emotional experiences (e.g., _feel happy_); perceptual abilities (e.g., _hear sounds_); cognitive abilities (e.g., _remember things_); capacities related to autonomy or agency (e.g., _decide what to do_); social abilities (e.g., _feel guilty_); and several additional items (e.g., _be aware of itself_). Each of these a priori categories included at least five items of varying valence, complexity, and phrasing. (See Figure 1 for the full list of mental capacities included in Study 1.)

We also prepared a short definition for each item, so as to be consistent in our responses to participants (particularly children) if they asked for clarification. Children were encouraged at the beginning of the study to ask questions if they did not know what a word meant, in which case they given these definitions; adults were told that they could access these definitions by hovering over the text on the computer screen. Pilot testing suggested that seven items required clarification for most children, so these items were always accompanied by their definitions from the beginning of the trial (for both adults and children), as follows: _have a personality, like when someone is shy and somebody else is silly_; _have beliefs, like when you think something is true_; _feel pleasure, like when something feels really good_; _have desires, like when you really want something_; _have self- control, like when you stop yourself from doing something you shouldn't do_; _have goals, like when you're trying hard to do something or make something happen_; and _feel sick, like when you feel like you might throw up_. 

Adults completed the study by clicking through a website at their own pace, with one trial presented on each page and no ability to go backwards. Children completed the study on an experimenter's laptop computer. The experimenter read the instructions and the first several trials out loud, requesting verbal responses from the child and selected his or her response for her; after several trials, the experimenter gave the child the option to continue independently (reading the questions and selecting their answers themselves) if they desired. Roughly half of participants completed the remainder of the task independently.

### Data processing

We dropped trials with response times that were faster than a preset criterion of 250ms (_n_=3 child trials, _n_=97 adult trials) and retained participants regardless of skipped trials (_n_=55 child trials, _n_=1 adult trial). Overall, only 1% of adult trials and 1% of child trials were missing data; in these cases, we imputed missing values using the median by target character, capacity, and age group.

## Results

### Conceptual structure: Adults

```{r}
# implement 3 factor retention protocols
nfact_par_d1_ad <- fa.parallel(d1_ad_wide_i, cor = chosen_cor, 
                               fm = chosen_fm, plot = F)$nfact
nfact_bic_d1_ad <- vss(d1_ad_wide_i, cor = chosen_cor, rotate = chosen_rot, 
                       fm = chosen_fm, plot = F)$vss.stats$BIC %>% which.min()
nfact_wdm_d1_ad <- reten_fun(d1_ad_wide_i, rot_type = chosen_rot)

cat("Parallel analysis: ", nfact_par_d1_ad,
    "\nMinimizing BIC: ", nfact_bic_d1_ad,
    "\nWeisman et al.: ", nfact_wdm_d1_ad)
```

```{r}
efa_4_d1_ad <- fa_fun(d1_ad_wide_i, 4)

```

Two of our three methods for determining how many factors to retain (minimizing BIC and Weisman et al.'s factor retention criteria) suggested retaining three factors. (Parallel analysis suggested retaining four factors. Three of these factors were very similar to the three factors reported below, and the fourth factor was dominant for a handful of sensory and perceptual capacities, including `r top_n_domCap(efa_4_d1_ad, 4, "F4", "pos")`; see SOM.)

```{r}
efa_3_d1_ad <- fa_fun(d1_ad_wide_i, 3)
efa_3_plot_d1_ad <- heatmap_fun(efa_3_d1_ad, 
                                factor_names = c("HEART", "BODY", "MIND")) +
  labs(title = paste0("Adults (n=", nrow(d1_ad_wide_i), ")"))
```

After rotation, the first factor corresponded primarily to capacities for self- and other-relevant emotions—a suite of capacities that we (following Weisman et al.) will refer to as _HEART_. It was the dominant factor for such items as `r top_n_domCap(efa_3_d1_ad, 4, "F1", "pos")`, and accounted for `r round(efa_3_d1_ad$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution.

The second factor corresponded primarily to physiological sensations related to biological needs—a suite of capacities that we (following Weisman et al.) will refer to as _BODY_. It was the dominant factor for such items as `r top_n_domCap(efa_3_d1_ad, 4, "F2", "pos")`, and accounted for `r round(efa_3_d1_ad$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution. 

The third factor corresponded primarily to perceptual-cognitive abilities to detect and use information about the environment—a suite of capacities that we (following Weisman et al.) will refer to as _MIND_. It was the dominant factor for such items as `r top_n_domCap(efa_3_d1_ad, 4, "F3", "pos")`, and accounted for `r round(efa_3_d1_ad$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution.  

See Figure 1 for all factor loadings. (Note that for the sake of consistency across studies and comparison with Weisman et al.'s work, we have plotted these factors in the same order for all studies: _BODY_, _HEART_, and _MIND_.)

In sum, as Weisman et al.'s original studies, a three-factor structure emerged from adults' mental capacity attributions, characterized by a distinction between body, heart, and mind. This suggests that our child-friendly paradigm was valid: Using reworded items and a three-point response scale elicited the same intuitive ontology of mental life, among adults, that has been revealed by more complex, "adult-friendly" experimental paradigms. 

### Conceptual structure: Children (7-9y)

```{r}
# implement 3 factor retention protocols
nfact_par_d1_79 <- fa.parallel(d1_79_wide_i, cor = chosen_cor, 
                               fm = chosen_fm, plot = F)$nfact
nfact_bic_d1_79 <- vss(d1_79_wide_i, cor = chosen_cor, rotate = chosen_rot, 
                       fm = chosen_fm, plot = F)$vss.stats$BIC %>% which.min()
nfact_wdm_d1_79 <- reten_fun(d1_79_wide_i, rot_type = chosen_rot)

cat("Parallel analysis: ", nfact_par_d1_79,
    "\nMinimizing BIC: ", nfact_bic_d1_79,
    "\nWeisman et al.: ", nfact_wdm_d1_79)
```

Our three methods for determining how many factors to retain all suggested retaining three factors.

```{r}
efa_3_d1_79 <- fa_fun(d1_79_wide_i, 3)

efa_3_plot_d1_79 <- heatmap_fun(efa_3_d1_79, 
                                factor_names = c("HEART", "BODY", "MIND")) +
  labs(title = paste0("Children 7-9y (n=", nrow(d1_79_wide_i), ")")) +
  guides(fill = "none")
```

```{r}
cong_efa_3_d1_ad_79 <- fa.congruence(efa_3_d1_79$loadings,
                                     efa_3_d1_ad$loadings)
```

After rotation, the first factor corresponded primarily to social-emotional abilities. An analysis of factor congruence confirmed that this factor was most similar to adults' _HEART_ factor (cosine similarity with _HEART_: `r cong_efa_3_d1_ad_79["F1", "F1"]`; with _BODY_: `r cong_efa_3_d1_ad_79["F1", "F2"]`; with _MIND_: `r cong_efa_3_d1_ad_79["F1", "F3"]`). It was the dominant factor for such items as `r top_n_domCap(efa_3_d1_79, 4, "F1", "pos")`, and accounted for `r round(efa_3_d1_79$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution. 

The second factor corresponded primarily to physiological sensations. An analysis of factor congruence confirmed that this factor was most similar to adults' _BODY_ factor (cosine similarity with _BODY_: `r cong_efa_3_d1_ad_79["F2", "F2"]`; with _HEART_: `r cong_efa_3_d1_ad_79["F2", "F1"]`; with _MIND_: `r cong_efa_3_d1_ad_79["F2", "F3"]`). It was the dominant factor for such items as `r top_n_domCap(efa_3_d1_79, 4, "F2", "pos")`, and accounted for `r round(efa_3_d1_79$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution. 

The third factor corresponded primarily to perceptual-cognitive abilities. An analysis of factor congruence confirmed that this factor was most similar to adults' _MIND_ factor (cosine similarity with _MIND_: `r cong_efa_3_d1_ad_79["F3", "F3"]`; with _HEART_: `r cong_efa_3_d1_ad_79["F3", "F1"]`; with _BODY_: `r cong_efa_3_d1_ad_79["F3", "F2"]`). It was the dominant factor for such items as `r top_n_domCap(efa_3_d1_79, 4, "F3", "pos")`, and accounted for `r round(efa_3_d1_79$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution. (See Figure 1 for all factor loadings.)

In sum, like adults, children's mental capacity attributions were dominated by a three-way distinction between physiological, social-emotional, and perceptual-cognitive abilities—i.e., body, heart, and mind.

```{r, include = T, fig.width = 6, fig.asp = 0.67}
fig01_plots <- plot_grid(efa_3_plot_d1_79, efa_3_plot_d1_ad,
                         rel_widths = c(0.85, 1), labels = c("A", "B"))
fig01_with_caption <- add_sub(fig01_plots, str_wrap("Figure 1: Exploratory factor analysis results for 7- to 9-year-old children (A) and adults (B) in Study 1, in which each participant assessed 40 mental capacities for one of two target characters: a beetle or a robot.", 143), x = 0, hjust = 0)
ggdraw(fig01_with_caption)
```

### Attributions of mental life

The factor analyses of correlations among mental capacity attributions just described shed light on one aspect of children's concepts of mental life: its ontological structure. The design of our study also allows us to look at a second aspect of conceptual development in this domain: children's application of this concept, i.e., which mental capacities they tend to attribute or not to attribute to the different target characters. How might children's attributions of capacities related to _BODY_, _HEART_, and _MIND_ vary across middle childhood (7-9y), and how do they compare to the mental capacity attributions of adults?

#### Differences across age groups

```{r}
d1_all_wide_i <- d1_ad_wide_i %>%
  rownames_to_column("subid_char") %>%
  full_join(d1_79_wide_i %>%
              rownames_to_column("subid_char")) %>%
  column_to_rownames("subid_char")
```

```{r}
efa_3_d1_79_project_scores <- predict(object = efa_3_d1_ad,
                                      data = d1_79_wide_i,
                                      old.data = d1_ad_wide_i) %>%
  data.frame() %>%
  rownames_to_column("subid_char") %>%
  mutate(subid = gsub("_.*$", "", subid_char),
         character = gsub("^.*_", "", subid_char)) %>%
  gather(factor, score, -c(subid, character, subid_char)) %>%
  mutate(factor_name = recode_factor(factor,
                                     "F2" = "BODY",
                                     "F1" = "HEART",
                                     "F3" = "MIND")) %>%
  arrange(subid_char)
```

To compare children's mental capacity attributions to those of adults, we projected children's responses into the factor space defined by adults (standardized in terms of adults' responses), and examined factor scores by age group (using the correlation-preserving method articulated by ten Berge, Krijnen, Wansbeek, & Shapiro, 1999, as implemented in the "psych" package for R, Revelle, 2018). This yielded three scores for each participant, corresponding, in principle, to holistic judgments of the social-emotional, physiological, and perceptual-cognitive abilities of the target character the participant evaluated. (Note that each of these three scores takes into account factor loadings for all 40 mental capacities, as shown in Figure 1.) 

This allowed us to examine the effects of age group (adult, child), character (beetle, robot), and factor (_BODY_, _HEART_, _MIND_) on these scores via mixed effects Bayesian regression. See Table 1 for the results of a maximal model and Figure 4 for scores by age group, age (for children), factor, and character. 

```{r}
efa_3_scores_d1_all <- efa_3_d1_ad$scores %>%
  data.frame() %>%
  rownames_to_column("subid_char") %>%
  gather(factor, score, -subid_char) %>%
  mutate(subid = gsub("_beetle", "", subid_char),
         subid = gsub("_robot", "", subid),
         character = gsub("^.*_", "", subid_char),
         age_group = "adults",
         factor_name = recode_factor(factor,
                                     "F2" = "BODY",
                                     "F1" = "HEART",
                                     "F3" = "MIND")) %>%
  ungroup() %>%
  distinct() %>%
  full_join(efa_3_d1_79_project_scores %>% 
              left_join(d1_79 %>% distinct(subid, age_group, age))) %>%
  mutate_at(vars(starts_with("factor"), character, age_group), funs(factor))

efa_3_scores_boot_d1_all <- efa_3_scores_d1_all %>%
  group_by(age_group, factor, factor_name, character) %>%
  multi_boot_standard(col = "score") %>%
  ungroup()
```

```{r}
contrasts(efa_3_scores_d1_all$character) <- cbind("R_GM" = c(-1, 1))
contrasts(efa_3_scores_d1_all$age_group) <- cbind("CH79_AD" = c(0, 1))
contrasts(efa_3_scores_d1_all$factor_name) <- cbind("H_GM" = c(-1, 1, 0),
                                                    "M_GM" = c(-1, 0, 1))

# efa_3_scores_r_d1_all <- brm(score ~ factor_name * age_group * character
#                              + (1|subid),
#                              data = efa_3_scores_d1_all,
#                              seed = 12345,
#                              cores = 4,
#                              control = list(adapt_delta = 0.99))
# saveRDS(efa_3_scores_r_d1_all, file = "./brms_models/efa_3_scores_r_d1_all.rds")

efa_3_scores_r_d1_all <- readRDS("./brms_models/efa_3_scores_r_d1_all.rds")
# summary(efa_3_scores_r_d1_all)
```

```{r, include = T, results = "asis"}
fixef(efa_3_scores_r_d1_all) %>%
  data.frame() %>%
  rownames_to_column("Parameter") %>%
  mutate(Parameter = recode_factor(Parameter,
    "Intercept" = "(Intercept)",
    "characterR_GM" = "character (robot vs. grand mean)",
    "factor_nameH_GM" = "HEART (vs. grand mean)",
    "factor_nameM_GM" = "MIND (vs. grand mean)",
    "factor_nameH_GM:characterR_GM" = "character × HEART",
    "factor_nameM_GM:characterR_GM" = "character × MIND",
    "age_groupCH79_AD" = "age group (children vs. adults)",
    "age_groupCH79_AD:characterR_GM" = "character × age group",
    "factor_nameH_GM:age_groupCH79_AD" = "HEART × age group",
    "factor_nameM_GM:age_groupCH79_AD" = "MIND × age group",
    "factor_nameH_GM:age_groupCH79_AD:characterR_GM" = "character × HEART × age group",
    "factor_nameM_GM:age_groupCH79_AD:characterR_GM" = "character × MIND × age group")) %>%
  arrange(Parameter) %>%
  mutate(X = ifelse(Q2.5 * Q97.5 > 0, "*", "")) %>%
  mutate_at(vars(-Parameter, -X),
            funs(format(round(., 2), nsmall = 2))) %>%
  rename(b = Estimate, Error = Est.Error, " " = X) %>%
  unite(`95% CI`, Q2.5, Q97.5, sep = ", ") %>%
  mutate(`95% CI` = paste0("[", `95% CI`, "]")) %>%
  knitr::kable(format = "html", align = c("l", rep("r", 3)),
               caption = "Table 1: Fixed effects from a mixed-effects Bayesian regression model predicting factor scores in Study 1 by character (beetle, robot), factor (BODY, HEART, MIND), and age group (adults, children). The model used the formula 'factor score ~ factor * age group * character + (1 | subject)' and was implemented in the 'brms' package for R (Bürkner, 2017). Factor and character were effect-coded; age group was dummy-coded with adults as the baseline. Asterisks mark parameters whose 95% credible interval does not include 0.") %>%
  kable_styling() %>%
  group_rows("Adults", 1, 6) %>%
  group_rows("7-9y vs. adults", 7, 12)
```

Collapsing across factors, factor scores suggest that adults generally attributed fewer mental capacities to the robot than the beetle (`r write_b_95CI_fun(efa_3_scores_r_d1_all, "characterR_GM")`). However, this appears to be entirely due to the huge discrepancy between characters in the _BODY_ domain; the difference between characters was reduced to nothing in the _HEART_ domain (`r write_b_95CI_fun(efa_3_scores_r_d1_all, "factor_nameH_GM:characterR_GM")`), and reversed in the perceptual-cognitive domain (`r write_b_95CI_fun(efa_3_scores_r_d1_all, "factor_nameM_GM:characterR_GM")`). 

Meanwhile, children children tended to attribute more mental capacities, collapsing across characters, than did adults (`r write_b_95CI_fun(efa_3_scores_r_d1_all, "age_groupCH79_AD")`) - but this was driven primarily by the social-emotional domain (`r write_b_95CI_fun(efa_3_scores_r_d1_all, "factor_nameH_GM:age_groupCH79_AD")`), and was reversed in the perceptual-cognitive domain (`r write_b_95CI_fun(efa_3_scores_r_d1_all, "factor_nameM_GM:age_groupCH79_AD")`). 

```{r, fig.width = 2, fig.asp = 3}
fig02_plot <- ggplot(efa_3_scores_boot_d1_all %>%
         mutate(age_group = recode_factor(age_group,
                                          "children79" = "7-9y",
                                          "adults" = "adults")),
       aes(x = age_group, y = mean, color = character)) +
  facet_grid(rows = vars(factor_name), scales = "free") +
  geom_hline(yintercept = 0, lty = 2) +
  geom_line(aes(group = character), 
            position = position_dodge(width = 0.5)) +
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper), 
                  position = position_dodge(width = 0.5)) +
  scale_y_continuous(breaks = seq(-10, 10, 1)) +
  scale_color_manual(values = c("#fb9a99", "#1f78b4")) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
        legend.position = "bottom") +
  guides(color = guide_legend(override.aes = list(alpha = 1),
                              nrow = 2, byrow = T, reverse = F)) +
  labs(x = "age group", y = "", color = "character")
```

```{r, include = T, fig.width = 3, fig.asp = 3}
fig02_with_caption <- add_sub(fig02_plot, str_wrap("Figure 2: Factor scores for adults and 7- to 9-year-old children in Study 1, in which each participant assessed 40 mental capacities for one of two target characters: a beetle (pink circles) or a robot (blue squares). Each participant recieved a factor score for each factor (BODY, HEART, and MIND, as defined by an exploratory factor analysis of adults' responses). We treated these scores as summaries of that participants' mental capacity attributions in these domains; a score of 0 corresponds to the mean for that factor among adults. Error bars are bootstrapped 95% confidence intervals. Note that the range of the y-axis differs across panels.", 62), x = 0, hjust = 0)
ggdraw(fig02_with_caption)
```

A visual inspection of Figure 2 clarifies these findings. Attributions in the _BODY_ and _MIND_ domains were rather similar for children and adults: Both children and adults marked a clear difference between the robot and the beetle in the physiological sensations of the _BODY_ (top row), in line with the animate–inanimate distinction; and both age groups credited the robot with slightly greater perceptual-cognitive skills (_MIND_) than the beetle (bottom row). In contrast, in the _HEART_ domain (middle row) both the beetle and the robot received rather low scores among adults, but very high scores among children.

The raw data further supporst these observations; see Figure 3 for raw counts of _no_, _kinda_, and _yes_ responses for all items, grouped by factor, character, and age group. For example, consider hunger (the first capacity under _BODY_): Across age groups, nearly every participant said that a beetle could get hungry, while few participants (with the exception of some children) said that a robot could. Likewise, for mathematical computations (the last capacity under _MIND_), virtually no participants said that a beetle was capable of doing math, while the vast majority of both adults and children said that a robot was. But for social-emotional abilities, like feeling proud, feeling joy, and feeling sad (the first three capacities under _HEART_), far more children than adults endorsed these capacities for beetles and robots. (See SOM for an analysis, parallel to the regression analyses here, of the proportion of the top-loading mental capacities for each factor that were endorsed by participants of different ages.)

```{r}
d1_all <- d1_ad %>%
  full_join(d1_79) %>%
  select(age_group, subid, character, capacity, response_num) %>%
  left_join(loadings_fun(efa_3_d1_ad) %>% 
              group_by(capacity) %>%
              top_n(1, loading) %>%
              ungroup() %>%
              arrange(factor, desc(loading)) %>%
              mutate(order = 1:40) %>%
              select(capacity, factor, order)) %>%
  filter(!is.na(response_num)) %>%
  mutate(response = recode_factor(response_num,
                                  "0" = "no",
                                  "0.5" = "kinda",
                                  "1" = "yes"),
         factor = recode_factor(factor,
                                "F2" = "BODY",
                                "F1" = "HEART",
                                "F3" = "MIND"),
         age_group = recode_factor(age_group,
                                   "children79" = "children", 
                                   "adults" = "adults"))
```

```{r}
fig03_fun <- function(whichfac){
  fig <- d1_all %>%
    filter(factor == whichfac) %>%
    mutate(age_group = recode_factor(age_group,
                                     "children" = "7-9y",
                                     "adults" = "adults")) %>%
    ggplot(aes(x = reorder(capacity, order),
               fill = character, alpha = response)) +
    facet_grid(cols = vars(character), rows = vars(age_group),
               scales = "free", space = "free") +
    geom_bar(position = "stack") +
    scale_color_manual(values = c("#fb9a99", "#1f78b4")) +
    scale_fill_manual(values = c("#fb9a99", "#1f78b4")) +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
          legend.position = "bottom") +
    labs(title = whichfac,
         x = "mental capacity (by factor)",
         y = "proportion of participants")
  
  if(whichfac != "MIND"){
    fig <- fig + guides(fill = "none", alpha = "none") + labs(x = "")
  }
  
  return(fig)
}

fig03_BODY_plot <- fig03_fun("BODY")
fig03_HEART_plot <- fig03_fun("HEART")
fig03_MIND_plot <- fig03_fun("MIND")

fig03_plots <- plot_grid(fig03_BODY_plot, fig03_HEART_plot, fig03_MIND_plot,
                         nrow = 3, rel_heights = c(1, 1.11, 1.19),
                         labels = "AUTO")
```

```{r, include = T, fig.width = 4, fig.asp = 3}
fig03_with_caption <- add_sub(fig03_plots, str_wrap("Figure 3: Raw counts of responses of 'yes' (dark), 'kinda' (medium), or 'no' (light) for all mental capacity items, grouped by the factor on which they loading most positively (BODY, HEART, MIND) according to an exploratory factor analysis of adults' responses (Study 1). Each participant assessed 40 mental capacities for one of two target characters: a beetle (pink) or a robot (blue). 7- to 9-year-old children's responses and adults' responses are shown separately.", 92), x = 0, hjust = 0)
ggdraw(fig03_with_caption)
```

```{r}
d1_all_endorse <- d1_all %>%
  group_by(factor, subid) %>%
  top_n(-6, order) %>%
  ungroup() %>%
  mutate(endorse = ifelse(response_num > 0, 1, 0)) %>%
  group_by(age_group, subid, character, factor) %>%
  summarise(prop_endorse = mean(endorse, na.rm = T),
            n = length(endorse)) %>%
  ungroup()

d1_all_endorse_boot <- d1_all_endorse %>%
  group_by(age_group, character, factor) %>%
  multi_boot_standard(col = "prop_endorse") %>%
  ungroup()

figSUPP1_plot <- d1_all_endorse %>%
  filter(age_group == "children") %>%
  left_join(d1_79 %>% distinct(subid, age)) %>%
  filter(!is.na(age)) %>%
  ggplot(aes(x = age, y = prop_endorse, 
             fill = character, color = character, shape = character)) +
  facet_wrap(~ factor) +
  geom_jitter(alpha = 0.4, width = 0, height = 0.03) +
  binomial_smooth(aes(weight = n), show.legend = F) +
  # geom_smooth(method = "glm",
  #             method.args = list(family = "binomial")) +
  geom_point(data = d1_all_endorse %>% filter(age_group == "adults"),
             aes(x = 11), alpha = 0.4, show.legend = F,
             position = position_jitterdodge(dodge.width = 0.5,
                                             jitter.height = 0.03,
                                             jitter.width = 0.25)) +
  geom_pointrange(data = d1_all_endorse_boot %>% filter(age_group == "adults"),
                  aes(x = 11, y = mean, ymin = ci_lower, ymax = ci_upper),
                  position = position_dodge(width = 0.5), show.legend = F,
                  color = "black", fatten = 5) +
  scale_x_continuous(breaks = c(7:11), 
                     labels = c(paste0(7:10, "y"), "adults")) +
  scale_y_continuous(breaks = seq(0, 1, 1/6), labels = 0:6) +
  scale_color_manual(values = c("#fb9a99", "#1f78b4")) +
  scale_fill_manual(values = c("#fb9a99", "#1f78b4")) +
  scale_shape_manual(values = c(21, 22)) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
  guides(color = guide_legend(override.aes = list(alpha = 1, size = 3))) +
  labs(y = "number of items endorsed (out of 6)")
```

```{r, include = F, fig.width = 6, fig.asp = 0.7}
figSUPP1_with_caption <- add_sub(figSUPP1_plot, str_wrap("Figure SUPP1: Number of mental capacity items (out of 6) endorsed in each domain (BODY, HEART, and MIND) by 7- to 9-year-old children and adults in Study 1, in which each participant assessed 40 mental capacities for one of two target characters: a beetle (pink circles) or a robot (blue squares). We defined each domain by the 6 items that loaded the most positively on the corresponding factor in an exploratory factor analysis of adults' responses, and we considered responses of either 'yes' or 'kinda' (but not 'no') to be endorsements. Lines correspond to logistic regressions considering children's scores alone. Error bars are bootstrapped 95% confidence intervals on adults' scores.", 130), x = 0, hjust = 0)
ggdraw(figSUPP1_with_caption)
```

#### Age differences within the child sample

Of course, our sample of "children" included participants as young as 7 years and up to nearly 10 years of age. How did attributions vary across this age range? 

```{r}
d1_ch_age <- d1_79 %>% distinct(subid, age)
```

To explore age-related differences continuously within the child sample, we conducted an additional regression analysis on children's factor scores alone, including interactions with exact age in years (centered at the mean: `r format(round(mean(d1_ch_age$age, na.rm = T), 2), nsmall = 2)`y) rather than age group. In line with the age group analysis described in the previous section, this confirmed that, relative to the grand mean, attributions of _HEART_ decreased with age (`r write_b_95CI_fun(efa_3_scores_r_d1_79, "factor_nameH_GM:age")`) and attributions of _MIND_ increased with age (`r write_b_95CI_fun(efa_3_scores_r_d1_79, "factor_nameM_GM:age")`). (See Table 2 for the full results of this model.)

```{r}
# efa_3_scores_r_d1_79 <- brm(score ~ factor_name * age * character
#                             + (1|subid),
#                             data = efa_3_scores_d1_all %>%
#                               filter(age_group == "children79", !is.na(age)) %>%
#                               mutate(age = scale(age, scale = F)),
#                             seed = 12345,
#                             cores = 4,
#                             control = list(adapt_delta = 0.99))
# saveRDS(efa_3_scores_r_d1_79, file = "./brms_models/efa_3_scores_r_d1_79.rds")

efa_3_scores_r_d1_79 <- readRDS("./brms_models/efa_3_scores_r_d1_79.rds")
# summary(efa_3_scores_r_d1_79)
```

```{r, include = T, results = "asis"}
fixef(efa_3_scores_r_d1_79) %>%
  data.frame() %>%
  rownames_to_column("Parameter") %>%
  mutate(Parameter = recode_factor(Parameter,
    "Intercept" = "(Intercept)",
    "characterR_GM" = "character (robot vs. grand mean)",
    "factor_nameH_GM" = "HEART (vs. grand mean)",
    "factor_nameM_GM" = "MIND (vs. grand mean)",
    "factor_nameH_GM:characterR_GM" = "character × HEART",
    "factor_nameM_GM:characterR_GM" = "character × MIND",
    "age" = "age (mean-centered)",
    "age:characterR_GM" = "character × age",
    "factor_nameH_GM:age" = "HEART × age",
    "factor_nameM_GM:age" = "MIND × age",
    "factor_nameH_GM:age:characterR_GM" = "character × HEART × age",
    "factor_nameM_GM:age:characterR_GM" = "character × MIND × age")) %>%
  arrange(Parameter) %>%
  mutate(X = ifelse(Q2.5 * Q97.5 > 0, "*", "")) %>%
  mutate_at(vars(-Parameter, -X),
            funs(format(round(., 2), nsmall = 2))) %>%
  rename(b = Estimate, Error = Est.Error, " " = X) %>%
  unite(`95% CI`, Q2.5, Q97.5, sep = ", ") %>%
  mutate(`95% CI` = paste0("[", `95% CI`, "]")) %>%
  knitr::kable(format = "html", align = c("l", rep("r", 3)),
               caption = "Table 2: Fixed effects from a mixed-effects Bayesian regression model of children's responses, predicting factor scores in Study 1 by character (beetle, robot), factor (BODY, HEART, MIND), and exact age. The model used the formula 'factor score ~ factor * age * character + (1 | subject)' and was implemented in the 'brms' package for R (Bürkner, 2017). Factor and character were effect-coded, and age was mean-centered. Asterisks mark parameters whose 95% credible interval does not include 0.") %>%
  kable_styling() %>%
  group_rows("Collapsing across age", 1, 6) %>%
  group_rows("Age effects", 7, 12)
```

Indeed, visual inspection of Figure 4 suggests that, across all three domains (_BODY_, _HEART_, and _MIND_), children's mental capacity attributions to beetles and robots appeared to become more adult-like with age—but while the oldest children were indistinguishable from adults in the _BODY_ and _MIND_ domains, even the oldest children appear to have attributed more social-emotional abilities to these entities than most adults did.

```{r}
fig04_plot <- ggplot(efa_3_scores_d1_all %>% filter(!is.na(age)),
                     aes(x = age, y = score,
                         fill = character, color = character, shape = character)) +
  facet_wrap(~ factor_name, scales = "free") +
  geom_hline(yintercept = 0, lty = 2) +
  geom_point(alpha = 0.2) +
  geom_smooth(method = "lm", alpha = 0.25, show.legend = F) +
  geom_point(data = efa_3_scores_d1_all %>% filter(age_group == "adults"),
             aes(x = 11), alpha = 0.2, show.legend = F,
             position = position_jitterdodge(dodge.width = 0.5, 
                                             jitter.width = 0.25)) +
  geom_pointrange(data = efa_3_scores_boot_d1_all %>% filter(age_group == "adults"),
                  aes(x = 11, y = mean, ymin = ci_lower, ymax = ci_upper),
                  position = position_dodge(width = 0.5), show.legend = F,
                  color = "black", fatten = 1.25) +
  scale_x_continuous(breaks = c(7:11), 
                     labels = c(paste0(7:10, "y"), "adults")) +
  scale_y_continuous(breaks = seq(-10, 10, 1)) +
  scale_color_manual(values = c("#fb9a99", "#1f78b4")) +
  scale_fill_manual(values = c("#fb9a99", "#1f78b4")) +
  scale_shape_manual(values = c(21, 22)) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
  guides(color = guide_legend(override.aes = list(alpha = 1, size = 3)))
```

```{r, include = T, fig.width = 6, fig.asp = 0.5}
fig04_with_caption <- add_sub(fig04_plot, str_wrap("Figure 4: Factor scores for adults and 7- to 9-year-old children in Study 1, replotted to illustrate age effects within the child sample. Lines correspond to linear regressions considering children's scores alone. Error bars are bootstrapped 95% confidence intervals on adults' scores. Note that the range of the y-axis differs across panels.", 135), x = 0, hjust = 0)
ggdraw(fig04_with_caption)
```

Taken together, these analyses converge to suggest only minor differences between children and adults in their attributions of _BODY_ and _MIND_ to beetles and robots—but a major difference in _HEART_: Relative to adults, children tended to credit both beetles and robots with much greater social-emotional abilities. 

## Discussion

Study 1 shed light on two distinct aspects of the development of children's concpetual representations of mental life: continuity in the underlying conceptual _structure_ and variabilty in the _application_ of these concepts. 

On the one hand, exploratory factor analyses suggested that by midddle childhood (7-9y), the conceptual structure underlying US children's attributions of mental life is very similar to that of US adults, anchored by suites of mental capacities related to _BODY_ (physiological sensations), _HEART_ (social-emotional abilities), and _MIND_ (perceptual-cognitive abilities). We note that, in principle, a number of additional or alternative latent factors could have emerged from the factor analysis of children's responses. For example, children might have distinguished primarily between internal experience and external action (Gray et al., 2007), or they might have demonstrated finer-grained groupings of mental capacities based on phrasing, rote knowledge, etc. Instead, the latent conceptual structure underlying children's responses appears to be very similar to that of adults, both in this study and in Weisman et al.'s (2017) previous work. In other words, any dramatic developmental changes to this conceptual structure likely occur prior to the age of 7 years.

On the other hand, analyses of children's attributions within this shared conceptual structure suggested that their application of this concept—in particular, their attributions of the social-emotional abilities of the _HEART_—may be undergoing continuing refinement through middle childhood. The specificity of this age difference—which emerged dramatically in one domain (_HEART_), but not others (_BODY_, _MIND_)—suggests that this is unlikely to be due either to a general tendency toward "mentalizing" these characters (or a simple "yes" bias). But its extension to both beetles and robots raises many questions. With regard to robots, children growing up in the 21st century might be converging on a new understanding of technological "beings" as inanimate objects with some degree of social-emotional life (see Kahn, Gary, & Shen, 2013)—but this kind of historical conceptual change would not predict the high rates of social-emotional attributions to beetles that we observed. Our findings are perhaps more consistent with a general openness to untraditional social partners that extends into middle childhood (but not adulthood)—or with a difference in construals of what it means to feel proud, happy, guilty, etc. To what kinds of entities would children of this age deny social-emotional abilities, and how do they draw this line? How would younger children's attributions of _HEART_ (as well as _BODY_ and _MIND_) compare?

# Study 2

The goals of Study 2 were threefold. 

First, we aimed to extend our findings with 7- to 9-year-old children in Study 1, by expanding the list of the target characters to include not only the two "edge cases" from Study 1 (a beetle and a robot), but a also a wider range of animate beings (a bird, a goat, and an elephant) and inanimate objects (a computer, a teddy bear, and a doll). In contrast to Study 1, where we tracked which mental capacities "hang together" when participants reasoned about controversial "edge cases" in social reasoning, Study 2 allowed us to track which mental capacities "hang together" when target characters are perceived to vary in their mental capacity profiles. In Weisman et al.'s original studies, this approach yielded a highly similar conceptual structure to the "edge case" approach (Weisman et al., 2017; Study 4). We reasoned that if this three-part conceptual structure is stable and robust by the age of 7-9 years, it should manifest among 7- to 9-year-old children under the same range of conditions that it does among adults. 

Our second goal was to assess the earlier development of conceptual structure in a group of younger children. We targeted 4- to 6-year-old children for our younger age group because this has been identified as a period of dramatic development in several relevant domains. Many studies have documented shifts in children's abilities to take others' perspectives, represent false beliefs, and integrate representations of intentions and outcomes in evaluating moral responsibility (for reveiws, see Flavell, 1999; Wellman, 2015). The preschool years have also been the focus of a rich tradition of work on lay biology and the animate-inanimate distinction extending back nearly a century (e.g., Carey, 1985; R. Gelman, Spelke, & Meck, 1983; Medin, Waxman, Woodring, & Washinawatok, 2010; Piaget, 1929; for a review, see S. Gelman & Opfer, 2002). All of these accounts make the case that becoming a sophisticated reasoner—and particularly a sophisticated social reasoner—requires substantial refinement of one's representations of others' experiences, beliefs, desires, and needs. Might these refinements include changes to the structure of children's concepts of mental life? 

Our third goal was to examine age-related changes in which mental capacities tend to be attributed to which target characters. In summarizing the results of Study 1, we discussed mental capacity attributions as the "application" of concepts of mental life, in contrast to the conceptual "structure" revealed by exploratory factor analysis. By expanding the range of target characters included in the study, Study 2 provides an opportunity to explore changes in how children apply their developing concepts of mental life to a variety of animate beings and inanimate objects.

## Method

### Participants

`r nrow(d2_ad_wide) + nrow(d2_79_wide)` people participated in this study, including a group of adults, a group of "older" children (7-9y), and a group of "younger" children (4-6y).

```{r}
# demographics
d2_ad_gender <- demo_fun(d2_ad, "gender", 2)
d2_ad_ethnicity <- demo_fun(d2_ad, "ethnicity_cat", 2)
```

Adults (_n_=`r nrow(d2_ad_wide)`) participated via MTurk in September 2018. Adult participants had gained approval for at least 95% of their previous work on MTurk; had MTurk accounts based in the US; and indicated that they were at least 18 years old. Adults were paid \$0.45 for approximately 2-4 minutes of their time (median duration: `r summary(d2_ad$duration)["Median"] %>% round(2)` min). An additional 22 adults participated but were excluded for failing to respond sensibly to an open-ended question about what they had been asked to do in the study (e.g., copying and pasting text from the question, writing "good study," or describing a different study, e.g., "I wrote an essay about nature"; _n_=11) or for failing to pass one or more attention checks (e.g., "Please select no"; _n_=11). According to self report, the final adult sample ranged in age from `r summary(d2_ad$age)["Min."]`-`r summary(d2_ad$age)["Max."]` years (median: `r summary(d2_ad$age)["Median"]`y) and included slightly more men (`r round(d2_ad_gender$prop[d2_ad_gender$gender=="m"], 2) * 100`%) than women (`r round(d2_ad_gender$prop[d2_ad_gender$gender=="f"], 2) * 100`%). Adults predominantly identified as White (`r d2_ad_ethnicity$prop[d2_ad_ethnicity$ethnicity_cat=="white"] * 100`%; `r d2_ad_ethnicity$prop[d2_ad_ethnicity$ethnicity_cat=="multi"] * 100`% identified as more than one race/ethnicity, and $\leq$ `r data.frame(d2_ad_ethnicity %>% filter(!ethnicity_cat %in% c("white", "multi")))$prop %>% max() * 100`% as any other race/ethnicity).

```{r}
# demographics
d2_79_gender <- demo_fun(d2_79, "gender", 2)
d2_79_ethnicity <- demo_fun(d2_79, "ethnicity", 2)
d2_46_gender <- demo_fun(d2_46, "gender", 2)
d2_46_ethnicity <- demo_fun(d2_46, "ethnicity", 2)
```

We recruited two groups of children: "older" children (7-9y) and "younger" children (4-6y). Our planned sample size was 120 per age group, but we also retained a handful of extra participants who completed the study on the final day of data collection for each group.

The group that we will refer to as "older children" (_n_=`r nrow(d2_79_wide)`) ranged in age from `r summary(d2_79$age)["Min."] %>% round(2) %>% format(nsmall = 2)`-`r summary(d2_79$age)["Max."] %>% round(2) %>% format(nsmall = 2)` years (median: `r summary(d2_79$age)["Median"] %>% round(2) %>% format(nsmall = 2)`y), and participated at one of several San Francisco Bay Area museums or at their younger sibling's preschool between July-December 2016. The study took most older children under `r quantile(d2_79$duration, .75, na.rm = T) %>% as.numeric() %>% ceiling()` minutes to complete (median duration: `r summary(d2_79$duration)["Median"] %>% round(2) %>% format(nsmall = 2)` min). According to parental report, the sample of older children included slightly more boys (`r d2_79_gender$prop[d2_79_gender$gender=="m"] * 100`%) than girls (`r d2_79_gender$prop[d2_79_gender$gender=="f"] * 100`%); `r d2_79_gender$prop[d2_79_gender$gender=="MISSING"] * 100`% of children's gender was non-binary or unknown). Parents predominantly identified their children as White (`r d2_79_ethnicity$prop[d2_79_ethnicity$ethnicity=="white"] * 100`%), South Asian (`r d2_79_ethnicity$prop[d2_79_ethnicity$ethnicity=="south or southeast asian"] * 100`%), multiracial (`r d2_79_ethnicity$prop[d2_79_ethnicity$ethnicity=="multi"] * 100`%), or East Asian (`r d2_79_ethnicity$prop[d2_79_ethnicity$ethnicity=="east asian"] * 100`%); $\leq$ `r data.frame(d2_79_ethnicity %>% filter(!ethnicity %in% c("white", "multi", "east asian", "south or southeast asian", "MISSING")))$prop %>% max() * 100`% of children were identified as any other race/ethnicity, and `r d2_79_ethnicity$prop[d2_79_ethnicity$ethnicity=="MISSING"] * 100`% of children's parents declined to provide information on their race/ethnicity). 

"Younger children" (_n_=`r nrow(d2_46_wide)`) ranged in age from `r summary(d2_46$age)["Min."] %>% round(2) %>% format(nsmall = 2)`-`r summary(d2_46$age)["Max."] %>% round(2) %>% format(nsmall = 2)` years (median: `r summary(d2_46$age)["Median"] %>% round(2) %>% format(nsmall = 2)`y), and participated either at a university-affiliated preschool or at a Bay Area museum between January-June 2017. The study took most younger children under `r quantile(d2_46$duration, .75, na.rm = T) %>% as.numeric() %>% ceiling()` minutes to complete (median duration: `r summary(d2_46$duration)["Median"] %>% round(2) %>% format(nsmall = 2)` min). According to parental report and school records, the sample of younger children included roughly the same numbers of girls (`r d2_46_gender$prop[d2_46_gender$gender=="m"] * 100`%) and boys (`r d2_46_gender$prop[d2_46_gender$gender=="f"] * 100`%). Children were predominantly identified as multiracial (`r d2_46_ethnicity$prop[d2_46_ethnicity$ethnicity=="multi"] * 100`%) or White (`r d2_46_ethnicity$prop[d2_46_ethnicity$ethnicity=="white"] * 100`%; $\leq$ `r data.frame(d2_46_ethnicity %>% filter(!ethnicity %in% c("white", "multi", "MISSING")))$prop %>% max() * 100`% of children were identified as any other race/ethnicity, and `r d2_46_ethnicity$prop[d2_46_ethnicity$ethnicity=="MISSING"] * 100`% of children's parents declined to provide information on their race/ethnicity).

An additional 7 children participated but were excluded for being outside the target age ranges. At museums (but not at the preschool), children received a small thank-you gift (e.g., a sticker) for their participation. 

### Materials and procedure

Pilot testing suggested that working with younger children would require making a briefer experimental paradigm with fewer than the 40 questions included in Study 1; limiting the list to 20 questions seemed to allow children as young as 4 years of age to complete the study easily and without getting bored or frustrated, while still including enough items to enable us to proceed with our exploratory "dimensionality reduction" approach to uncovering conceptual structure.

```{r}
d2_ad_char <- demo_fun(d2_ad, "character")
d2_79_char <- demo_fun(d2_79, "character")
d2_46_char <- demo_fun(d2_46, "character")
d2_all_char <- d2_ad_char %>% mutate(age_group = "adults") %>%
  full_join(d2_79_char %>% mutate(age_group = "children79")) %>%
  full_join(d2_46_char %>% mutate(age_group = "children46"))
```

Participants were assigned to evaluate one of the following target characters: an elephant, a goat, a mouse, a bird, a beetle, a teddy bear, a doll, a robot, or a computer (_n_ per characater: `r min(d2_ad_char$n)`-`r max(d2_ad_char$n)` adults, `r min(d2_79_char$n)`-`r max(d2_79_char$n)` older children, and `r min(d2_46_char$n)`-`r max(d2_46_char$n)` younger children; see Figure 6 for exact counts).

Participants were assigned to target characters randomly, with two exceptions: (1) The doll and teddy bear conditions were run last for older children (but included in the initial randomization scheme for adults and younger children); and (2) Toward the end of data collection with children, children were assigned to conditions that had the fewest participants. (This was not possible with adults, which is why the number of adults per condition was more variable than the number of children per condition.) As in Study 1, a vivid, high-resolution photo of the target character in a naturalistic context was visible for the duration of the study. 

Instructions and procedure were identical to Study 1, with two exceptions: (1) Participants rated the target character on 20 (rather than 40) mental capacities; and (2) For younger children, the experimenter read all questions out loud and children responded verbally. 

The 20 mental capacities were a subset of the 40 items used in Study 1, chosen to include physiological sensations, emotional experiences, perceptual abilities, cognitive skills, capacities related to autonomy or agency, and social abilities; and to include some of the strongest-loading items for each of the three factors uncovered among adults in Study 1 (see Figure 1). As in Study 1, each mental capacity was associated with a short, preset definition. Both older and younger children were encouraged at the beginning of the study to ask questions if they did not know what a word meant, in which case they were given these definitions. (Adults did not have access to these definitions.)

After completing the 20 questions about mental capacities, for a subset of participants we also asked two additional questions: "Is a [target] made out of metal?" and "Can a [target] be turned on and off?" These questions were always asked last, and were not intended to be included in any of our primary analyses. See SOM for an analysis of responses to these questions.

### Data processing

We planned to drop trials with response times that were faster than a preset criterion of 250ms, but there were none among children, and we failed to record response times among adults. As in Study 1, we retained participants regardless of skipped trials. Overall, none of adults or older children's trials, and only `r round(sum(is.na(d2_46_wide))/sum(!is.na(d2_46_wide))*100, 2)`% of younger children's trials (_n_=`r sum(is.na(d2_46_wide))`) were missing data.

For our exploratory factor analyses, we looked at each group of partipants (adults, older children, and younger children) separately, because EFA is a group-level analysis of the consensual conceptual structure and is not designed to model continuous participant-level variables like exact age. Our goal with these analyses was to examine discrete “snapshots” of this conceptual structure at two points in this continuous developmental trajectory.

## Results

### Conceptual structure: Adults

```{r}
# implement 3 factor retention protocols
nfact_par_d2_ad <- fa.parallel(d2_ad_wide_i, cor = chosen_cor, 
                               fm = chosen_fm, plot = F)$nfact
nfact_bic_d2_ad <- vss(d2_ad_wide_i, cor = chosen_cor, rotate = chosen_rot, 
                       fm = chosen_fm, plot = F)$vss.stats$BIC %>% which.min()
nfact_wdm_d2_ad <- reten_fun(d2_ad_wide_i, rot_type = chosen_rot)

cat("Parallel analysis: ", nfact_par_d2_ad,
    "\nMinimizing BIC: ", nfact_bic_d2_ad,
    "\nWeisman et al.: ", nfact_wdm_d2_ad)
```

```{r}
efa_4_d2_ad <- fa_fun(d2_ad_wide_i, 4)
```

As in Study 1, two or our three methods for determining how many factors to retain (in this case, parallel analysis and Weisman et al.'s factor retention criteria) suggested retaining three factors. (Minimizing BIC suggested retaining four factors, but the fourth factor was the dominant factor for only `r top_n_domCap(efa_4_d2_ad, 20, "F4", "pos") %>% length()` mental capacity: `r top_n_domCap(efa_4_d2_ad, 20, "F4", "pos")`; see SOM.)

```{r}
efa_3_d2_ad <- fa_fun(d2_ad_wide_i, 3)
efa_3_plot_d2_ad <- heatmap_fun(efa_3_d2_ad, 
                                factor_names = c("BODY", "HEART", "MIND")) +
  labs(title = paste0("Adults (n=", nrow(d2_ad_wide_i), ")")) +
  guides(fill = "none")
```

As expected, the conceptual structure revealed by this analysis among adults was characterized by a three-way distinction between _BODY_ (first factor, `r round(efa_3_d2_ad$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution), _HEART_ (first factor, `r round(efa_3_d2_ad$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of shared variance), and _MIND_ (first factor, `r round(efa_3_d2_ad$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of shared variance). See Figure 5, Panel D.

This suggests that our modified child-friendly paradigm was valid: Using a shorter list of items and a wider range of target characters elicited the same intuitive ontology of mental life, among US adults, that was revealed in Study 1 and in Weisman et al.'s (2017) previous work. 

### Conceptual structure: Older children (7-9y)

```{r}
# implement 3 factor retention protocols
nfact_par_d2_79 <- fa.parallel(d2_79_wide_i, cor = chosen_cor, 
                               fm = chosen_fm, plot = F)$nfact
nfact_bic_d2_79 <- vss(d2_79_wide_i, cor = chosen_cor, rotate = chosen_rot, 
                       fm = chosen_fm, plot = F)$vss.stats$BIC %>% which.min()
nfact_wdm_d2_79 <- reten_fun(d2_79_wide_i, rot_type = chosen_rot)

cat("Parallel analysis: ", nfact_par_d2_79,
    "\nMinimizing BIC: ", nfact_bic_d2_79,
    "\nWeisman et al.: ", nfact_wdm_d2_79)
```

```{r}
efa_3_d2_79 <- fa_fun(d2_79_wide_i, 3)

efa_3_plot_d2_79 <- heatmap_fun(efa_3_d2_79, 
                                factor_names = c("BODY", "HEART", "MIND")) +
  labs(title = paste0("Older children (7-9y, n=", nrow(d2_79_wide_i), ")")) +
  guides(fill = "none")
```

```{r}
cong_efa_3_d2_ad_79 <- fa.congruence(efa_3_d2_79$loadings,
                                     efa_3_d2_ad$loadings)
```

Our three methods for determining how many factors to retain all suggested retaining three factors. As in Study 1, the conceptual structure revealed by this analysis among 7- to 9-year-old children was very similar to that of adults, again characterized by a three-way distinction between _BODY_, _HEART_, and _MIND_.

After rotation, the first factor corresponded primarily to physiological sensations. An analysis of factor congruence confirmed that this factor was most similar to adults' _BODY_ factor (cosine similarity with _BODY_: `r cong_efa_3_d2_ad_79["F1", "F1"]`; with _HEART_: `r cong_efa_3_d2_ad_79["F1", "F2"]`; with _MIND_: `r cong_efa_3_d2_ad_79["F1", "F3"]`). It was the dominant factor for such items as `r top_n_domCap(efa_3_d2_79, 4, "F1", "pos")`, and accounted for `r round(efa_3_d2_79$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution. 

The second factor corresponded primarily to social-emotional abilities. An analysis of factor congruence confirmed that this factor was most similar to adults' _HEART_ factor (cosine similarity with _HEART_: `r cong_efa_3_d2_ad_79["F2", "F2"]`; with _BODY_: `r cong_efa_3_d2_ad_79["F2", "F1"]`; with _MIND_: `r cong_efa_3_d2_ad_79["F2", "F3"]`). It was the dominant factor for such items as `r top_n_domCap(efa_3_d2_79, 4, "F2", "pos")`, and accounted for `r round(efa_3_d2_79$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution. 

The third factor corresponded primarily to perceptual-cognitive abilities. An analysis of factor congruence confirmed that this factor was most similar to adults' _MIND_ factor (cosine similarity with _MIND_: `r cong_efa_3_d2_ad_79["F3", "F3"]`; with _HEART_: `r cong_efa_3_d2_ad_79["F3", "F2"]`; with _BODY_: `r cong_efa_3_d2_ad_79["F3", "F1"]`). It was the dominant factor for such items as `r top_n_domCap(efa_3_d2_79, 4, "F3", "pos")`, and accounted for `r round(efa_3_d2_79$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution. (See Figure 5, Panel C, for all factor loadings.)

We consider this to be a close conceptual replication of our Study 1 findings, suggesting that by the age of 7-9 years, this three-part conceptual structure is stable and robust to a range of experimental conditions.

### Conceptual structure: Younger children (4-6y)

```{r}
# implement 3 factor retention protocols
nfact_par_d2_46 <- fa.parallel(d2_46_wide_i, cor = chosen_cor, 
                               fm = chosen_fm, plot = F)$nfact
nfact_bic_d2_46 <- vss(d2_46_wide_i, cor = chosen_cor, rotate = chosen_rot, 
                       fm = chosen_fm, plot = F)$vss.stats$BIC %>% which.min()
nfact_wdm_d2_46 <- reten_fun(d2_46_wide_i, rot_type = chosen_rot)

cat("Parallel analysis: ", nfact_par_d2_46,
    "\nMinimizing BIC: ", nfact_bic_d2_46,
    "\nWeisman et al.: ", nfact_wdm_d2_46)
```

```{r}
efa_1_d2_46 <- fa_fun(d2_46_wide_i, 1)
```

Our three methods for determining how many factors to retain each suggested retaining different numbers of factors: Weisman et al.'s factor retention criteria suggested retaining `r nfact_wdm_d2_46` factors, parallel analysis suggested retaining `r nfact_par_d2_46` factors, and minimizing BIC suggested a null, `r nfact_bic_d2_46`-factor solution. Here we present both the two- and three-factor solutions. (See SOM for factor loadings on the one "factor" in the null, one-factor solution, which yielded particularly strong loadings for social-emotional experiences and physiological sensations, such as `r top_n_domCap(efa_1_d2_46, 4, "F1")`.)

#### Three-factor solution

```{r}
efa_3_d2_46 <- fa_fun(d2_46_wide_i, 3)

efa_3_plot_d2_46 <- heatmap_fun(efa_3_d2_46,
                                factor_names = c("BODY*", "MIND", "HEART*")) +
  labs(title = paste0("Youner children (4-6y, n=", nrow(d2_79_wide_i), "): 3-factor solution")) +
  guides(fill = "none")
```

```{r}
cong_efa_3_d2_ad_46 <- fa.congruence(efa_3_d2_46$loadings,
                                     efa_3_d2_ad$loadings)
```

In the rotated three-factor solution suggested by Weisman et al.'s retention criteria, the first factor corresponded primarily to physiological sensations, as well as some positive emotions. An analysis of factor congruence indicated that this factor was most similar to adults' _BODY_ factor (cosine similarity with _BODY_: `r cong_efa_3_d2_ad_46["F1", "F1"]`), but was also quite similar to adults' _HEART_ factor (cosine similarity with _HEART_: `r cong_efa_3_d2_ad_46["F1", "F2"]`; with _MIND_: `r cong_efa_3_d2_ad_46["F1", "F3"]`). It was the dominant factor for such items as `r top_n_domCap(efa_3_d2_46, 4, "F1", "pos")`, and accounted for `r round(efa_3_d2_46$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated three-factor solution. 

The second factor corresponded primarily to perceptual-cognitive abilities, as well as one complex negative emotion (_feel guilty_). An analysis of factor congruence confirmed that this factor was most similar to adults' _MIND_ factor (cosine similarity with _MIND_: `r cong_efa_3_d2_ad_46["F2", "F3"]`; with _HEART_: `r cong_efa_3_d2_ad_46["F2", "F2"]`; with _BODY_: `r cong_efa_3_d2_ad_46["F2", "F1"]`). It was the dominant factor for such items as `r top_n_domCap(efa_3_d2_46, 4, "F2", "pos")`, and accounted for `r round(efa_3_d2_46$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution. 

The third factor corresponded primarily to social-emotional abilities, with particularly strong loadings for positive emotions. An analysis of factor congruence indicated that this factor was most similar to adults' _HEART_ factor (cosine similarity with _HEART_: `r cong_efa_3_d2_ad_46["F3", "F2"]`), but also quite similar to adults' _BODY_ factor (cosine similarity with _BODY_: `r cong_efa_3_d2_ad_46["F3", "F1"]`; with _MIND_: `r cong_efa_3_d2_ad_46["F3", "F3"]`). It was the dominant factor for such items as `r top_n_domCap(efa_3_d2_46, 4, "F3", "pos")`, and accounted for `r round(efa_3_d2_46$Vaccounted["Proportion Explained", "F3"], 2) * 100`% of the shared variance in the rotated three-factor solution. (See Figure 5, Panel B, for all factor loadings.)

We would describe this conceptual structure as reminiscent of the _BODY_-_HEART_-_MIND_ structure found among older children and adults, but not as fully "adult-like." In particular, in this structure, the physiological sensations associated with the _BODY_ among older children and adults are not as clearly differentiated from the emotional experiences associated with the _HEART_. Indeed, it it not clear that _BODY_ vs. _HEART_ is the most salient distinction among the first and third factors in this solution: A cleaner description of these factors might be negatively-valenced experiences vs. positively-valenced experiences. 

#### Two-factor solution

```{r}
efa_2_d2_46 <- fa_fun(d2_46_wide_i, 2)

efa_2_plot_d2_46 <- heatmap_fun(efa_2_d2_46,
                                factor_names = c("BODY-HEART", "MIND")) +
  labs(title = paste0("Youner children (4-6y, n=", nrow(d2_79_wide_i), "): 2-factor solution"))
```

```{r}
cong_efa_2_d2_ad_46 <- fa.congruence(efa_2_d2_46$loadings,
                                     efa_3_d2_ad$loadings)
```

In the rotated two-factor solution suggested by parallel analysis, the first factor encompassed both physiological sensations and emotions. An analysis of factor congruence indicated that this factor was most similar to adults' _BODY_ factor (cosine similarity with _BODY_: `r cong_efa_2_d2_ad_46["F1", "F1"]`), but was also quite similar to adults' _HEART_ factor (cosine similarity with _HEART_: `r cong_efa_2_d2_ad_46["F1", "F2"]`; with _MIND_: `r cong_efa_2_d2_ad_46["F1", "F3"]`). It was the dominant factor for such items as `r top_n_domCap(efa_2_d2_46, 4, "F1", "pos")`, and accounted for `r round(efa_2_d2_46$Vaccounted["Proportion Explained", "F1"], 2) * 100`% of the shared variance in the rotated two-factor solution. 

The second factor corresponded primarily to perceptual-cognitive abilities, as well as one complex negative emotion (_feel guilty_). An analysis of factor congruence confirmed that this factor was most similar to adults' _MIND_ factor (cosine similarity with _MIND_: `r cong_efa_2_d2_ad_46["F2", "F3"]`; with _HEART_: `r cong_efa_2_d2_ad_46["F2", "F1"]`; with _BODY_: `r cong_efa_2_d2_ad_46["F2", "F1"]`). It was the dominant factor for such items as `r top_n_domCap(efa_2_d2_46, 4, "F2", "pos")`, and accounted for `r round(efa_2_d2_46$Vaccounted["Proportion Explained", "F2"], 2) * 100`% of the shared variance in the rotated three-factor solution. (See Figure 5, Panel A, for all factor loadings.)

In relation to the _BODY_-_HEART-_MIND_ structure found among older children and adults, we would describe this two-factor structure as being anchored by a contrast between the cognitive capacities of the _MIND_ vs. a set of warmer, more visercal experiences that constitute a more integrated representation of _BODY-HEART_.

```{r, include = T, fig.width = 6, fig.asp = 1}
fig05_plots <- plot_grid(efa_2_plot_d2_46, efa_3_plot_d2_46, 
                         efa_3_plot_d2_79, efa_3_plot_d2_ad,
                         labels = c("A", "B", "C", "D"))
fig05_with_caption <- add_sub(fig05_plots, str_wrap("Figure 5: Exploratory factor analysis results for 4- to 6-year-old children (A-B), 7- to 9-year-old children (B) and adults (C) in Study 2, in which each participant assessed 20 mental capacities for one of nine target characters: a computer, a robot, a doll, a teddy bear, a beetle, a bird, a mouse, a goat, or an elephant. For younger children, we include both the two-factor solution suggested by parallel analysis (A) and the three-factor solution suggested by Weisman et al.'s (2017) factor retention criteria (B).", 143), x = 0, hjust = 0)
ggdraw(fig05_with_caption)
```

### Attributions of mental life

In Study 1, we saw that even children as old as 7-9y—whose conceptual structure seemed to be quite similar to that of adults'—nonetheless differed from adults in their _application_ of this concept, attributing far more of the social-emotional abilities related to the _HEART_ to both beetles and robots. How do children's mental capacity attributions compare to adults for the larger set of target characters included in Study 2—and what does this aspect of conceptual developmental look like earlier in development (4-6y)?

#### Differences across age groups

```{r}
d2_all_wide_i <- d2_ad_wide_i %>%
  rownames_to_column("subid_char") %>%
  full_join(d2_79_wide_i %>%
              rownames_to_column("subid_char")) %>%
  full_join(d2_46_wide_i %>%
              rownames_to_column("subid_char")) %>%
  column_to_rownames("subid_char")
```

```{r}
efa_3_d2_79_project_scores <- predict(object = efa_3_d2_ad,
                                      data = d2_79_wide_i,
                                      old.data = d2_ad_wide_i) %>%
  data.frame() %>%
  rownames_to_column("subid_char") %>%
  mutate(subid = gsub("_.*$", "", subid_char),
         character = gsub("^.*_", "", subid_char),
         age_group = "children79") %>%
  gather(factor, score, -c(subid, character, subid_char, age_group)) %>%
  mutate(factor_name = recode_factor(factor,
                                     "F1" = "BODY",
                                     "F2" = "HEART",
                                     "F3" = "MIND")) %>%
  arrange(subid_char)
```

```{r}
efa_3_d2_46_project_scores <- predict(object = efa_3_d2_ad,
                                      data = d2_46_wide_i,
                                      old.data = d2_ad_wide_i) %>%
  data.frame() %>%
  rownames_to_column("subid_char") %>%
  mutate(subid = gsub("_.*$", "", subid_char),
         character = gsub("^.*_", "", subid_char),
         age_group = "children46") %>%
  gather(factor, score, -c(subid, character, subid_char, age_group)) %>%
  mutate(factor_name = recode_factor(factor,
                                     "F1" = "BODY",
                                     "F2" = "HEART",
                                     "F3" = "MIND")) %>%
  arrange(subid_char)
```

Following Study 1, we projected all of children's responses into the factor space defined by adults (standardized in terms of adults' responses), and examined factor scores by age group (again, using the method articulated by ten Berge et al., 1999). As in Study 1, this yielded three scores for each participant, corresponding, in principle, to holistic judgments of the social-emotional, physiological, and perceptual-cognitive abilities of the target character the participant evaluated. (Note that each of these three scores takes into account adult factor loadings for all 20 mental capacities, as shown in Figure 5, Panel D.) 

This allowed us to examine the effects of age group (younger children, older children, adults), factor (_BODY_, _HEART_, _MIND_), and target character on these scores via mixed effects Bayesian regression. As in Study 1, factor was effect-coded, and age group was dummy-coded with adults as the baseline, to assess whether children in each age group were "adult-like" in their assessments. To examine differences in mental capacity attributions to different target characters, we coded each character as either "animate" (elephant, goat, mouse, bird, beetle) or "inanimate" (computer, robot, doll, teddy bear), and included animacy status (effect-coded) as a fixed effect in our regression model. We included intercepts and slopes for individual characters as random effets in our model, along with intercepts for individual participants.[^1]

[^1]: We notes that the complexities of the design of Study 2 could lend themselves to more complex models than what we have presented here, and we encourage readers to examine a model including multiple comparisons between sets of characters (e.g., mammals vs. non-mammals; technologies vs. toys) presented in the SOM. All of the effects described below also hold true in this more complex model.

The results of this model can be found in Table 3. 

```{r}
efa_3_scores_d2_all <- efa_3_d2_ad$scores %>%
  data.frame() %>%
  rownames_to_column("subid_char") %>%
  gather(factor, score, -subid_char) %>%
  mutate(subid = gsub("_computer", "", subid_char),
         subid = gsub("_robot", "", subid),
         subid = gsub("_doll", "", subid),
         subid = gsub("_teddy_bear", "", subid),
         subid = gsub("_beetle", "", subid),
         subid = gsub("_bird", "", subid),
         subid = gsub("_mouse", "", subid),
         subid = gsub("_goat", "", subid),
         subid = gsub("_elephant", "", subid),
         character = gsub("^.*_", "", subid_char),
         age_group = "adults",
         factor_name = recode_factor(factor,
                                     "F1" = "BODY",
                                     "F2" = "HEART",
                                     "F3" = "MIND")) %>%
  ungroup() %>%
  distinct() %>%
  full_join(efa_3_d2_79_project_scores %>% 
              left_join(d2_79 %>% distinct(subid, age_group, age))) %>%
  full_join(efa_3_d2_46_project_scores %>% 
              left_join(d2_46 %>% distinct(subid, age_group, age))) %>%
  mutate(character = case_when(
    grepl("bear", as.character(character)) ~ "teddy bear", 
    TRUE ~ as.character(character))) %>%
  mutate_at(vars(starts_with("factor"), character, age_group), funs(factor)) %>%
  mutate(character = factor(character,
                            levels = c("computer", "robot", "doll", "teddy bear",
                                       "beetle", "bird", "mouse", "goat",
                                       "elephant")),
         age_group = factor(age_group,
                            levels = c("children46", "children79", "adults")))

efa_3_scores_boot_d2_all <- efa_3_scores_d2_all %>%
  group_by(age_group, factor, factor_name, character) %>%
  multi_boot_standard(col = "score") %>%
  ungroup()
```

```{r}
contrasts(efa_3_scores_d2_all$character) <- cbind(
  "anim_inan" = c(-5, -5, -5, -5, 4, 4, 4, 4, 4),
  "mamm_nonm" = c(0, 0, 0, 0, -3, -3, 2, 2, 2),
  "elep_gomo" = c(0, 0, 0, 0, 0, 0, -1, -1, 2),
  "goat_mous" = c(0, 0, 0, 0, 0, 0, -1, 1, 0),
  "bird_beet" = c(0, 0, 0, 0, -1, 1, 0, 0, 0),
  "tech_toys" = c(1, 1, -1, -1, 0, 0, 0, 0, 0),
  "robo_comp" = c(-1, 1, 0, 0, 0, 0, 0, 0, 0),
  "tedd_doll" = c(0, 0, -1, 1, 0, 0, 0, 0, 0))
contrasts(efa_3_scores_d2_all$age_group) <- cbind("CH46_AD" = c(1, 0, 0),
                                                  "CH79_AD" = c(0, 1, 0))
contrasts(efa_3_scores_d2_all$factor_name) <- cbind("H_GM" = c(-1, 1, 0),
                                                    "M_GM" = c(-1, 0, 1))

# efa_3_scores_r_d2_all <- brm(score ~ factor_name * age_group * character
#                              + (1|subid),
#                              data = efa_3_scores_d2_all,
#                              seed = 12345,
#                              cores = 4,
#                              control = list(adapt_delta = 0.99))
# saveRDS(efa_3_scores_r_d2_all, file = "./brms_models/efa_3_scores_r_d2_all.rds")

efa_3_scores_r_d2_all <- readRDS(file = "./brms_models/efa_3_scores_r_d2_all.rds")
# summary(efa_3_scores_r_d2_all)
```

```{r, results = "asis"}
# full model
# fixef(efa_3_scores_r_d2_all) %>% 
#   data.frame() %>%
#   rownames_to_column("Parameter") %>%
#   mutate(Parameter = recode_factor(Parameter,
#     "Intercept" = "(Intercept)",
#     "characteranim_inan" = "characters: animates vs. inanimates",
#     "charactermamm_nonm" = "characters: mammals vs. other animals",
#     "characterelep_gomo" = "characters: elephant vs. other mammals",
#     "charactergoat_mous" = "characters: goat vs. mouse",
#     "characterbird_beet" = "characters: bird vs. beetle",
#     "charactertech_toys" = "characters: technologies vs. toys",
#     "characterrobo_comp" = "characters: robot vs. computer",
#     "charactertedd_doll" = "characters: teddy bear vs. doll",
#     "factor_nameH_GM" = "HEART (vs. grand mean)",
#     "factor_nameM_GM" = "MIND (vs. grand mean)",
#     "age_groupCH46_AD" = "age group (4-6y vs. adults)",
#     "age_groupCH79_AD" = "age group (7-9y vs. adults)",
#     "factor_nameH_GM:characteranim_inan" = "characters (animates/inanimates) × HEART",
#     "factor_nameH_GM:charactermamm_nonm" = "characters (mammals/other animals) × HEART",
#     "factor_nameH_GM:characterelep_gomo" = "characters (elephant/other mammals) × HEART",
#     "factor_nameH_GM:charactergoat_mous" = "characters (goat/mouse) × HEART",
#     "factor_nameH_GM:characterbird_beet" = "characters (bird/beetle) × HEART",
#     "factor_nameH_GM:charactertech_toys" = "characters (technologies/toys) × HEART",
#     "factor_nameH_GM:characterrobo_comp" = "characters (robot/computer) × HEART",
#     "factor_nameH_GM:charactertedd_doll" = "characters (teddy bear/doll) × HEART",
#     "factor_nameM_GM:characteranim_inan" = "characters (animates/inanimates) × MIND",
#     "factor_nameM_GM:charactermamm_nonm" = "characters (mammals/other animals) × MIND",
#     "factor_nameM_GM:characterelep_gomo" = "characters (elephant/other mammals) × MIND",
#     "factor_nameM_GM:charactergoat_mous" = "characters (goat/mouse) × MIND",
#     "factor_nameM_GM:characterbird_beet" = "characters (bird/beetle) × MIND",
#     "factor_nameM_GM:charactertech_toys" = "characters (technologies/toys) × MIND",
#     "factor_nameM_GM:characterrobo_comp" = "characters (robot/computer) × MIND",
#     "factor_nameM_GM:charactertedd_doll" = "characters (teddy bear/doll) × MIND",
#     "age_groupCH46_AD:characteranim_inan" = "characters (animates/inanimates) × age group (4-6y/adults)",
#     "age_groupCH46_AD:charactermamm_nonm" = "characters (mammals/other animals) × age group (4-6y/adults)",
#     "age_groupCH46_AD:characterelep_gomo" = "characters (elephant/other mammals) × age group (4-6y/adults)",
#     "age_groupCH46_AD:charactergoat_mous" = "characters (goat/mouse) × age group (4-6y/adults)",
#     "age_groupCH46_AD:characterbird_beet" = "characters (bird/beetle) × age group (4-6y/adults)",
#     "age_groupCH46_AD:charactertech_toys" = "characters (technologies/toys) × age group (4-6y/adults)",
#     "age_groupCH46_AD:characterrobo_comp" = "characters (robot/computer) × age group (4-6y/adults)",
#     "age_groupCH46_AD:charactertedd_doll" = "characters (teddy bear/doll) × age group (4-6y/adults)",
#     "age_groupCH79_AD:characteranim_inan" = "characters (animates/inanimates) × age group (7-9y/adults)",
#     "age_groupCH79_AD:charactermamm_nonm" = "characters (mammals/other animals) × age group (7-9y/adults)",
#     "age_groupCH79_AD:characterelep_gomo" = "characters (elephant/other mammals) × age group (7-9y/adults)",
#     "age_groupCH79_AD:charactergoat_mous" = "characters (goat/mouse) × age group (7-9y/adults)",
#     "age_groupCH79_AD:characterbird_beet" = "characters (bird/beetle) × age group (7-9y/adults)",
#     "age_groupCH79_AD:charactertech_toys" = "characters (technologies/toys) × age group (7-9y/adults)",
#     "age_groupCH79_AD:characterrobo_comp" = "characters (robot/computer) × age group (7-9y/adults)",
#     "age_groupCH79_AD:charactertedd_doll" = "characters (teddy bear/doll) × age group (7-9y/adults)",
#     "factor_nameH_GM:age_groupCH46_AD" = "HEART × age group (4-6y/adults)",
#     "factor_nameM_GM:age_groupCH46_AD" = "MIND × age group (4-6y/adults)",
#     "factor_nameH_GM:age_groupCH79_AD" = "HEART × age group (7-9y/adults)",
#     "factor_nameM_GM:age_groupCH79_AD" = "MIND × age group (7-9y/adults)",
#     "factor_nameH_GM:age_groupCH46_AD:characteranim_inan" = "characters (animates/inanimates) × HEART × age group (4-6y/adults)",
#     "factor_nameH_GM:age_groupCH46_AD:charactermamm_nonm" = "characters (mammals/other animals) × HEART × age group (4-6y/adults)",
#     "factor_nameH_GM:age_groupCH46_AD:characterelep_gomo" = "characters (elephant/other mammals) × HEART × age group (4-6y/adults)",
#     "factor_nameH_GM:age_groupCH46_AD:charactergoat_mous" = "characters (goat/mouse) × HEART × age group (4-6y/adults)",
#     "factor_nameH_GM:age_groupCH46_AD:characterbird_beet" = "characters (bird/beetle) × HEART × age group (4-6y/adults)",
#     "factor_nameH_GM:age_groupCH46_AD:charactertech_toys" = "characters (technologies/toys) × HEART × age group (4-6y/adults)",
#     "factor_nameH_GM:age_groupCH46_AD:characterrobo_comp" = "characters (robot/computer) × HEART × age group (4-6y/adults)",
#     "factor_nameH_GM:age_groupCH46_AD:charactertedd_doll" = "characters (teddy bear/doll) × HEART × age group (4-6y/adults)",
#     "factor_nameM_GM:age_groupCH46_AD:characteranim_inan" = "characters (animates/inanimates) × MIND × age group (4-6y/adults)",
#     "factor_nameM_GM:age_groupCH46_AD:charactermamm_nonm" = "characters (mammals/other animals) × MIND × age group (4-6y/adults)",
#     "factor_nameM_GM:age_groupCH46_AD:characterelep_gomo" = "characters (elephant/other mammals) × MIND × age group (4-6y/adults)",
#     "factor_nameM_GM:age_groupCH46_AD:charactergoat_mous" = "characters (goat/mouse) × MIND × age group (4-6y/adults)",
#     "factor_nameM_GM:age_groupCH46_AD:characterbird_beet" = "characters (bird/beetle) × MIND × age group (4-6y/adults)",
#     "factor_nameM_GM:age_groupCH46_AD:charactertech_toys" = "characters (technologies/toys) × MIND × age group (4-6y/adults)",
#     "factor_nameM_GM:age_groupCH46_AD:characterrobo_comp" = "characters (robot/computer) × MIND × age group (4-6y/adults)",
#     "factor_nameM_GM:age_groupCH46_AD:charactertedd_doll" = "characters (teddy bear/doll) × MIND × age group (4-6y/adults)",
#     "factor_nameH_GM:age_groupCH79_AD:characteranim_inan" = "characters (animates/inanimates) × HEART × age group (7-9y/adults)",
#     "factor_nameH_GM:age_groupCH79_AD:charactermamm_nonm" = "characters (mammals/other animals) × HEART × age group (7-9y/adults)",
#     "factor_nameH_GM:age_groupCH79_AD:characterelep_gomo" = "characters (elephant/other mammals) × HEART × age group (7-9y/adults)",
#     "factor_nameH_GM:age_groupCH79_AD:charactergoat_mous" = "characters (goat/mouse) × HEART × age group (7-9y/adults)",
#     "factor_nameH_GM:age_groupCH79_AD:characterbird_beet" = "characters (bird/beetle) × HEART × age group (7-9y/adults)",
#     "factor_nameH_GM:age_groupCH79_AD:charactertech_toys" = "characters (technologies/toys) × HEART × age group (7-9y/adults)",
#     "factor_nameH_GM:age_groupCH79_AD:characterrobo_comp" = "characters (robot/computer) × HEART × age group (7-9y/adults)",
#     "factor_nameH_GM:age_groupCH79_AD:charactertedd_doll" = "characters (teddy bear/doll) × HEART × age group (7-9y/adults)",
#     "factor_nameM_GM:age_groupCH79_AD:characteranim_inan" = "characters (animates/inanimates) × MIND × age group (7-9y/adults)",
#     "factor_nameM_GM:age_groupCH79_AD:charactermamm_nonm" = "characters (mammals/other animals) × MIND × age group (7-9y/adults)",
#     "factor_nameM_GM:age_groupCH79_AD:characterelep_gomo" = "characters (elephant/other mammals) × MIND × age group (7-9y/adults)",
#     "factor_nameM_GM:age_groupCH79_AD:charactergoat_mous" = "characters (goat/mouse) × MIND × age group (7-9y/adults)",
#     "factor_nameM_GM:age_groupCH79_AD:characterbird_beet" = "characters (bird/beetle) × MIND × age group (7-9y/adults)",
#     "factor_nameM_GM:age_groupCH79_AD:charactertech_toys" = "characters (technologies/toys) × MIND × age group (7-9y/adults)",
#     "factor_nameM_GM:age_groupCH79_AD:characterrobo_comp" = "characters (robot/computer) × MIND × age group (7-9y/adults)",
#     "factor_nameM_GM:age_groupCH79_AD:charactertedd_doll" = "characters (teddy bear/doll) × MIND × age group (7-9y/adults)")) %>%
#   arrange(Parameter) %>%
#   mutate(X = ifelse(Q2.5 * Q97.5 > 0, "*", "")) %>%
#   mutate_at(vars(-Parameter, -X), 
#             funs(format(round(., 2), nsmall = 2))) %>%
#   rename(b = Estimate, Error = Est.Error, " " = X) %>%
#   unite(`95% CI`, Q2.5, Q97.5, sep = ", ") %>%
#   mutate(`95% CI` = paste0("[", `95% CI`, "]")) %>%
#   knitr::kable(format = "html", align = c("l", rep("r", 3)),
#                caption = "Table 3: Fixed effects from a mixed-effects Bayesian regression model predicting factor scores in Study 2 by character, factor (BODY, HEART, MIND), and age group. The model used the formula 'factor score ~ factor * age group * character + (1 | subject)' and was implemented in the 'brms' package for R (Bürkner, 2017). Factor was effect-coded; age-group was dummy-coded with adults as the baseline; and character was coded with eight orthogonal contrasts (see main text). Asterisks mark parameters whose 95% credible interval does not include 0.") %>%
#   kable_styling()
```

```{r, results = "asis", include = T}
# # subset of model
# fixef(efa_3_scores_r_d2_all) %>%
#   data.frame() %>%
#   rownames_to_column("Parameter") %>%
#   filter(Parameter != "Intercept",
#          !grepl("charactermamm_nonm", Parameter),
#          !grepl("characterelep_gomo", Parameter),
#          !grepl("charactergoat_mous", Parameter),
#          !grepl("characterbird_beet", Parameter),
#          !grepl("charactertech_toys", Parameter),
#          !grepl("characterrobo_comp", Parameter),
#          !grepl("charactertedd_doll", Parameter)) %>%
#   mutate(Parameter = recode_factor(
#     Parameter,
#     # ADULTS
#     "factor_nameH_GM" = "HEART (vs. grand mean)",
#     "factor_nameM_GM" = "MIND (vs. grand mean)",
#     "characteranim_inan" = "characters: animates vs. inanimates",
#     "factor_nameH_GM:characteranim_inan" = "characters (animates/inanimates) × HEART",
#     "factor_nameM_GM:characteranim_inan" = "characters (animates/inanimates) × MIND",
#     # OLDER CHILDREN
#     "age_groupCH79_AD" = "age group (7-9y vs. adults)",
#     "factor_nameH_GM:age_groupCH79_AD" = "HEART × age group (7-9y/adults)",
#     "factor_nameM_GM:age_groupCH79_AD" = "MIND × age group (7-9y/adults)",
#     "age_groupCH79_AD:characteranim_inan" = "characters (animates/inanimates) × age group (7-9y/adults)",
#     "factor_nameH_GM:age_groupCH79_AD:characteranim_inan" = "characters (animates/inanimates) × HEART × age group (7-9y/adults)",
#     "factor_nameM_GM:age_groupCH79_AD:characteranim_inan" = "characters (animates/inanimates) × MIND × age group (7-9y/adults)",
#     # YOUNGER CHILDREN
#     "age_groupCH46_AD" = "age group (4-6y vs. adults)",
#     "factor_nameH_GM:age_groupCH46_AD" = "HEART × age group (4-6y/adults)",
#     "factor_nameM_GM:age_groupCH46_AD" = "MIND × age group (4-6y/adults)",
#     "age_groupCH46_AD:characteranim_inan" = "characters (animates/inanimates) × age group (4-6y/adults)",
#     "factor_nameH_GM:age_groupCH46_AD:characteranim_inan" = "characters (animates/inanimates) × HEART × age group (4-6y/adults)",
#     "factor_nameM_GM:age_groupCH46_AD:characteranim_inan" = "characters (animates/inanimates) × MIND × age group (4-6y/adults)")) %>%
#   arrange(Parameter) %>%
#   mutate(X = ifelse(Q2.5 * Q97.5 > 0, "*", "")) %>%
#   mutate_at(vars(-Parameter, -X),
#             funs(format(round(., 2), nsmall = 2))) %>%
#   rename(b = Estimate, Error = Est.Error, " " = X) %>%
#   unite(`95% CI`, Q2.5, Q97.5, sep = ", ") %>%
#   mutate(`95% CI` = paste0("[", `95% CI`, "]")) %>%
#   knitr::kable(format = "html", align = c("l", rep("r", 3)),
#                caption = "Table 3: A subset of the fixed effects from a mixed-effects Bayesian regression model predicting factor scores in Study 2 by character, factor (BODY, HEART, MIND), and age group. The model used the formula 'factor score ~ factor * age group * character + (1 | subject)' and was implemented in the 'brms' package for R (Bürkner, 2017). Factor was effect-coded; age-group was dummy-coded with adults as the baseline; and character was coded with eight orthogonal contrasts (see main text). Here we have included only a subset of parameter of strong theoretical interest; see SOM for the full model. Asterisks mark parameters whose 95% credible interval does not include 0.") %>%
#   kable_styling() %>%
#   group_rows("Adults", 1, 5) %>%
#   group_rows("Older children vs. adults", 6, 11) %>%
#   group_rows("Younger children vs. adults", 12, 17)
```

```{r}
d2_anim <- efa_3_scores_d2_all %>%
  mutate(anim_inan = case_when(
    character %in% c("beetle", "bird", "mouse", "goat", "elephant") ~ "animate",
    character %in% c("computer", "robot", "doll", "teddy bear") ~ "inanimate")) %>%
  mutate(anim_inan = factor(anim_inan, levels = c("inanimate", "animate")))

contrasts(d2_anim$age_group) <- cbind("CH46_AD" = c(1, 0, 0),
                                      "CH79_AD" = c(0, 1, 0))
contrasts(d2_anim$factor_name) <- cbind("H_GM" = c(-1, 1, 0),
                                        "M_GM" = c(-1, 0, 1))
contrasts(d2_anim$anim_inan) <- cbind("anim_GM" = c(-1, 1))

# d2_anim_r <- brm(score ~ factor_name * anim_inan * age_group + 
#               (1 | subid) +
#               (1 + factor_name + age_group | character),
#             data = d2_anim,
#             control = list(adapt_delta = 0.99),
#             cores = 4)
# saveRDS(d2_anim_r, file = "./brms_models/d2_anim_r.rds")

d2_anim_r <- readRDS("./brms_models/d2_anim_r.rds")
# summarY(d2_anim_r)
```

```{r, results = "asis", include = T}
fixef(d2_anim_r) %>%
  data.frame() %>%
  rownames_to_column("Parameter") %>%
  mutate(Parameter = recode_factor(
    Parameter,
    # ADULTS
    "Intercept" = "(Intercept)",
    "factor_nameH_GM" = "HEART (vs. grand mean)",
    "factor_nameM_GM" = "MIND (vs. grand mean)",
    "anim_inananim_GM" = "characters: animates vs. inanimates",
    "factor_nameH_GM:anim_inananim_GM" = "characters (animates/inanimates) × HEART",
    "factor_nameM_GM:anim_inananim_GM" = "characters (animates/inanimates) × MIND",
    # OLDER CHILDREN
    "age_groupCH79_AD" = "age group (7-9y vs. adults)",
    "factor_nameH_GM:age_groupCH79_AD" = "HEART × age group (7-9y/adults)",
    "factor_nameM_GM:age_groupCH79_AD" = "MIND × age group (7-9y/adults)",
    "anim_inananim_GM:age_groupCH79_AD" = "characters (animates/inanimates) × age group (7-9y/adults)",
    "factor_nameH_GM:anim_inananim_GM:age_groupCH79_AD" = "characters (animates/inanimates) × HEART × age group (7-9y/adults)",
    "factor_nameM_GM:anim_inananim_GM:age_groupCH79_AD" = "characters (animates/inanimates) × MIND × age group (7-9y/adults)",
    # YOUNGER CHILDREN
    "age_groupCH46_AD" = "age group (4-6y vs. adults)",
    "factor_nameH_GM:age_groupCH46_AD" = "HEART × age group (4-6y/adults)",
    "factor_nameM_GM:age_groupCH46_AD" = "MIND × age group (4-6y/adults)",
    "anim_inananim_GM:age_groupCH46_AD" = "characters (animates/inanimates) × age group (4-6y/adults)",
    "factor_nameH_GM:anim_inananim_GM:age_groupCH46_AD" = "characters (animates/inanimates) × HEART × age group (4-6y/adults)",
    "factor_nameM_GM:anim_inananim_GM:age_groupCH46_AD" = "characters (animates/inanimates) × MIND × age group (4-6y/adults)")) %>%
  arrange(Parameter) %>%
  mutate(X = ifelse(Q2.5 * Q97.5 > 0, "*", "")) %>%
  mutate_at(vars(-Parameter, -X),
            funs(format(round(., 2), nsmall = 2))) %>%
  rename(b = Estimate, Error = Est.Error, " " = X) %>%
  unite(`95% CI`, Q2.5, Q97.5, sep = ", ") %>%
  mutate(`95% CI` = paste0("[", `95% CI`, "]")) %>%
  knitr::kable(format = "html", align = c("l", rep("r", 3)),
               caption = "Table 3: Fixed effects from a mixed-effects Bayesian regression model predicting factor scores in Study 2 by animacy status (animates, inanimates), factor (BODY, HEART, MIND), and age group (4-6y, 7-9y, adults). The model used the formula 'factor score ~ factor * age group * animacy + (1 | subject) + (1 + factor + age group | character)' and was implemented in the 'brms' package for R (Bürkner, 2017). Animacy status and factor were effect-coded; age-group was dummy-coded with adults as the baseline. Asterisks mark parameters whose 95% credible interval does not include 0.") %>%
  kable_styling() %>%
  group_rows("Adults", 1, 6) %>%
  group_rows("7-9y vs. adults", 7, 12) %>%
  group_rows("4-6y vs. adults", 13, 18)
```

By definition, adults' factor scores did not differ across factors (HEART vs. grand mean: `r write_b_95CI_fun(d2_anim_r, "factor_nameH_GM")`; MIND vs. grand mean: `r write_b_95CI_fun(d2_anim_r, "factor_nameM_GM")`). As we would expect, adults attributed more mental capacities (collapsing across factors) to animates than inanimates (`r write_b_95CI_fun(d2_anim_r, "anim_inananim_GM")`)—a difference that was diminished in the _HEART_ domain (`r write_b_95CI_fun(d2_anim_r, "factor_nameH_GM:anim_inananim_GM")`), but not substantially diminished in the _MIND_ domain (`r write_b_95CI_fun(d2_anim_r, "factor_nameM_GM:anim_inananim_GM")`).

As a group, 7- to 9-year-old children's mental capacity attributions did not differ from adults, collapsing collapsing across factors and characters (`r write_b_95CI_fun(d2_anim_r, "age_groupCH79_AD")`)—but this masks several important differences between older children and adults. As in Study 1, older children's scores were characterized by a relative over-attribution of abilities in the _HEART_ domain (`r write_b_95CI_fun(d2_anim_r, "factor_nameH_GM:age_groupCH79_AD")`), and a relative under-attribution of abilities in the _MIND_ domain (`r write_b_95CI_fun(d2_anim_r, "factor_nameM_GM:age_groupCH79_AD")`). Collapsing across factors, older children made less of a distinction between animate an inanimate target characters, relative to adults (`r write_b_95CI_fun(d2_anim_r, "anim_inananim_GM:age_groupCH79_AD")`). This relative under-differentiation of animate and inanimate characters was particularly pronounced in the _MIND_ domain (`r write_b_95CI_fun(d2_anim_r, "factor_nameM_GM:anim_inananim_GM:age_groupCH79_AD")`).

How did younger children compare to adults? As a group, 4- to 6-year-old children's mental capacity attributions did not differ from adults, collapsing collapsing across factors and characters (`r write_b_95CI_fun(d2_anim_r, "age_groupCH46_AD")`)—but again, this masks a variety of developmental differences that generally parallel the differences between older children and adults just described. Much like older children, younger children's scores were characterized by a relative over-attribution of abilities in the _HEART_ domain (`r write_b_95CI_fun(d2_anim_r, "factor_nameH_GM:age_groupCH46_AD")`) and a relative under-attribution of abilities in the _MIND_ domain (`r write_b_95CI_fun(d2_anim_r, "factor_nameM_GM:age_groupCH46_AD")`), and they differentiated less between animate an inanimate target characters than did adults (`r write_b_95CI_fun(d2_anim_r, "anim_inananim_GM:age_groupCH46_AD")`). This relative under-differentiation of animate and inanimate characters was particularly pronounced in the _MIND_ domain (`r write_b_95CI_fun(d2_anim_r, "factor_nameM_GM:anim_inananim_GM:age_groupCH46_AD")`), and less pronounced in the _HEART_ domain (`r write_b_95CI_fun(d2_anim_r, "factor_nameH_GM:anim_inananim_GM:age_groupCH46_AD")`).

```{r}
fig06a_plot <- d2_anim %>%
  group_by(age_group, factor_name, anim_inan) %>%
  multi_boot_standard(col = "score") %>%
  ungroup() %>%
  filter(!is.na(anim_inan)) %>%
  mutate(age_group = recode_factor(age_group,
                                   "children46" = "4-6y",
                                   "children79" = "7-9y",
                                   "adults" = "adults"),
         anim_inan = recode_factor(anim_inan,
                                   "inanimate" = "inanimates",
                                   "animate" = "animates"),
         facet_lab = "animates vs. inanimates") %>%
  ggplot(aes(x = age_group, group = anim_inan,
             y = mean, color = anim_inan)) + 
  facet_grid(rows = vars(factor_name), cols = vars(facet_lab), scales = "free") +
  geom_hline(yintercept = 0, lty = 2) +
  geom_line(position = position_dodge(width = 0.5)) +
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper),
                  position = position_dodge(width = 0.5)) +
  scale_color_manual(values = c("slategrey", "firebrick1"), na.value = "gray") +
  scale_y_continuous(breaks = seq(-10, 10, 1)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
        legend.position = "bottom") +
  guides(color = guide_legend(nrow = 2, reverse = T)) +
  labs(x = "age group", y = "factor score", color = "animacy")
```

```{r}
fig06b_plot <- ggplot(efa_3_scores_boot_d2_all %>%
                        left_join(d2_all_char %>%
                                    mutate(character = gsub("_", " ",
                                                            character))) %>%
                        mutate(age_group = recode_factor(age_group,
                                                         "children46" = "4-6y",
                                                         "children79" = "7-9y",
                                                         "adults" = "adults"),
                               character = factor(character,
                                                  levels = c("computer", "robot",
                                                             "doll", "teddy bear",
                                                             "beetle", "bird",
                                                             "mouse", "goat",
                                                             "elephant"))),
                      aes(x = age_group, y = mean, color = character)) +
  facet_grid(rows = vars(factor_name), cols = vars(character), scales = "free") +
  geom_hline(yintercept = 0, lty = 2) +
  geom_line(aes(group = character)) +
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper)) +
                  # fatten = 3, shape = 21, color = "black") +
  geom_label(aes(label = paste0("(n=", n, ")"), y = ci_lower), 
             label.size = 0, alpha = 0.8, 
             nudge_y = -0.5, color = "black", size = 2) +
  scale_y_continuous(breaks = seq(-10, 10, 1)) +
  scale_color_brewer(palette = "Paired") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
        legend.position = "bottom") +
  guides(color = guide_legend(override.aes = list(alpha = 1),
                              nrow = 2, byrow = T, reverse = T)) +
  labs(x = "age group", y = "", color = "character")
```

```{r}
fig06_plots <- plot_grid(fig06a_plot, fig06b_plot,
                         nrow = 1, rel_widths = c(0.15, 1),
                         labels = "AUTO")
```

```{r, include = T, fig.width = 9, fig.asp = 0.5}
fig06_with_caption <- add_sub(fig06_plots, str_wrap("Figure 6: Factor scores for younger children (4-6y), older children (7-9y), and adults in Study 2, in which each participant assessed 20 mental capacities for one of nine target characters. Each participant recieved a factor score for each factor (BODY, HEART, and MIND, as defined by an exploratory factor analysis of adults' responses). We treated these scores as summaries of that participants' mental capacity attributions in these domains; a score of 0 corresponds to the mean for that factor among adults. We present two ways of looking at these data: collapsing characters into animates (beetle, bird, mouse, goat, elephant) vs. inanimates (computer, robot, doll, teddy bear; Panel A); and examining each character individually (Panel B). Error bars are bootstrapped 95% confidence intervals. Note that the range of the y-axis differs across rows.", 210), x = 0, hjust = 0)
ggdraw(fig06_with_caption)
```

A visual inspection of Figure 6 further clarifies these findings. 

In the _BODY_ domain, a distinction between animate and inanimate target characters was clearly present in all age groups, though slightly attenuated among 4- to 6-year-old children (see Figure 6, Panel A, top row). A closer look at factor scores for individual characters (Panel B, top row) suggests that younger children diverged from adults primarily in their attributions to the "edge cases" that were the focus of Study 1: the robot (to which they over-attributed the physiological sensations related to the _BODY_), and the beetle (to which they under-attributed such _BODY_ capacities). Older children's _BODY_ attributions were generally indistinguishable from adults' for almost all target characters. (The only possible exception is the bird—but, in our view, it appears that this was driven by _adults_ slightly _under_-attributing _BODY_ capacities to this character.)

In the _HEART_ domain, the distinction between animate and inanimate target characters was subtler across all age groups, and the degree of distinction did not vary dramatically with age (see Figure 6, Panel A, middle row). Instead, children generally over-attributed _HEART_ to _both_ animates and inanimates; these over-attributions declined between 4-6y and 7-9y of age, but did not reach adult-like levels even among older children. This is consistent with Study 1, in which 7- to 9-year-old children over-attributed _HEART_ to both the beetle and the robot, relative to adults. In this study, older children again attributed more _HEART_ capacities to the beetle and the robot, but also to the mouse and the goat (see Panel B, middle row). Relative to other animates, adults attributed particularly few _HEART_ capacities to the mouse and the goat—perhaps because of their respecive statuses as vermin and food animals in this cultural context.

Finally, in the _MIND_ domain, neither group of children made a robust distinction between animates and inamates—but adults clearly did (see Figure 6, Panel A, bottom row). Instead, children generally under-attributed _MIND_ to _both_ animates and inanimates. These under-attributions became less dramatic between 4-6y and 7-9y of age, and by 7-9y children's _MIND_ attributions to inanimates were adult-like. But even at 7-9y, children did not attributed as many _MIND_ capacities to animates as did adults; between 7-9y and adulthood, _MIND_ attributions increased for all of the animate characters, and particularly dramatically for the bird, the mouse, and the elephant (see Figure 6, Panel B, bottom row).

The raw data further supporst these observations; see Figure 7 for raw counts of _no_, _kinda_, and _yes_ responses for all items, grouped by factor, animacy status (Panels A-C) or character (Panels D-F), and age group. For example, consider pain (the first capacity under _BODY_): Across age groups, most participants said that an elephant could feel pain, with the proportion of "yes" responses increasing across age groups; meanwhile, few participants said that a computer could feel pain, with the proportion of "yes" responses decreasing across age groups. More dramatic changes are evident in the _HEART_ and _MIND_ factors, with attributions of _HEART_ generally decreasing across age groups (especially to inanimate target characters - e.g., the computer, the robot), and attributions of _MIND_ generally increasing across age groups (especially to animate target characters - e.g., the mouse, the goat, the elephant). (See SOM for an analysis, parallel to the regression analyses here, of the proportion of the top-loading mental capacities for each factor that were endorsed by participants of different ages.)

```{r}
d2_all <- d2_ad %>%
  full_join(d2_79) %>%
  full_join(d2_46) %>%
  select(age_group, subid, character, capacity, response_num) %>%
  left_join(loadings_fun(efa_3_d2_ad) %>% 
              group_by(capacity) %>%
              top_n(1, loading) %>%
              ungroup() %>%
              arrange(factor, desc(loading)) %>%
              mutate(order = 1:20) %>%
              select(capacity, factor, order)) %>%
  filter(!is.na(response_num)) %>%
  left_join(d2_all_char %>% select(-prop)) %>%
  mutate(response = recode_factor(response_num,
                                  "0" = "no",
                                  "0.5" = "kinda",
                                  "1" = "yes"),
         factor = recode_factor(factor,
                                "F1" = "BODY",
                                "F2" = "HEART",
                                "F3" = "MIND"),
         age_group = recode_factor(age_group,
                                   "children46" = "4-6y", 
                                   "children79" = "7-9y", 
                                   "adults" = "adults"),
         character = ifelse(grepl("bear", as.character(character)),
                            "teddy bear", as.character(character)),
         character = factor(character,
                            levels = c("computer", "robot", 
                                       "doll", "teddy bear",
                                       "beetle", "bird", "mouse",
                                       "goat", "elephant")),
         age_group_n = paste0(age_group, "\n(n = ", n, ")"))
```

```{r}
fig07a_fun <- function(whichfac){
  
  fig <- d2_all %>%
    filter(factor == whichfac) %>%
    left_join(d2_anim %>% distinct(character, anim_inan)) %>%
    mutate(anim_inan = recode_factor(anim_inan,
                                     "inanimate" = "inanimates",
                                     "animate" = "animates")) %>%
    ggplot(aes(x = reorder(capacity, order),
               fill = anim_inan, alpha = response)) +
    facet_grid(cols = vars(anim_inan), rows = vars(age_group),
               scales = "free", space = "free") +
    geom_bar(position = "fill") +
    # geom_label(data = d2_anim %>%
    #              left_join(
    #                d2_all_char %>%
    #              distinct(character, factor, age_group, n),
    #            aes(x = NA, y = NA, alpha = NA, fill = NA,
    #                label = paste0("(n=", n, ")")),
    #            x = 0.75, y = 1, alpha = 0.8, hjust = 0, vjust = 1,
    #            color = "black", fill = "white", size = 3) +
    scale_fill_brewer(palette = "Paired") +
    scale_y_continuous(breaks = c(0, 0.5, 1)) +
    scale_color_manual(values = c("slategrey", "firebrick1"), na.value = "gray") +
    scale_fill_manual(values = c("slategrey", "firebrick1"), na.value = "gray") +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
          legend.position = "bottom") +
    labs(title = whichfac,
         y = "proportion of participants",
         x = "mental capacity (by factor)",
         fill = "animacy") +
    guides(fill = guide_legend(nrow = 1, byrow = T, reverse = T),
           alpha = "none")
  
  if(whichfac != "MIND"){
    fig <- fig + guides(fill = "none", alpha = "none") + labs(x = "")
  }
  
  return(fig)
}

fig07a_BODY_plot <- fig07a_fun("BODY")
fig07a_HEART_plot <- fig07a_fun("HEART")
fig07a_MIND_plot <- fig07a_fun("MIND")

fig07a_plots <- plot_grid(fig07a_BODY_plot, fig07a_HEART_plot, fig07a_MIND_plot,
                          ncol = 1, labels = "AUTO",
                          rel_heights = c(1, 1, 1.2))
```

```{r}
fig07b_fun <- function(whichfac){
  
  fig <- d2_all %>%
    left_join(d2_all_char %>%
                mutate(character = gsub("_", " ", as.character(character))) %>%
                distinct(character, age_group, n)) %>%
    filter(factor == whichfac) %>%
    mutate(character = factor(character,
                              levels = c("computer", "robot", "doll",
                                         "teddy bear", "beetle", "bird",
                                         "mouse", "goat", "elephant"))) %>%
    ggplot(aes(x = reorder(capacity, order),
               fill = character, alpha = response)) +
    facet_grid(cols = vars(character), rows = vars(age_group),
               scales = "free", space = "free") +
    geom_bar(position = "fill") +
    # geom_label(data = d2_all %>%
    #              left_join(
    #                d2_all_char %>%
    #                  mutate(character = gsub("_", " ", character),
    #                         character = factor(character,
    #                                            levels = c("computer", "robot",
    #                                                       "doll", "teddy bear",
    #                                                       "beetle", "bird",
    #                                                       "mouse", "goat",
    #                                                       "elephant")))) %>%
    #              distinct(character, factor, age_group, n),
    #            aes(x = NA, y = NA, alpha = NA, fill = NA,
    #                label = paste0("(n=", n, ")")),
    #            x = 0.75, y = 1, alpha = 0.8, hjust = 0, vjust = 1,
    #            color = "black", fill = "white", size = 3) +
    scale_fill_brewer(palette = "Paired") +
    scale_y_continuous(breaks = c(0, 0.5, 1)) +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
          legend.position = "bottom") +
    labs(title = whichfac,
         y = "", 
         x = "mental capacity (by factor)") +
    guides(fill = guide_legend(nrow = 1, byrow = T, reverse = T),
           alpha = guide_legend(nrow = 1, byrow = T))
  
  if(whichfac != "MIND"){
    fig <- fig + guides(fill = "none", alpha = "none") + labs(x = "")
  }
  
  return(fig)
}

fig07b_BODY_plot <- fig07b_fun("BODY")
fig07b_HEART_plot <- fig07b_fun("HEART")
fig07b_MIND_plot <- fig07b_fun("MIND")

fig07b_plots <- plot_grid(fig07b_BODY_plot, fig07b_HEART_plot, fig07b_MIND_plot,
                          ncol = 1, labels = c("D", "E", "F"),
                          rel_heights = c(1, 1, 1.2))
```

```{r}
fig07_plots <- plot_grid(fig07a_plots, fig07b_plots,
                         nrow = 1, rel_widths = c(0.25, 1))
```

```{r, include = T, fig.width = 8, fig.asp = 1}
fig07_with_caption <- add_sub(fig07_plots, str_wrap("Figure 7: Proportion of Study 2 participants who responded 'yes' (dark), 'kinda' (medium), or 'no' (light) to  each mental capacity item, grouped by the factor on which they loading most positively (BODY, HEART, MIND) according to an exploratory factor analysis of adults' responses. Each participant assessed 20 mental capacities for one of nine target characters (6-18 per character, per age group). We present two ways of looking at these data: collapsing characters into animates (beetle, bird, mouse, goat, elephant) vs. inanimates (computer, robot, doll, teddy bear; Panels A-C); and examining each character individually (Panel D-F). Responses are shown separately by age group (4-6y, 7-9y, adults).", 180), x = 0, hjust = 0)
ggdraw(fig07_with_caption)
```

```{r}
d2_all_endorse <- d2_all %>%
  left_join(d2_anim %>% distinct(character, anim_inan)) %>%
  group_by(factor, subid) %>%
  top_n(-6, order) %>%
  ungroup() %>%
  mutate(endorse = ifelse(response_num > 0, 1, 0),
         anim_inan = recode_factor(anim_inan,
                                   "inanimate" = "inanimates",
                                   "animate" = "animates")) %>%
  group_by(age_group, subid, anim_inan, character, factor) %>%
  summarise(prop_endorse = mean(endorse, na.rm = T),
            n = length(endorse)) %>%
  ungroup()
```

```{r}
d2_all_endorse_anim_boot <- d2_all_endorse %>%
  group_by(age_group, anim_inan, factor) %>%
  multi_boot_standard(col = "prop_endorse") %>%
  ungroup()
```

```{r}
figSUPP2a_plot <- d2_all_endorse %>%
  filter(age_group != "adults") %>%
  left_join(full_join(d2_79 %>% distinct(subid, age),
                      d2_46 %>% distinct(subid, age))) %>%
  filter(!is.na(age)) %>%
  mutate(facet_lab = "animates vs. inanimates") %>%
  ggplot(aes(x = age, y = prop_endorse, 
             fill = anim_inan, color = anim_inan)) +
  facet_grid(cols = vars(facet_lab), rows = vars(factor)) +
  geom_jitter(alpha = 0.4, width = 0, height = 0.03) +
  binomial_smooth(aes(weight = n), alpha = 0.10, show.legend = F) +
  # geom_smooth(method = "glm",
  #             method.args = list(family = "binomial")) +
  geom_point(data = d2_all_endorse %>% filter(age_group == "adults"),
             aes(x = 11), alpha = 0.2, show.legend = F,
                  position = position_jitterdodge(dodge.width = 0.5,
                                                  jitter.width = 0.25)) +
  geom_pointrange(data = d2_all_endorse_anim_boot %>% 
                    filter(age_group == "adults"),
                  aes(x = 11, y = mean, ymin = ci_lower, ymax = ci_upper),
                  position = position_jitterdodge(dodge.width = 0.5,
                                                  jitter.width = 0.25), 
                  show.legend = F, color = "black", fatten = 1.5, shape = 21) +
  scale_x_continuous(breaks = c(4:11), 
                     labels = c(paste0(4:10, "y"), "adults")) +
  scale_y_continuous(breaks = seq(0, 1, 1/6), labels = 0:6) +
  scale_color_manual(values = c("slategrey", "firebrick1"), na.value = "gray") +
  scale_fill_manual(values = c("slategrey", "firebrick1"), na.value = "gray") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
        legend.position = "bottom") +
  guides(color = guide_legend(override.aes = list(alpha = 1),
                              nrow = 2, byrow = T, reverse = T),
         fill = guide_legend(nrow = 2, byrow = T, reverse = T)) +
  labs(y = "number of capacities endorsed", 
       color = "animacy", fill = "animacy")
```

```{r}
d2_all_endorse_boot <- d2_all_endorse %>%
  group_by(age_group, character, factor) %>%
  multi_boot_standard(col = "prop_endorse") %>%
  ungroup()
```

```{r}
figSUPP2b_plot <- d2_all_endorse %>%
  filter(age_group != "adults") %>%
  left_join(full_join(d2_79 %>% distinct(subid, age),
                      d2_46 %>% distinct(subid, age))) %>%
  filter(!is.na(age)) %>%
  mutate(facet_lab = "individual characaters") %>%
  ggplot(aes(x = age, y = prop_endorse, 
             fill = character, color = character)) +
  facet_grid(cols = vars(facet_lab), rows = vars(factor)) +
  geom_jitter(alpha = 0.4, width = 0, height = 0.03) +
  binomial_smooth(aes(weight = n), alpha = 0.10, show.legend = F) +
  # geom_smooth(method = "glm",
  #             method.args = list(family = "binomial")) +
  geom_point(data = d2_all_endorse %>% filter(age_group == "adults"),
             aes(x = 12), alpha = 0.2, show.legend = F,
             position = position_dodge(width = 2)) +
  geom_pointrange(data = d2_all_endorse_boot %>% filter(age_group == "adults"),
                  aes(x = 12, y = mean, ymin = ci_lower, ymax = ci_upper),
                  position = position_dodge(width = 2), show.legend = F,
                  color = "black", fatten = 1.5, shape = 21) +
  scale_x_continuous(breaks = c(4:10, 12), 
                     labels = c(paste0(4:10, "y"), "adults")) +
  scale_y_continuous(breaks = seq(0, 1, 1/6), labels = 0:6) +
  scale_color_brewer(palette = "Paired") +
  scale_fill_brewer(palette = "Paired") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
        legend.position = "bottom") +
  guides(color = guide_legend(override.aes = list(alpha = 1),
                              nrow = 2, byrow = T, reverse = T),
         fill = guide_legend(nrow = 2, byrow = T, reverse = T)) +
  labs(y = "")
```

```{r}
figSUPP2_plots <- plot_grid(figSUPP2a_plot, figSUPP2b_plot,
                            nrow = 1, rel_widths = c(0.85, 1),
                            labels = "AUTO")
```

```{r, include = F, fig.width = 6, fig.asp = 1}
figSUPP2_with_caption <- add_sub(figSUPP2_plots, str_wrap("Figure SUPP2: Number of mental capacity items (out of 6) endorsed in each domain (BODY, HEART, and MIND) by 4- to 9-year-old children and adults in Study 2, in which each participant assessed 20 mental capacities for one of nine target characters. We defined each domain by the 6 items that loaded the most positively on the corresponding factor in an exploratory factor analysis of adults' responses, and we considered responses of either 'yes' or 'kinda' (but not 'no') to be endorsements. Lines correspond to logistic regressions considering children's scores alone. Error bars are bootstrapped 95% confidence intervals on adults' scores.", 153), x = 0, hjust = 0)
ggdraw(figSUPP2_with_caption)
```

#### Age differences within the child samples

As in Study 1, we were interested not only in differences across age groups, but also across the—even wider—age range within our child samples. In Study 2, this included children as young as 4 years up to nearly 10 years of age. This allowed us to look at age-related differences in mental capacity attributions across a wide period from early to middle childhood.

```{r}
# d2_49_anim_r <- brm(score ~ factor_name * anim_inan * age +
#                       (1 | subid) +
#                       (1 + factor_name | character),
#                     data = d2_anim %>%
#                       filter(age_group != "adults", !is.na(age)) %>%
#                       mutate(age = scale(age, scale = F)),
#                     control = list(adapt_delta = 0.99),
#                     cores = 4)
# saveRDS(d2_49_anim_r, file = "./brms_models/d2_49_anim_r.rds")

d2_49_anim_r <- readRDS("./brms_models/d2_49_anim_r.rds")
# summary(d2_49_anim_r)
```

```{r}
d2_ch_age <- full_join(d2_46 %>% distinct(subid, age),
                       d2_79 %>% distinct(subid, age))
```

To explore age-related differences continuously within the child samples, we conducted an additional regression analysis on children's factor scores alone, including interactions with exact age in years (centered at the mean: `r format(round(mean(d2_ch_age$age, na.rm = T), 2), nsmall = 2)`y) rather than age group. (See Table 4 for the full results of this model, and Figure 8 for a visualization of changes in children's factor scores across the age range.)

This analysis confirmed that, relative to the grand mean, attributions of _HEART_ decreased with age (`r write_b_95CI_fun(d2_49_anim_r, "factor_nameH_GM:age")`) and attributions of _MIND_ increased with age (`r write_b_95CI_fun(d2_49_anim_r, "factor_nameM_GM:age")`). These findings are both in line with the age group analysis described in the previous section, suggesting that the observed group differences correspond to gradual developmental differences as children's responses become increasingly adult-like. 

If children were also becoming increasingly adult-like in their distinctions between animate and inanimate target characters, we would also expect the overall animate-inanimate distinction (collapsing across factors) to increase with age, driven primarily by increases in the _BODY_ and especially _MIND_ domains. Instead, collapsing across factors, the general distinction between animates and inanimates did _not_ differ with age (`r write_b_95CI_fun(d2_49_anim_r, "anim_inananim_GM:age")`); _decreased_ in the _HEART_ domain, relative to the grand mean (`r write_b_95CI_fun(d2_49_anim_r, "factor_nameH_GM:anim_inananim_GM:age")`); and did not change substantially in the _MIND_ domain (but, if anything, decreased: `r write_b_95CI_fun(d2_49_anim_r, "factor_nameM_GM:anim_inananim_GM:age")`), as we might expect if older children were approaching "adult-like" responses in this aspect of their mental capacity attributions. 

We speculate on several possible explanations of these unexpected findings in the Study 2 discussion section, below. For now, we note that participants who assessed the robot seemed to become particularly un-adult-like at older ages, and excluding these participants yields a more coherent picture of increasing adult-like-ness with increasing age (see Figure 8, Panel A, turquoise lines and points). This did not appear to be the case when excluding any of the other inanimate target characters (computer, teddy bear, doll).

```{r, results = "asis", include = T}
fixef(d2_49_anim_r) %>%
  data.frame() %>%
  rownames_to_column("Parameter") %>%
  mutate(Parameter = recode_factor(
    Parameter,
    # OVERALL
    "Intercept" = "(Intercept)",
    "factor_nameH_GM" = "HEART (vs. grand mean)",
    "factor_nameM_GM" = "MIND (vs. grand mean)",
    "anim_inananim_GM" = "characters: animates vs. inanimates",
    "factor_nameH_GM:anim_inananim_GM" = "characters (animates/inanimates) × HEART",
    "factor_nameM_GM:anim_inananim_GM" = "characters (animates/inanimates) × MIND",
    # BY AGE
    "age" = "age (centered at the mean)",
    "factor_nameH_GM:age" = "HEART × age",
    "factor_nameM_GM:age" = "MIND × age",
    "anim_inananim_GM:age" = "characters (animates/inanimates) × age",
    "factor_nameH_GM:anim_inananim_GM:age" = "characters (animates/inanimates) × HEART × age",
    "factor_nameM_GM:anim_inananim_GM:age" = "characters (animates/inanimates) × MIND × age")) %>%
  arrange(Parameter) %>%
  mutate(X = ifelse(Q2.5 * Q97.5 > 0, "*", "")) %>%
  mutate_at(vars(-Parameter, -X),
            funs(format(round(., 2), nsmall = 2))) %>%
  rename(b = Estimate, Error = Est.Error, " " = X) %>%
  unite(`95% CI`, Q2.5, Q97.5, sep = ", ") %>%
  mutate(`95% CI` = paste0("[", `95% CI`, "]")) %>%
  knitr::kable(format = "html", align = c("l", rep("r", 3)),
               caption = "Table 4: Fixed effects from a mixed-effects Bayesian regression model of children's responses, predicting factor scores in Study 2 by animacy status (animates, inanimates), factor (BODY, HEART, MIND), and exact age. The model used the formula 'factor score ~ factor * age * animacy + (1 | subject)' and was implemented in the 'brms' package for R (Bürkner, 2017). Factor and animacy were effect-coded, and age was mean-centered. Asterisks mark parameters whose 95% credible interval does not include 0.") %>%
  kable_styling() %>%
  group_rows("Collapsing across age", 1, 6) %>%
  group_rows("Age effects", 7, 12)
```

```{r}
fig08a_plot <- ggplot(d2_anim %>% 
                       filter(!is.na(age)) %>%
                        mutate(facet_lab = "animates vs. inanimates") %>%
                        full_join(data.frame(facet_lab = "animates vs. inanimates",
                                             anim_inan = "dummy",
                                             age = 7,
                                             factor_name = "BODY")),
                     aes(x = age, y = score,
                         fill = anim_inan, color = anim_inan, group = anim_inan)) +
  facet_grid(rows = vars(factor_name), cols = vars(facet_lab), scales = "free") +
  geom_hline(yintercept = 0, lty = 2) +
  geom_point(alpha = 0.2) +
  geom_smooth(method = "lm", alpha = 0.10, show.legend = F) +
  geom_point(data = d2_anim %>% filter(age_group == "adults"),
             aes(x = 11), alpha = 0.2, show.legend = F,
             position = position_jitterdodge(dodge.width = 0.5, 
                                             jitter.width = 0.25)) +
  geom_pointrange(data = d2_anim %>% 
                    filter(age_group == "adults") %>%
                    group_by(age_group, factor_name, anim_inan) %>%
                    multi_boot_standard(col = "score") %>% 
                    ungroup(),
                  aes(x = 11, y = mean, ymin = ci_lower, ymax = ci_upper),
                  position = position_dodge(width = 0.5), show.legend = F, 
                  # fatten = 1.5, 
                  shape = 21, color = "black") +
  # EXCLUDE ROBOT
  geom_smooth(data = function(x){x %>% 
      filter(character != "robot", anim_inan == "inanimate") %>%
      mutate(anim_inan = "inan_norobot")},
      aes(color = anim_inan),
      method = "lm", alpha = 0.10, show.legend = F, lty = 1, size = 0.4) +
  geom_pointrange(data = efa_3_scores_d2_all %>% 
                    filter(character != "robot") %>%
                    filter(age_group == "adults") %>%
                    left_join(d2_anim %>% 
                                distinct(character, anim_inan)) %>%
                    group_by(factor_name, anim_inan) %>%
                    multi_boot_standard(col = "score") %>%
                    ungroup() %>%
                    filter(anim_inan == "inanimate") %>%
                    mutate(anim_inan = "inan_norobot"),
                  aes(color = anim_inan,
                      x = 11 + (.25/2 + .25), 
                      y = mean, ymin = ci_lower, ymax = ci_upper),
                  position = position_dodge(width = 0.5), show.legend = F,
                  fatten = 3,
                  shape = 18) +
  # resume
  scale_x_continuous(breaks = c(4:11), minor_breaks = NULL,
                     labels = c(paste0(4:10, "y"), "adults")) +
  scale_y_continuous(breaks = seq(-10, 10, 1), minor_breaks = NULL) +
  scale_color_manual(values = c("firebrick1", "white", 
                                "darkturquoise", "slategrey"), 
                     breaks = c("animate", "dummy", 
                                "inanimate", "inan_norobot"),
                     labels = c("animates", " ", 
                                "inanimates", "(no robot)"),
                     na.value = "gray") +
  scale_fill_manual(values = c("firebrick1", "white", 
                                "darkturquoise", "slategrey"),
                     breaks = c("animate", "dummy", 
                                "inanimate", "inan_norobot"),
                     labels = c("animates", " ", 
                                "inanimates", "(no robot)"),
                    na.value = "gray") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
        legend.position = "bottom") +
  guides(color = guide_legend(override.aes = list(alpha = 1),
                              nrow = 2, byrow = T, reverse = F),
         fill = guide_legend(nrow = 2, byrow = T, reverse = F)) +
  labs(x = "age", y = "factor score", 
       color = "animacy", fill = "animacy")
```

```{r}
fig08b_plot <- ggplot(efa_3_scores_d2_all %>%
                        filter(!is.na(age)) %>%
                        mutate(facet_lab = "individual characters"),
                      aes(x = age, y = score,
                          fill = character, color = character)) +
  facet_grid(cols = vars(character), rows = vars(factor_name), scales = "free") +
  geom_hline(yintercept = 0, lty = 2) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", alpha = 0.20, show.legend = F) +
  geom_point(data = efa_3_scores_d2_all %>% filter(age_group == "adults"),
             aes(x = 11), alpha = 0.5, show.legend = F,
             position = position_jitter(width = 0.25)) +
  geom_pointrange(data = efa_3_scores_boot_d2_all %>% 
                    filter(age_group == "adults"),
                  aes(x = 11, y = mean, ymin = ci_lower, ymax = ci_upper),
                  show.legend = F,
                  # fatten = 1.5, 
                  shape = 21, color = "black") +
  scale_x_continuous(breaks = c(4:11), minor_breaks = NULL, 
                     labels = c(paste0(4:10, "y"), "adults")) +
  scale_y_continuous(breaks = seq(-10, 10, 1), minor_breaks = NULL) +
  scale_color_brewer(palette = "Paired") +
  scale_fill_brewer(palette = "Paired") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
        legend.position = "bottom") +
  guides(color = guide_legend(override.aes = list(alpha = 1),
                              nrow = 2, byrow = T, reverse = T),
         fill = guide_legend(nrow = 2, byrow = T, reverse = T)) +
  labs(y = "")
```

```{r}
fig08_plots <- plot_grid(fig08a_plot, fig08b_plot,
                         nrow = 1, rel_widths = c(0.15, 1),
                         labels = "AUTO")
```

```{r, include = T, fig.width = 10, fig.asp = 0.4}
fig08_with_caption <- add_sub(fig08_plots, str_wrap("Figure 8: Factor scores for adults and 4- to 9-year-old children in Study 1, replotted to illustrate age effects within the child samples. We present two ways of looking at these data: collapsing characters into animates (beetle, bird, mouse, goat, elephant) vs. inanimates (computer, robot, doll, teddy bear; Panel A); and examining each character individually (Panel B). In Panel A, we additionally plot (in turquoise) age-related changes in attributions to inanimates after excluding participants who assessed the robot. Lines correspond to linear regressions considering children's scores alone. Error bars are bootstrapped 95% confidence intervals on adults' scores. Note that the range of the y-axis differs across panels.", 235), x = 0, hjust = 0)
ggdraw(fig08_with_caption)
```

## Discussion

**BOOKMARK**

We had three goals in Study 2: (1) To test whether the adult-like conceptual structure revealed among 7- to 9-year-old children in Study 1 would hold under the range of conditions that elicit this structure among US adults in Weisman et al.'s (2017) previous work; (2) To explore conceptual structure at an earlier point in development; and (3) To explore age-related differences in the application of concepts of mental life to a wide range of animate beings and inanimate objects.

Regarding our first goal, Study 2 suggests that the three-part conceptual structure—anchored by _BODY_, _HEART_, and _MIND_—is reliable and robust among 7- to 9-year-old US children. As in Weisman et al.'s (2017) original work with adults, the capacities that "hang together" in older children's reasoning when target characaters are perceived to vary in mental capacity profiles appear to be highly similiar to those that "hang together" when participants disagree about the mental lives of controversial "edge cases" in social reasoning (Study 1).

Regarding our second goal, XX. [XX In coarser terms, XX BODY-HEART vs. MIND. This two-factor structure is also reminiscent of Gray et al.'s (2007) "experience-agency" framework; XX. But there are hints of a nascent three-factor structure, closer to BODY-HEART_MIND - not fully worked out, especially the distinction between BODY and HEART. Instead of BODY vs. HEART, negative vs. positive. The salience on negative vs. positive experiences among younger children is consistent with recent work on the development of emotion concepts, which suggests that emotion representations are dominanted by a single dimension of valence in early to middle childhood, before unfolding into a two-dimensional space characterized by valence and arousal over the course of later childhood and adolesence (Nook et al., 2017).]

Regarding our third goal, XX. [XX fulfill the promised speculations: why does animate/inanimate distinction decrease with age in the HEART domain, and why doesn't it increase with age in the MIND domain?]

# Study 3

The primary goal of Study 3 was to (conceptually) replicate and extend our findings with 4- to 6-year-old children in Study 2. In light of the concerns about vocabulary, attention, and use of the response scale among younger children in Study 2, we designed an even more child-friendly version well suited for young preschoolers, streamlining the experimental protocol, providing more scaffolding for the response scale, and including only vocabulary items that were pre-tested to be familiar to young preschool children (see "Method"). 

A second goal of Study 3 was to assess younger children's attributions of mental life to edge cases. Recall that, in Study 1, older children attributed more social-emotional abilities ("heart") to both beetles and robots than did adults, despite sharing adults' three-part conceptual structure; this "edge case" approach of Study 1 allowed us to estimate older children's aggregate attributions to these entities with precision and to chart changes in these attributions over age continuously within the range of 7-9 years, because large numbers of children assessed each of the two target characters (rather than participants being distributed across a wider range of target characters). In Study 3, we returned to this approach, limiting the target characters to a beetle and a robot, so as to follow up on this secondary finding with a younger group of children. 

Finally, Study 3 was designed in anticipation of developing participant-level analyses to supplement the group-level EFAs discussed so far (see "Continuous development at the participant level: A re-analysis of Studies 1-3," below). With this general goal in mind, we asked each child to assess the mental capacities of both a beetle and a robot, so as to maximize the number of observations per participant for these anticipated participant-level analyses.

## Method

### Participants

XX people participated in this study.

Adults (n=XX) participated via Amazon Mechanical Turk (MTurk) in September 2018. Adult participants had gained approval for at least 95% of their previous work on MTurk; had MTurk accounts based in the US; and indicated that they were at least 18 years old. Adults were paid $0.75 for approximately XX minutes of their time (median duration: XX min). An additional XX adults participated but were excluded for failing to pass one or more attention checks (e.g., "Please select no"; n=XX) or for failing to respond sensibly to an open-ended question about what they had been asked to do in the study (see Study 3 for examples; n=XX).

Among the final sample of XX adults, XX% identified as women and XX% as men. Adults predominantly identified as White (XX%; XX% as Black, XX% as Asian; XX% as XX), and reported being between XX and XX years of age (median age: XX years). XX OTHER DEMOGRAPHICS: Native language, education, religion as a child, religion now, job.
XX children participated in this study, which was conducted between January 2018 and XX 2018. Our planned sample size was 100 children, but we also retained a handful of extra participants who completed the study on the final days of data collection. Children ranged in age from 4.00-XXy (median: XXy), and participated at their preschool; exact duration was not recorded, but the full study session generally took less than 10 minutes. According to school records, XX children (XX%) were girls and XX (XX%) were boys; for XX children (XX) gender was either non-binary or unknown. Parents predominantly identified their children as White (XX%) or Asian (XX%; XX% as Black, XX% as Asian; XX% as XX). XX OTHER DEMOGRAPHICS.

An additional XX children participated but were excluded for being outside the target age range. 

### Materials and procedure 

Materials and procedure were adapted to be more appropriate for young preschoolers, with two primary goals in mind: Streamlining the experimental protocol to improve children's comprehension and attention to the task, and limiting mental capacities to words that are highly familiar to young preschool children.

In order to streamline the experimental protocol, we moved the task off of the computer (for children but not adults), instead using printed photographs of the target characters (measuring approximately 5 x 8 inches, printed in color and laminated) and recording children's responses by hand (rather than using the computer). At the time of testing, the experimenter and child sat side by side, with the photograph placed directly in front of the child for the duration of the task. 

We also streamlined the introduction to the task. The experimenter began by placing the photograph of the first target character in front of the child and asking, "Can you tell me what this is?" If a child provided an answer other than "beetle" or "robot," the experimenter said, "I'm going to call it a [beetle/robot]." Then the experimenter said, "We're going to play a game about [beetles/robots]," reminded children, "if you ever want to stop playing, you can just let me know and we'll go back to the classroom" (per preschool protocol), and then launched into the first question (e.g., "Can beetles get sad?").

We scaffolded children's use of the three-point response scale by providing a physical representation of the scale, consisting of three large boxes, separated by blank space, containing the words NO, KINDA, and YES written in large font with all capital letters (to aid children with at least some reading skills in recognizing these words); color-coded according to the intensity of response (NO = very light blue, KINDA = medium blue, YES = dark blue); and ordered from left (NO) to right (YES). Each box measured approximately 2 x 4 inches; the boxes were laminated with slightly less than 1 inch of empty space between them (through which the table was visible). In addition to providing these visual and spatial cues to the fact that there were three response options—no, yes, and something conceptually and literally "in between" these extremes—we also added a line to the experimenter's script describing (and then reiterating) these response options on the first three trials ("You can say no [pointing to NO], kinda [pointing to KINDA], or yes [pointing to YES]"). The experimenter repeated these options on the first three trials for all children, and on any other trials where a child took more than a few seconds to answer or provided a response other than saying "yes," "kinda," or "no" or clearly pointing to one of these options on the response scale.

For each target character, children answered 18 questions about its mental capacities. These questions were designed to include six clear examples of bodily, social-emotional, and perceptual-cognitive abilities, according to Studies 1-2 and Weisman et al.'s (2017) original studies with US adults. Bodily abilities included feel hungry, get thirsty, feel sick, feel tired, get scared, and smell things. Social-emotional abilities included love someone, hate someone, feel happy, get sad, feel sorry, get lonely. Perceptual-cognitive abilities included see, hear, think, remember things, know stuff, figure things out. These items were chosen to as short as possible and highly familiar to young preschool children; they were selected from a larger pilot study in which we asked 3- to 5-year-old children to complete stories that began with each of these mental capacities as a premise (e.g., "Let's imagine a person who loves someone. What happens next?"; "Now let's pretend that someone remembers something. What happens next?") and judged the appropriateness of their story completion. We further designed the set of items so that each category included a variety of phrasings (e.g., feel hungry vs. get thirsty; remember things vs. know stuff) and valences when appropriate (e.g., feel happy vs. get sad); when possible, we aimed to have phrasings vary orthogonally with categories, such that "get" and "feel" appeared roughly equally often among the bodily and social-emotional items, and "things" appeared equally often among the bodily and perceptual-cognitive items. As in Studies 1-2, each mental capacity was associated with a short, preset definition, which was read to children if they expressed uncertainty about what a word meant or did not respond after prompting use of the response scale.

Children first assessed all 18 mental capacities for one of the target characters (e.g., the beetle), then completed an easy jigsaw puzzle featuring clothing and accessories appropriate for a rainy day (which took about 30-60 second to complete), and finally assessed all 18 mental capacities for the other target character (e.g., the robot).

This modified procedure—particularly moving the experiment off of the computer for children—required changes to the experimental design. Rather than randomly assigning children to assess the beetle first or the robot first, the order of target characters was counterbalanced in advance. Likewise, rather than asking about the 18 mental capacities in a random order, questions about the first target character were asked in one of 8 pre-made random orders, and questions about the second target character were asked in the reverse order. The order of the target characters (beetle-robot or robot-beetle) and the order of the mental capacity questions (1-8) were fully crossed across participants. 

Adults participated in an online version of this same task, without a break between target characters. As in Studies 1 and 2, adults clicked through a website at their own pace, with one trial presented on each page and no ability to go backwards. 

### Data processing

We did not record response times or use this as a criterion for inclusion. As in Studies 1-2, we retained participants regardless of skipped trials (n=XX trials; XX% of all trials).

## Results

XX

## Discussion

XX

# Assessing age-related changes in conceptual structure continuously: A re-analysis of Studies 1-3

Taken together, exploratory factor analyses (EFAs) of different age groups suggest that that conceptual structure underlying 4- to 6-year-old children's mental capacity attributions (Studies 2-3) differs from the conceptual structure underlying 7- to 9-year-old children's and adults' mental capacity attributions (Studies 1-2). This data-driven, "bottom-up" approach to inferring conceptual structure at the group level provides novel insights into how children's representations of mental life might evolve across childhood that we would not have anticipated a priori. A similar pattern of differences between younger and older children emerged organically across multiple studies (Study 2 and Studies 1 vs. 3), giving us reason to think that they reflect something real about children's developing understanding of mental life.

However, this approach to analyzing data comes at some cost. EFA is a group-level analysis, capable of revealing latent structures underlying covariance patterns across a large set of observations; using this approach to study conceptual structure at the individual level would require hundreds of observations per participant, which is not feasible with young children. Even collecting enough observations per age group was no small feat; in order to facilitate data collection for Studies 1-3 we opted for fairly wide age ranges spanning 3 years for each group (4-6 years and 7-9 years). Categorizing children as "younger" vs. "older" using such wide age ranges has provided intriguing snap-shots of children at different points in development—but this is, of course, a rather crude way of characterizing developmental change. 

Between Studies 1-3, however, a total of 545 children between the ages of 4.00-9.99 years each provided between 20-40 responses to questions about various target characters' mental capacities. With a different kind of analysis, this dataset has the potential to address questions about conceptual development at a much more fine-grained level than what group-level EFAs have revealed so far. With this in mind, we now present a novel re-analysis of Studies 1-3, aimed at characterizing age-related differences in conceptual structure continuously across development. Our goal in these post-hoc analyses was to assess the differentiation of what we've called body, heart, and mind in individual children—a kind of non-parametric, participant- level analysis meant to parallel the EFAs reported above. 

We based this analysis on the intuition that a child who differentiates clearly between two categories of mental capacities (e.g., physiological sensations of the body vs. social-emotional abilities of the heart) will evaluate mental capacities related to these categories somewhat independently. Such a child will sometimes end up endorsing mental capacities in one category while rejecting mental capacities in the other (e.g., endorsing most physiological sensations but rejecting most social-emotional abilities)—whereas a child who does not differentiate between these categories might be more likely to endorse or reject across the board (e.g., endorsing equal numbers of physiological and social-emotional items). Of course, depending on the target character they happen to evaluate, even children with clearly differentiated categories might end up endorsing equal numbers of capacities in both. But if the differentiation of two categories becomes stronger over development, we might expect that, on average, the difference in the number of endorsements between these categories would increase with age. 

Following this logic, we re-analyzed the data from Studies 1-3 to assess changes in conceptual structure continuously between 4-9 years of age.

## Method

### Participants

We included all of the child participants from Studies 1-3 in this analysis (total N=545 children). This combined sample of children ranged in age from 4.00-9.99 years (median: XX years); see Methods for Studies 1-3 for further demographic information.

### Data preparation

Following the logic outlined above, we designated a set of mental capacity items to represent categories of body, heart, and mind for each study and tallied up the number of "endorsements" (responses of yes or kinda) within each category for each child (separating out children's attributions to the beetle vs. the robot, for Study 3). For the sake of comparability across studies and across categories, we included exactly six mental capacities in each category.

For Study 3, these categories had already been defined in the initial design of the study: To reiterate, the body category included feel hungry, get thirsty, feel sick, feel tired, get scared, and smell things; the heart category included love someone, hate someone, feel happy, get sad, feel sorry, get lonely; and the mind category included see, hear, think, remember things, know stuff, figure things out.

For Studies 1-2, we used adults' EFA results from Study 1 to define categories.
For the body category, we included get hungry, feel pain, smell things, feel scared, feel sick, and feel tired. These six items were among the seven strongest positive factor loadings on Factor XX among adults in Study 1 (all loadings ≥0.66), were included in both Studies 1 and 2, and had maximal overlap with the body category as defined for Study 3 (five of six items were nearly identical, with the exception of feel pain instead of get thirsty). 

For the heart category, we included feel love, feel happy, feel sad, get angry, feel guilty, and get hurt feelings. These six items were among the ten strongest positive factor loadings on Factor XX among adults in Study 1 (all factor loadings ≥0.51), were included in both Studies 1 and 2, and had maximal overlap with the heart category as defined for Study 3 (three of six items were nearly identical, and the others were matched in valence and general meaning: get angry instead of hate someone; feel guilty instead of feel sorry; and get hurt feelings instead of get lonely). 

Finally, for the mind category, we included figure out how to do things, remember things, be aware of things, sense whether something is close by or far away, sense temperatures, and make choices. These six items were among the ten strongest positive factor loadings on Factor XX among adults in Study 1 (all factor loadings ≥0.50) and were included in both Studies 1 and 2. They also had relatively strong overlap with the mind category as defined for Study 3: Two of six items were nearly identical, and two others were matched in general meaning (be aware of things instead of see; sense temperatures instead of hear); the others (sense whether something is close by or far away and make choices) were not particularly well-matched to the Study 3 substitutes (know stuff and think), but allowed us to use the same set of items to define the mind category for Studies 1 and 2, which we decided was our priority. 

We note that there are many "researcher degrees of freedom" in these choices; we have striven to be as transparent as possible about our process, and encourage the curious reader to explore other choices using our data (openly available at XX).

This left us with a dataset in which each child was associated with "endorsement tallies" between 0-6 for body, for heart, and for mind, for each of the target characters that child assessed (Studies 1-2: one target per child; Study 3: two targets per child); this data also included each child's exact age.

### Analysis plan

Following the logic described above, we compared differences in children's endorsement tallies across pairs of categories: body minus heart, body minus mind, and heart minus mind, interpreting large differences between categories as reflecting strong differentiation of those two categories and age-related increases in differences to reflect increasing differentiation over development. 

[OPTION #1: We conducted three separate mixed-effects Bayesian regression analyses—one for each pair of categories—to analyze these age-related changes in the absolute value of differences (theoretical range: 0-6). For each analysis, we regressed children's exact age (centered at the mean, XX years) onto the difference between the two categories in question (e.g., body minus heart), using Poisson distributions and maximal random effects structures. XX ALSO RAW DIFFERENCES?]

[OPTION #2: We conducted a mixed-effects Bayesian regression analysis to analyze differences in endorsements across categories and whether they varied with children's age, using children's exact age (centered at the mean, XX years), the category (coded with orthogonal contrasts comparing body and heart to mind, and body to heart), and an interaction between age and category to predict the endorsement tally (theoretical range: 0-6). We used Poisson distributions to model these tallies, and maximal random effects structures.]

## Results

XX

## Discussion

XX

# General Discussion

## Summary

The current studies suggest that children's conceptual representations of mental life undergo substantial development between the ages of 4-9 years—in two distinct senses. 

First, analyses of the correlational structure of children's mental capacity attributions (EFAs) suggested changes in conceptual structure: Between early childhood (4-6 years; Studies 2-3) and middle childhood (7-9 years; Studies 1-2), children's sense of which mental capacities "go together" seemed to unfold into a higher-dimensional space, characterized by stronger differentiation of the social-emotional abilities that we've called "heart" from the physiological sensations of the body and the perceptual-cognitive abilities of the mind. 
Meanwhile, analyses of factor scores—summaries of which mental capacities children tended to attribute to which target characters—revealed a second kind of age-related difference: what we might call changes in the application of the concept. These differences were clearest in Studies 1 and 3, which focused on two "edge cases" in social reasoning (beetles and robots): Between the ages of 4-6 years (Study 3), XX FILL IN, while between the ages of 7-9 years (Study 1), attributions of body to beetles and robots were relatively stable and adult-like, attributions of heart to these "edge cases" started out higher than adults and decreased to nearly adult-like levels by the age of 9 years, and attributions of mind started out lower than adults and increased to nearly adult-like levels by the age of 9 years.

XX GD
